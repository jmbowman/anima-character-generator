/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*! jQuery v1.9.1 | (c) 2005, 2012 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery.min.map
*/

/*!
 * Bootstrap v3.0.0
 *
 * Copyright 2013 Twitter, Inc
 * Licensed under the Apache License v2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Designed and built with all the love in the world @twitter by @mdo and @fat.
 */

/*
 * Fuel UX Spinner
 * https://github.com/ExactTarget/fuelux
 *
 * Copyright (c) 2012 ExactTarget
 * Licensed under the MIT license.
 */

/*
 * Fuel UX Utilities
 * https://github.com/ExactTarget/fuelux
 *
 * Copyright (c) 2012 ExactTarget
 * Licensed under the MIT license.
 */

/*
 * Fuel UX Combobox
 * https://github.com/ExactTarget/fuelux
 *
 * Copyright (c) 2012 ExactTarget
 * Licensed under the MIT license.
 */

/*	

	jQuery pub/sub plugin by Peter Higgins (dante@dojotoolkit.org)

	Loosely based on Dojo publish/subscribe API, limited in scope. Rewritten blindly.

	Original is (c) Dojo Foundation 2004-2009. Released under either AFL or new BSD, see:
	http://dojofoundation.org/license for more information.

*/

/**
 * jQuery Validation Plugin 1.8.1
 *
 * http://bassistance.de/jquery-plugins/jquery-plugin-validation/
 * http://docs.jquery.com/Plugins/Validation
 *
 * Copyright (c) 2006 - 2011 Jörn Zaefferer
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */

(function(){var requirejs,require,define;(function(e){function t(e,t){return v.call(e,t)}function i(e,t){var i,n,a,s,o,r,l,c,u,d,p=t&&t.split("/"),h=m.map,f=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=p.concat(e.split("/")),c=0;e.length>c;c+=1)if(d=e[c],"."===d)e.splice(c,1),c-=1;else if(".."===d){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||f)&&h){for(i=e.split("/"),c=i.length;c>0;c-=1){if(n=i.slice(0,c).join("/"),p)for(u=p.length;u>0;u-=1)if(a=h[p.slice(0,u).join("/")],a&&(a=a[n])){s=a,o=c;break}if(s)break;!r&&f&&f[n]&&(r=f[n],l=c)}!s&&r&&(s=r,o=l),s&&(i.splice(0,o,s),e=i.join("/"))}return e}function n(t,i){return function(){return u.apply(e,y.call(arguments,0).concat([t,i]))}}function a(e){return function(t){return i(t,e)}}function s(e){return function(t){h[e]=t}}function o(i){if(t(f,i)){var n=f[i];delete f[i],g[i]=!0,c.apply(e,n)}if(!t(h,i)&&!t(g,i))throw Error("No "+i);return h[i]}function r(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function l(e){return function(){return m&&m.config&&m.config[e]||{}}}var c,u,d,p,h={},f={},m={},g={},v=Object.prototype.hasOwnProperty,y=[].slice;d=function(e,t){var n,s=r(e),l=s[0];return e=s[1],l&&(l=i(l,t),n=o(l)),l?e=n&&n.normalize?n.normalize(e,a(t)):i(e,t):(e=i(e,t),s=r(e),l=s[0],e=s[1],l&&(n=o(l))),{f:l?l+"!"+e:e,n:e,pr:l,p:n}},p={require:function(e){return n(e)},exports:function(e){var t=h[e];return t!==void 0?t:h[e]={}},module:function(e){return{id:e,uri:"",exports:h[e],config:l(e)}}},c=function(i,a,r,l){var c,u,m,v,y,b,D=[];if(l=l||i,"function"==typeof r){for(a=!a.length&&r.length?["require","exports","module"]:a,y=0;a.length>y;y+=1)if(v=d(a[y],l),u=v.f,"require"===u)D[y]=p.require(i);else if("exports"===u)D[y]=p.exports(i),b=!0;else if("module"===u)c=D[y]=p.module(i);else if(t(h,u)||t(f,u)||t(g,u))D[y]=o(u);else{if(!v.p)throw Error(i+" missing "+u);v.p.load(v.n,n(l,!0),s(u),{}),D[y]=h[u]}m=r.apply(h[i],D),i&&(c&&c.exports!==e&&c.exports!==h[i]?h[i]=c.exports:m===e&&b||(h[i]=m))}else i&&(h[i]=r)},requirejs=require=u=function(t,i,n,a,s){return"string"==typeof t?p[t]?p[t](i):o(d(t,i).f):(t.splice||(m=t,i.splice?(t=i,i=n,n=null):t=e),i=i||function(){},"function"==typeof n&&(n=a,a=s),a?c(e,t,i,n):setTimeout(function(){c(e,t,i,n)},4),u)},u.config=function(e){return m=e,m.deps&&u(m.deps,m.callback),u},define=function(e,i,n){i.splice||(n=i,i=[]),t(h,e)||t(f,e)||(f[e]=[e,i,n])},define.amd={jQuery:!0}})(),define("libs/almond",function(){}),require.config({paths:{bootstrap:"libs/bootstrap.min",jquery:"libs/jquery-1.9.1.min",pubsub:"libs/jq.pubsub",validate:"libs/jquery.validate.min"},shim:{bootstrap:["jquery"],pubsub:["jquery"],validate:["jquery"]}}),define("config",function(){}),function(e,t){function i(e){var t=e.length,i=lt.type(e);return lt.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function n(e){var t=Ct[e]={};return lt.each(e.match(ut)||[],function(e,i){t[i]=!0}),t}function a(e,i,n,a){if(lt.acceptData(e)){var s,o,r=lt.expando,l="string"==typeof i,c=e.nodeType,u=c?lt.cache:e,d=c?e[r]:e[r]&&r;if(d&&u[d]&&(a||u[d].data)||!l||n!==t)return d||(c?e[r]=d=Y.pop()||lt.guid++:d=r),u[d]||(u[d]={},c||(u[d].toJSON=lt.noop)),("object"==typeof i||"function"==typeof i)&&(a?u[d]=lt.extend(u[d],i):u[d].data=lt.extend(u[d].data,i)),s=u[d],a||(s.data||(s.data={}),s=s.data),n!==t&&(s[lt.camelCase(i)]=n),l?(o=s[i],null==o&&(o=s[lt.camelCase(i)])):o=s,o}}function s(e,t,i){if(lt.acceptData(e)){var n,a,s,o=e.nodeType,l=o?lt.cache:e,c=o?e[lt.expando]:lt.expando;if(l[c]){if(t&&(s=i?l[c]:l[c].data)){lt.isArray(t)?t=t.concat(lt.map(t,lt.camelCase)):t in s?t=[t]:(t=lt.camelCase(t),t=t in s?[t]:t.split(" "));for(n=0,a=t.length;a>n;n++)delete s[t[n]];if(!(i?r:lt.isEmptyObject)(s))return}(i||(delete l[c].data,r(l[c])))&&(o?lt.cleanData([e],!0):lt.support.deleteExpando||l!=l.window?delete l[c]:l[c]=null)}}}function o(e,i,n){if(n===t&&1===e.nodeType){var a="data-"+i.replace(Mt,"-$1").toLowerCase();if(n=e.getAttribute(a),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:At.test(n)?lt.parseJSON(n):n}catch(s){}lt.data(e,i,n)}else n=t}return n}function r(e){var t;for(t in e)if(("data"!==t||!lt.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function c(){return!1}function u(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function d(e,t,i){if(t=t||0,lt.isFunction(t))return lt.grep(e,function(e,n){var a=!!t.call(e,n,e);return a===i});if(t.nodeType)return lt.grep(e,function(e){return e===t===i});if("string"==typeof t){var n=lt.grep(e,function(e){return 1===e.nodeType});if(Ht.test(t))return lt.filter(t,n,!i);t=lt.filter(t,n)}return lt.grep(e,function(e){return lt.inArray(e,t)>=0===i})}function p(e){var t=zt.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function h(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function f(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function m(e){var t=ai.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var i,n=0;null!=(i=e[n]);n++)lt._data(i,"globalEval",!t||lt._data(t[n],"globalEval"))}function v(e,t){if(1===t.nodeType&&lt.hasData(e)){var i,n,a,s=lt._data(e),o=lt._data(t,s),r=s.events;if(r){delete o.handle,o.events={};for(i in r)for(n=0,a=r[i].length;a>n;n++)lt.event.add(t,i,r[i][n])}o.data&&(o.data=lt.extend({},o.data))}}function y(e,t){var i,n,a;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!lt.support.noCloneEvent&&t[lt.expando]){a=lt._data(t);for(n in a.events)lt.removeEvent(t,n,a.handle);t.removeAttribute(lt.expando)}"script"===i&&t.text!==e.text?(f(t).text=e.text,m(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),lt.support.html5Clone&&e.innerHTML&&!lt.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&ti.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}}function b(e,i){var n,a,s=0,o=typeof e.getElementsByTagName!==U?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==U?e.querySelectorAll(i||"*"):t;if(!o)for(o=[],n=e.childNodes||e;null!=(a=n[s]);s++)!i||lt.nodeName(a,i)?o.push(a):lt.merge(o,b(a,i));return i===t||i&&lt.nodeName(e,i)?lt.merge([e],o):o}function D(e){ti.test(e.type)&&(e.defaultChecked=e.checked)}function P(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,a=Ai.length;a--;)if(t=Ai[a]+i,t in e)return t;return n}function _(e,t){return e=t||e,"none"===lt.css(e,"display")||!lt.contains(e.ownerDocument,e)}function C(e,t){for(var i,n,a,s=[],o=0,r=e.length;r>o;o++)n=e[o],n.style&&(s[o]=lt._data(n,"olddisplay"),i=n.style.display,t?(s[o]||"none"!==i||(n.style.display=""),""===n.style.display&&_(n)&&(s[o]=lt._data(n,"olddisplay",x(n.nodeName)))):s[o]||(a=_(n),(i&&"none"!==i||!a)&&lt._data(n,"olddisplay",a?i:lt.css(n,"display"))));for(o=0;r>o;o++)n=e[o],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?s[o]||"":"none"));return e}function A(e,t,i){var n=vi.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function M(e,t,i,n,a){for(var s=i===(n?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===i&&(o+=lt.css(e,i+Ci[s],!0,a)),n?("content"===i&&(o-=lt.css(e,"padding"+Ci[s],!0,a)),"margin"!==i&&(o-=lt.css(e,"border"+Ci[s]+"Width",!0,a))):(o+=lt.css(e,"padding"+Ci[s],!0,a),"padding"!==i&&(o+=lt.css(e,"border"+Ci[s]+"Width",!0,a)));return o}function k(e,t,i){var n=!0,a="width"===t?e.offsetWidth:e.offsetHeight,s=ui(e),o=lt.support.boxSizing&&"border-box"===lt.css(e,"boxSizing",!1,s);if(0>=a||null==a){if(a=di(e,t,s),(0>a||null==a)&&(a=e.style[t]),yi.test(a))return a;n=o&&(lt.support.boxSizingReliable||a===e.style[t]),a=parseFloat(a)||0}return a+M(e,t,i||(o?"border":"content"),n,s)+"px"}function x(e){var t=V,i=Di[e];return i||(i=w(e,t),"none"!==i&&i||(ci=(ci||lt("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(ci[0].contentWindow||ci[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),i=w(e,t),ci.detach()),Di[e]=i),i}function w(e,t){var i=lt(t.createElement(e)).appendTo(t.body),n=lt.css(i[0],"display");return i.remove(),n}function S(e,t,i,n){var a;if(lt.isArray(t))lt.each(t,function(t,a){i||ki.test(e)?n(e,a):S(e+"["+("object"==typeof a?t:"")+"]",a,i,n)});else if(i||"object"!==lt.type(t))n(e,t);else for(a in t)S(e+"["+a+"]",t[a],i,n)}function R(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,a=0,s=t.toLowerCase().match(ut)||[];if(lt.isFunction(i))for(;n=s[a++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function T(e,i,n,a){function s(l){var c;return o[l]=!0,lt.each(e[l]||[],function(e,l){var u=l(i,n,a);return"string"!=typeof u||r||o[u]?r?!(c=u):t:(i.dataTypes.unshift(u),s(u),!1)}),c}var o={},r=e===Hi;return s(i.dataTypes[0])||!o["*"]&&s("*")}function N(e,i){var n,a,s=lt.ajaxSettings.flatOptions||{};for(a in i)i[a]!==t&&((s[a]?e:n||(n={}))[a]=i[a]);return n&&lt.extend(!0,e,n),e}function O(e,i,n){var a,s,o,r,l=e.contents,c=e.dataTypes,u=e.responseFields;for(r in u)r in n&&(i[u[r]]=n[r]);for(;"*"===c[0];)c.shift(),s===t&&(s=e.mimeType||i.getResponseHeader("Content-Type"));if(s)for(r in l)if(l[r]&&l[r].test(s)){c.unshift(r);break}if(c[0]in n)o=c[0];else{for(r in n){if(!c[0]||e.converters[r+" "+c[0]]){o=r;break}a||(a=r)}o=o||a}return o?(o!==c[0]&&c.unshift(o),n[o]):t}function F(e,t){var i,n,a,s,o={},r=0,l=e.dataTypes.slice(),c=l[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l[1])for(a in e.converters)o[a.toLowerCase()]=e.converters[a];for(;n=l[++r];)if("*"!==n){if("*"!==c&&c!==n){if(a=o[c+" "+n]||o["* "+n],!a)for(i in o)if(s=i.split(" "),s[1]===n&&(a=o[c+" "+s[0]]||o["* "+s[0]])){a===!0?a=o[i]:o[i]!==!0&&(n=s[0],l.splice(r--,0,n));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+c+" to "+n}}}c=n}return{state:"success",data:t}}function E(){try{return new e.XMLHttpRequest}catch(t){}}function B(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function G(){return setTimeout(function(){Qi=t}),Qi=lt.now()}function L(e,t){lt.each(t,function(t,i){for(var n=(sn[t]||[]).concat(sn["*"]),a=0,s=n.length;s>a;a++)if(n[a].call(e,t,i))return})}function K(e,t,i){var n,a,s=0,o=an.length,r=lt.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var t=Qi||G(),i=Math.max(0,c.startTime+c.duration-t),n=i/c.duration||0,s=1-n,o=0,l=c.tweens.length;l>o;o++)c.tweens[o].run(s);return r.notifyWith(e,[c,s,i]),1>s&&l?i:(r.resolveWith(e,[c]),!1)},c=r.promise({elem:e,props:lt.extend({},t),opts:lt.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Qi||G(),duration:i.duration,tweens:[],createTween:function(t,i){var n=lt.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(a)return this;for(a=!0;n>i;i++)c.tweens[i].run(1);return t?r.resolveWith(e,[c,t]):r.rejectWith(e,[c,t]),this}}),u=c.props;for(I(u,c.opts.specialEasing);o>s;s++)if(n=an[s].call(c,e,u,c.opts))return n;return L(c,u),lt.isFunction(c.opts.start)&&c.opts.start.call(e,c),lt.fx.timer(lt.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function I(e,t){var i,n,a,s,o;for(a in e)if(n=lt.camelCase(a),s=t[n],i=e[a],lt.isArray(i)&&(s=i[1],i=e[a]=i[0]),a!==n&&(e[n]=i,delete e[a]),o=lt.cssHooks[n],o&&"expand"in o){i=o.expand(i),delete e[n];for(a in i)a in e||(e[a]=i[a],t[a]=s)}else t[n]=s}function q(e,t,i){var n,a,s,o,r,l,c,u,d,p=this,h=e.style,f={},m=[],g=e.nodeType&&_(e);i.queue||(u=lt._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,d=u.empty.fire,u.empty.fire=function(){u.unqueued||d()}),u.unqueued++,p.always(function(){p.always(function(){u.unqueued--,lt.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[h.overflow,h.overflowX,h.overflowY],"inline"===lt.css(e,"display")&&"none"===lt.css(e,"float")&&(lt.support.inlineBlockNeedsLayout&&"inline"!==x(e.nodeName)?h.zoom=1:h.display="inline-block")),i.overflow&&(h.overflow="hidden",lt.support.shrinkWrapBlocks||p.always(function(){h.overflow=i.overflow[0],h.overflowX=i.overflow[1],h.overflowY=i.overflow[2]}));for(a in t)if(o=t[a],en.exec(o)){if(delete t[a],l=l||"toggle"===o,o===(g?"hide":"show"))continue;m.push(a)}if(s=m.length){r=lt._data(e,"fxshow")||lt._data(e,"fxshow",{}),"hidden"in r&&(g=r.hidden),l&&(r.hidden=!g),g?lt(e).show():p.done(function(){lt(e).hide()}),p.done(function(){var t;lt._removeData(e,"fxshow");for(t in f)lt.style(e,t,f[t])});for(a=0;s>a;a++)n=m[a],c=p.createTween(n,g?r[n]:0),f[n]=r[n]||lt.style(e,n),n in r||(r[n]=c.start,g&&(c.end=c.start,c.start="width"===n||"height"===n?1:0))}}function j(e,t,i,n,a){return new j.prototype.init(e,t,i,n,a)}function H(e,t){var i,n={height:e},a=0;for(t=t?1:0;4>a;a+=2-t)i=Ci[a],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function W(e){return lt.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var $,z,U=typeof t,V=e.document,X=e.location,Z=e.jQuery,J=e.$,Q={},Y=[],et="1.9.1",tt=Y.concat,it=Y.push,nt=Y.slice,at=Y.indexOf,st=Q.toString,ot=Q.hasOwnProperty,rt=et.trim,lt=function(e,t){return new lt.fn.init(e,t,z)},ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ut=/\S+/g,dt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,pt=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ft=/^[\],:{}\s]*$/,mt=/(?:^|:|,)(?:\s*\[)+/g,gt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,vt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,yt=/^-ms-/,bt=/-([\da-z])/gi,Dt=function(e,t){return t.toUpperCase()},Pt=function(e){(V.addEventListener||"load"===e.type||"complete"===V.readyState)&&(_t(),lt.ready())},_t=function(){V.addEventListener?(V.removeEventListener("DOMContentLoaded",Pt,!1),e.removeEventListener("load",Pt,!1)):(V.detachEvent("onreadystatechange",Pt),e.detachEvent("onload",Pt))};lt.fn=lt.prototype={jquery:et,constructor:lt,init:function(e,i,n){var a,s;if(!e)return this;if("string"==typeof e){if(a="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:pt.exec(e),!a||!a[1]&&i)return!i||i.jquery?(i||n).find(e):this.constructor(i).find(e);if(a[1]){if(i=i instanceof lt?i[0]:i,lt.merge(this,lt.parseHTML(a[1],i&&i.nodeType?i.ownerDocument||i:V,!0)),ht.test(a[1])&&lt.isPlainObject(i))for(a in i)lt.isFunction(this[a])?this[a](i[a]):this.attr(a,i[a]);return this}if(s=V.getElementById(a[2]),s&&s.parentNode){if(s.id!==a[2])return n.find(e);this.length=1,this[0]=s}return this.context=V,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):lt.isFunction(e)?n.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),lt.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return nt.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=lt.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return lt.each(this,e,t)},ready:function(e){return lt.ready.promise().done(e),this},slice:function(){return this.pushStack(nt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},map:function(e){return this.pushStack(lt.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:it,sort:[].sort,splice:[].splice},lt.fn.init.prototype=lt.fn,lt.extend=lt.fn.extend=function(){var e,i,n,a,s,o,r=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof r&&(u=r,r=arguments[1]||{},l=2),"object"==typeof r||lt.isFunction(r)||(r={}),c===l&&(r=this,--l);c>l;l++)if(null!=(s=arguments[l]))for(a in s)e=r[a],n=s[a],r!==n&&(u&&n&&(lt.isPlainObject(n)||(i=lt.isArray(n)))?(i?(i=!1,o=e&&lt.isArray(e)?e:[]):o=e&&lt.isPlainObject(e)?e:{},r[a]=lt.extend(u,o,n)):n!==t&&(r[a]=n));return r},lt.extend({noConflict:function(t){return e.$===lt&&(e.$=J),t&&e.jQuery===lt&&(e.jQuery=Z),lt},isReady:!1,readyWait:1,holdReady:function(e){e?lt.readyWait++:lt.ready(!0)},ready:function(e){if(e===!0?!--lt.readyWait:!lt.isReady){if(!V.body)return setTimeout(lt.ready);lt.isReady=!0,e!==!0&&--lt.readyWait>0||($.resolveWith(V,[lt]),lt.fn.trigger&&lt(V).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===lt.type(e)},isArray:Array.isArray||function(e){return"array"===lt.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Q[st.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==lt.type(e)||e.nodeType||lt.isWindow(e))return!1;try{if(e.constructor&&!ot.call(e,"constructor")&&!ot.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}var n;for(n in e);return n===t||ot.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||V;var n=ht.exec(e),a=!i&&[];return n?[t.createElement(n[1])]:(n=lt.buildFragment([e],t,a),a&&lt(a).remove(),lt.merge([],n.childNodes))},parseJSON:function(i){return e.JSON&&e.JSON.parse?e.JSON.parse(i):null===i?i:"string"==typeof i&&(i=lt.trim(i),i&&ft.test(i.replace(gt,"@").replace(vt,"]").replace(mt,"")))?Function("return "+i)():(lt.error("Invalid JSON: "+i),t)},parseXML:function(i){var n,a;if(!i||"string"!=typeof i)return null;try{e.DOMParser?(a=new DOMParser,n=a.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(s){n=t}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||lt.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(t){t&&lt.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(yt,"ms-").replace(bt,Dt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var a,s=0,o=e.length,r=i(e);if(n){if(r)for(;o>s&&(a=t.apply(e[s],n),a!==!1);s++);else for(s in e)if(a=t.apply(e[s],n),a===!1)break}else if(r)for(;o>s&&(a=t.call(e[s],s,e[s]),a!==!1);s++);else for(s in e)if(a=t.call(e[s],s,e[s]),a===!1)break;return e},trim:rt&&!rt.call("﻿ ")?function(e){return null==e?"":rt.call(e)}:function(e){return null==e?"":(e+"").replace(dt,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?lt.merge(n,"string"==typeof e?[e]:e):it.call(n,e)),n},inArray:function(e,t,i){var n;if(t){if(at)return at.call(t,e,i);for(n=t.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var n=i.length,a=e.length,s=0;if("number"==typeof n)for(;n>s;s++)e[a++]=i[s];else for(;i[s]!==t;)e[a++]=i[s++];return e.length=a,e},grep:function(e,t,i){var n,a=[],s=0,o=e.length;for(i=!!i;o>s;s++)n=!!t(e[s],s),i!==n&&a.push(e[s]);return a},map:function(e,t,n){var a,s=0,o=e.length,r=i(e),l=[];if(r)for(;o>s;s++)a=t(e[s],s,n),null!=a&&(l[l.length]=a);else for(s in e)a=t(e[s],s,n),null!=a&&(l[l.length]=a);return tt.apply([],l)},guid:1,proxy:function(e,i){var n,a,s;return"string"==typeof i&&(s=e[i],i=e,e=s),lt.isFunction(e)?(n=nt.call(arguments,2),a=function(){return e.apply(i||this,n.concat(nt.call(arguments)))},a.guid=e.guid=e.guid||lt.guid++,a):t},access:function(e,i,n,a,s,o,r){var l=0,c=e.length,u=null==n;if("object"===lt.type(n)){s=!0;for(l in n)lt.access(e,i,l,n[l],!0,o,r)}else if(a!==t&&(s=!0,lt.isFunction(a)||(r=!0),u&&(r?(i.call(e,a),i=null):(u=i,i=function(e,t,i){return u.call(lt(e),i)})),i))for(;c>l;l++)i(e[l],n,r?a:a.call(e[l],l,i(e[l],n)));return s?e:u?i.call(e):c?i(e[0],n):o},now:function(){return(new Date).getTime()}}),lt.ready.promise=function(t){if(!$)if($=lt.Deferred(),"complete"===V.readyState)setTimeout(lt.ready);else if(V.addEventListener)V.addEventListener("DOMContentLoaded",Pt,!1),e.addEventListener("load",Pt,!1);else{V.attachEvent("onreadystatechange",Pt),e.attachEvent("onload",Pt);var i=!1;try{i=null==e.frameElement&&V.documentElement}catch(n){}i&&i.doScroll&&function a(){if(!lt.isReady){try{i.doScroll("left")}catch(e){return setTimeout(a,50)}_t(),lt.ready()}}()}return $.promise(t)},lt.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Q["[object "+t+"]"]=t.toLowerCase()}),z=lt(V);var Ct={};lt.Callbacks=function(e){e="string"==typeof e?Ct[e]||n(e):lt.extend({},e);var i,a,s,o,r,l,c=[],u=!e.once&&[],d=function(t){for(a=e.memory&&t,s=!0,r=l||0,l=0,o=c.length,i=!0;c&&o>r;r++)if(c[r].apply(t[0],t[1])===!1&&e.stopOnFalse){a=!1;break}i=!1,c&&(u?u.length&&d(u.shift()):a?c=[]:p.disable())},p={add:function(){if(c){var t=c.length;(function n(t){lt.each(t,function(t,i){var a=lt.type(i);"function"===a?e.unique&&p.has(i)||c.push(i):i&&i.length&&"string"!==a&&n(i)})})(arguments),i?o=c.length:a&&(l=t,d(a))}return this},remove:function(){return c&&lt.each(arguments,function(e,t){for(var n;(n=lt.inArray(t,c,n))>-1;)c.splice(n,1),i&&(o>=n&&o--,r>=n&&r--)}),this},has:function(e){return e?lt.inArray(e,c)>-1:!(!c||!c.length)},empty:function(){return c=[],this},disable:function(){return c=u=a=t,this},disabled:function(){return!c},lock:function(){return u=t,a||p.disable(),this},locked:function(){return!u},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!c||s&&!u||(i?u.push(t):d(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!s}};return p},lt.extend({Deferred:function(e){var t=[["resolve","done",lt.Callbacks("once memory"),"resolved"],["reject","fail",lt.Callbacks("once memory"),"rejected"],["notify","progress",lt.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var e=arguments;return lt.Deferred(function(i){lt.each(t,function(t,s){var o=s[0],r=lt.isFunction(e[t])&&e[t];a[s[1]](function(){var e=r&&r.apply(this,arguments);e&&lt.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o+"With"](this===n?i.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?lt.extend(e,n):n}},a={};return n.pipe=n.then,lt.each(t,function(e,s){var o=s[2],r=s[3];n[s[1]]=o.add,r&&o.add(function(){i=r},t[1^e][2].disable,t[2][2].lock),a[s[0]]=function(){return a[s[0]+"With"](this===a?n:this,arguments),this},a[s[0]+"With"]=o.fireWith}),n.promise(a),e&&e.call(a,a),a},when:function(e){var t,i,n,a=0,s=nt.call(arguments),o=s.length,r=1!==o||e&&lt.isFunction(e.promise)?o:0,l=1===r?e:lt.Deferred(),c=function(e,i,n){return function(a){i[e]=this,n[e]=arguments.length>1?nt.call(arguments):a,n===t?l.notifyWith(i,n):--r||l.resolveWith(i,n)}};if(o>1)for(t=Array(o),i=Array(o),n=Array(o);o>a;a++)s[a]&&lt.isFunction(s[a].promise)?s[a].promise().done(c(a,n,s)).fail(l.reject).progress(c(a,i,t)):--r;return r||l.resolveWith(n,s),l.promise()}}),lt.support=function(){var t,i,n,a,s,o,r,l,c,u,d=V.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=d.getElementsByTagName("*"),n=d.getElementsByTagName("a")[0],!i||!n||!i.length)return{};s=V.createElement("select"),r=s.appendChild(V.createElement("option")),a=d.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/top/.test(n.getAttribute("style")),hrefNormalized:"/a"===n.getAttribute("href"),opacity:/^0.5/.test(n.style.opacity),cssFloat:!!n.style.cssFloat,checkOn:!!a.value,optSelected:r.selected,enctype:!!V.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==V.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===V.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!r.disabled;try{delete d.test}catch(p){t.deleteExpando=!1}a=V.createElement("input"),a.setAttribute("value",""),t.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","t"),a.setAttribute("name","t"),o=V.createDocumentFragment(),o.appendChild(a),t.appendChecked=a.checked,t.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(u in{submit:!0,change:!0,focusin:!0})d.setAttribute(l="on"+u,"t"),t[u+"Bubbles"]=l in e||d.attributes[l].expando===!1;return d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip,lt(function(){var i,n,a,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",o=V.getElementsByTagName("body")[0];o&&(i=V.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",o.appendChild(i).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=d.getElementsByTagName("td"),a[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===a[0].offsetHeight,a[0].style.display="",a[1].style.display="none",t.reliableHiddenOffsets=c&&0===a[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===d.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==o.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,n=d.appendChild(V.createElement("div")),n.style.cssText=d.style.cssText=s,n.style.marginRight=n.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)),typeof d.style.zoom!==U&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(o.style.zoom=1)),o.removeChild(i),i=d=a=n=null)}),i=s=o=r=n=a=null,t}();var At=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Mt=/([A-Z])/g;lt.extend({cache:{},expando:"jQuery"+(et+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?lt.cache[e[lt.expando]]:e[lt.expando],!!e&&!r(e)},data:function(e,t,i){return a(e,t,i)},removeData:function(e,t){return s(e,t)},_data:function(e,t,i){return a(e,t,i,!0)},_removeData:function(e,t){return s(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&lt.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),lt.fn.extend({data:function(e,i){var n,a,s=this[0],r=0,l=null;if(e===t){if(this.length&&(l=lt.data(s),1===s.nodeType&&!lt._data(s,"parsedAttrs"))){for(n=s.attributes;n.length>r;r++)a=n[r].name,a.indexOf("data-")||(a=lt.camelCase(a.slice(5)),o(s,a,l[a]));lt._data(s,"parsedAttrs",!0)}return l}return"object"==typeof e?this.each(function(){lt.data(this,e)}):lt.access(this,function(i){return i===t?s?o(s,e,lt.data(s,e)):null:(this.each(function(){lt.data(this,e,i)}),t)},null,i,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){lt.removeData(this,e)})}}),lt.extend({queue:function(e,i,n){var a;return e?(i=(i||"fx")+"queue",a=lt._data(e,i),n&&(!a||lt.isArray(n)?a=lt._data(e,i,lt.makeArray(n)):a.push(n)),a||[]):t},dequeue:function(e,t){t=t||"fx";var i=lt.queue(e,t),n=i.length,a=i.shift(),s=lt._queueHooks(e,t),o=function(){lt.dequeue(e,t)};"inprogress"===a&&(a=i.shift(),n--),s.cur=a,a&&("fx"===t&&i.unshift("inprogress"),delete s.stop,a.call(e,o,s)),!n&&s&&s.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return lt._data(e,i)||lt._data(e,i,{empty:lt.Callbacks("once memory").add(function(){lt._removeData(e,t+"queue"),lt._removeData(e,i)})})}}),lt.fn.extend({queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),n>arguments.length?lt.queue(this[0],e):i===t?this:this.each(function(){var t=lt.queue(this,e,i);lt._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&lt.dequeue(this,e)})},dequeue:function(e){return this.each(function(){lt.dequeue(this,e)})},delay:function(e,t){return e=lt.fx?lt.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,a=1,s=lt.Deferred(),o=this,r=this.length,l=function(){--a||s.resolveWith(o,[o])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";r--;)n=lt._data(o[r],e+"queueHooks"),n&&n.empty&&(a++,n.empty.add(l));return l(),s.promise(i)}});var kt,xt,wt=/[\t\r\n]/g,St=/\r/g,Rt=/^(?:input|select|textarea|button|object)$/i,Tt=/^(?:a|area)$/i,Nt=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Ot=/^(?:checked|selected)$/i,Ft=lt.support.getSetAttribute,Et=lt.support.input;lt.fn.extend({attr:function(e,t){return lt.access(this,lt.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){lt.removeAttr(this,e)})},prop:function(e,t){return lt.access(this,lt.prop,e,t,arguments.length>1)},removeProp:function(e){return e=lt.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,n,a,s,o=0,r=this.length,l="string"==typeof e&&e;if(lt.isFunction(e))return this.each(function(t){lt(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ut)||[];r>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(wt," "):" ")){for(s=0;a=t[s++];)0>n.indexOf(" "+a+" ")&&(n+=a+" ");i.className=lt.trim(n)}return this},removeClass:function(e){var t,i,n,a,s,o=0,r=this.length,l=0===arguments.length||"string"==typeof e&&e;if(lt.isFunction(e))return this.each(function(t){lt(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ut)||[];r>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(wt," "):"")){for(s=0;a=t[s++];)for(;n.indexOf(" "+a+" ")>=0;)n=n.replace(" "+a+" "," ");i.className=e?lt.trim(n):""}return this},toggleClass:function(e,t){var i=typeof e,n="boolean"==typeof t;return lt.isFunction(e)?this.each(function(i){lt(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var a,s=0,o=lt(this),r=t,l=e.match(ut)||[];a=l[s++];)r=n?r:!o.hasClass(a),o[r?"addClass":"removeClass"](a);else(i===U||"boolean"===i)&&(this.className&&lt._data(this,"__className__",this.className),this.className=this.className||e===!1?"":lt._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(wt," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,n,a,s=this[0];return arguments.length?(a=lt.isFunction(e),this.each(function(i){var s,o=lt(this);
1===this.nodeType&&(s=a?e.call(this,i,o.val()):e,null==s?s="":"number"==typeof s?s+="":lt.isArray(s)&&(s=lt.map(s,function(e){return null==e?"":e+""})),n=lt.valHooks[this.type]||lt.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,s,"value")!==t||(this.value=s))})):s?(n=lt.valHooks[s.type]||lt.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(s,"value"))!==t?i:(i=s.value,"string"==typeof i?i.replace(St,""):null==i?"":i)):void 0}}),lt.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,i,n=e.options,a=e.selectedIndex,s="select-one"===e.type||0>a,o=s?null:[],r=s?a+1:n.length,l=0>a?r:s?a:0;r>l;l++)if(i=n[l],!(!i.selected&&l!==a||(lt.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&lt.nodeName(i.parentNode,"optgroup"))){if(t=lt(i).val(),s)return t;o.push(t)}return o},set:function(e,t){var i=lt.makeArray(t);return lt(e).find("option").each(function(){this.selected=lt.inArray(lt(this).val(),i)>=0}),i.length||(e.selectedIndex=-1),i}}},attr:function(e,i,n){var a,s,o,r=e.nodeType;return e&&3!==r&&8!==r&&2!==r?typeof e.getAttribute===U?lt.prop(e,i,n):(s=1!==r||!lt.isXMLDoc(e),s&&(i=i.toLowerCase(),a=lt.attrHooks[i]||(Nt.test(i)?xt:kt)),n===t?a&&s&&"get"in a&&null!==(o=a.get(e,i))?o:(typeof e.getAttribute!==U&&(o=e.getAttribute(i)),null==o?t:o):null!==n?a&&s&&"set"in a&&(o=a.set(e,n,i))!==t?o:(e.setAttribute(i,n+""),n):(lt.removeAttr(e,i),t)):void 0},removeAttr:function(e,t){var i,n,a=0,s=t&&t.match(ut);if(s&&1===e.nodeType)for(;i=s[a++];)n=lt.propFix[i]||i,Nt.test(i)?!Ft&&Ot.test(i)?e[lt.camelCase("default-"+i)]=e[n]=!1:e[n]=!1:lt.attr(e,i,""),e.removeAttribute(Ft?i:n)},attrHooks:{type:{set:function(e,t){if(!lt.support.radioValue&&"radio"===t&&lt.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,i,n){var a,s,o,r=e.nodeType;return e&&3!==r&&8!==r&&2!==r?(o=1!==r||!lt.isXMLDoc(e),o&&(i=lt.propFix[i]||i,s=lt.propHooks[i]),n!==t?s&&"set"in s&&(a=s.set(e,n,i))!==t?a:e[i]=n:s&&"get"in s&&null!==(a=s.get(e,i))?a:e[i]):void 0},propHooks:{tabIndex:{get:function(e){var i=e.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):Rt.test(e.nodeName)||Tt.test(e.nodeName)&&e.href?0:t}}}}),xt={get:function(e,i){var n=lt.prop(e,i),a="boolean"==typeof n&&e.getAttribute(i),s="boolean"==typeof n?Et&&Ft?null!=a:Ot.test(i)?e[lt.camelCase("default-"+i)]:!!a:e.getAttributeNode(i);return s&&s.value!==!1?i.toLowerCase():t},set:function(e,t,i){return t===!1?lt.removeAttr(e,i):Et&&Ft||!Ot.test(i)?e.setAttribute(!Ft&&lt.propFix[i]||i,i):e[lt.camelCase("default-"+i)]=e[i]=!0,i}},Et&&Ft||(lt.attrHooks.value={get:function(e,i){var n=e.getAttributeNode(i);return lt.nodeName(e,"input")?e.defaultValue:n&&n.specified?n.value:t},set:function(e,i,n){return lt.nodeName(e,"input")?(e.defaultValue=i,t):kt&&kt.set(e,i,n)}}),Ft||(kt=lt.valHooks.button={get:function(e,i){var n=e.getAttributeNode(i);return n&&("id"===i||"name"===i||"coords"===i?""!==n.value:n.specified)?n.value:t},set:function(e,i,n){var a=e.getAttributeNode(n);return a||e.setAttributeNode(a=e.ownerDocument.createAttribute(n)),a.value=i+="","value"===n||i===e.getAttribute(n)?i:t}},lt.attrHooks.contenteditable={get:kt.get,set:function(e,t,i){kt.set(e,""===t?!1:t,i)}},lt.each(["width","height"],function(e,i){lt.attrHooks[i]=lt.extend(lt.attrHooks[i],{set:function(e,n){return""===n?(e.setAttribute(i,"auto"),n):t}})})),lt.support.hrefNormalized||(lt.each(["href","src","width","height"],function(e,i){lt.attrHooks[i]=lt.extend(lt.attrHooks[i],{get:function(e){var n=e.getAttribute(i,2);return null==n?t:n}})}),lt.each(["href","src"],function(e,t){lt.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),lt.support.style||(lt.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),lt.support.optSelected||(lt.propHooks.selected=lt.extend(lt.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),lt.support.enctype||(lt.propFix.enctype="encoding"),lt.support.checkOn||lt.each(["radio","checkbox"],function(){lt.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),lt.each(["radio","checkbox"],function(){lt.valHooks[this]=lt.extend(lt.valHooks[this],{set:function(e,i){return lt.isArray(i)?e.checked=lt.inArray(lt(e).val(),i)>=0:t}})});var Bt=/^(?:input|select|textarea)$/i,Gt=/^key/,Lt=/^(?:mouse|contextmenu)|click/,Kt=/^(?:focusinfocus|focusoutblur)$/,It=/^([^.]*)(?:\.(.+)|)$/;lt.event={global:{},add:function(e,i,n,a,s){var o,r,l,c,u,d,p,h,f,m,g,v=lt._data(e);if(v){for(n.handler&&(c=n,n=c.handler,s=c.selector),n.guid||(n.guid=lt.guid++),(r=v.events)||(r=v.events={}),(d=v.handle)||(d=v.handle=function(e){return typeof lt===U||e&&lt.event.triggered===e.type?t:lt.event.dispatch.apply(d.elem,arguments)},d.elem=e),i=(i||"").match(ut)||[""],l=i.length;l--;)o=It.exec(i[l])||[],f=g=o[1],m=(o[2]||"").split(".").sort(),u=lt.event.special[f]||{},f=(s?u.delegateType:u.bindType)||f,u=lt.event.special[f]||{},p=lt.extend({type:f,origType:g,data:a,handler:n,guid:n.guid,selector:s,needsContext:s&&lt.expr.match.needsContext.test(s),namespace:m.join(".")},c),(h=r[f])||(h=r[f]=[],h.delegateCount=0,u.setup&&u.setup.call(e,a,m,d)!==!1||(e.addEventListener?e.addEventListener(f,d,!1):e.attachEvent&&e.attachEvent("on"+f,d))),u.add&&(u.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),s?h.splice(h.delegateCount++,0,p):h.push(p),lt.event.global[f]=!0;e=null}},remove:function(e,t,i,n,a){var s,o,r,l,c,u,d,p,h,f,m,g=lt.hasData(e)&&lt._data(e);if(g&&(u=g.events)){for(t=(t||"").match(ut)||[""],c=t.length;c--;)if(r=It.exec(t[c])||[],h=m=r[1],f=(r[2]||"").split(".").sort(),h){for(d=lt.event.special[h]||{},h=(n?d.delegateType:d.bindType)||h,p=u[h]||[],r=r[2]&&RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=p.length;s--;)o=p[s],!a&&m!==o.origType||i&&i.guid!==o.guid||r&&!r.test(o.namespace)||n&&n!==o.selector&&("**"!==n||!o.selector)||(p.splice(s,1),o.selector&&p.delegateCount--,d.remove&&d.remove.call(e,o));l&&!p.length&&(d.teardown&&d.teardown.call(e,f,g.handle)!==!1||lt.removeEvent(e,h,g.handle),delete u[h])}else for(h in u)lt.event.remove(e,h+t[c],i,n,!0);lt.isEmptyObject(u)&&(delete g.handle,lt._removeData(e,"events"))}},trigger:function(i,n,a,s){var o,r,l,c,u,d,p,h=[a||V],f=ot.call(i,"type")?i.type:i,m=ot.call(i,"namespace")?i.namespace.split("."):[];if(l=d=a=a||V,3!==a.nodeType&&8!==a.nodeType&&!Kt.test(f+lt.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),r=0>f.indexOf(":")&&"on"+f,i=i[lt.expando]?i:new lt.Event(f,"object"==typeof i&&i),i.isTrigger=!0,i.namespace=m.join("."),i.namespace_re=i.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=a),n=null==n?[i]:lt.makeArray(n,[i]),u=lt.event.special[f]||{},s||!u.trigger||u.trigger.apply(a,n)!==!1)){if(!s&&!u.noBubble&&!lt.isWindow(a)){for(c=u.delegateType||f,Kt.test(c+f)||(l=l.parentNode);l;l=l.parentNode)h.push(l),d=l;d===(a.ownerDocument||V)&&h.push(d.defaultView||d.parentWindow||e)}for(p=0;(l=h[p++])&&!i.isPropagationStopped();)i.type=p>1?c:u.bindType||f,o=(lt._data(l,"events")||{})[i.type]&&lt._data(l,"handle"),o&&o.apply(l,n),o=r&&l[r],o&&lt.acceptData(l)&&o.apply&&o.apply(l,n)===!1&&i.preventDefault();if(i.type=f,!(s||i.isDefaultPrevented()||u._default&&u._default.apply(a.ownerDocument,n)!==!1||"click"===f&&lt.nodeName(a,"a")||!lt.acceptData(a)||!r||!a[f]||lt.isWindow(a))){d=a[r],d&&(a[r]=null),lt.event.triggered=f;try{a[f]()}catch(g){}lt.event.triggered=t,d&&(a[r]=d)}return i.result}},dispatch:function(e){e=lt.event.fix(e);var i,n,a,s,o,r=[],l=nt.call(arguments),c=(lt._data(this,"events")||{})[e.type]||[],u=lt.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,e)!==!1){for(r=lt.event.handlers.call(this,e,c),i=0;(s=r[i++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,o=0;(a=s.handlers[o++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(a.namespace))&&(e.handleObj=a,e.data=a.data,n=((lt.event.special[a.origType]||{}).handle||a.handler).apply(s.elem,l),n!==t&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,i){var n,a,s,o,r=[],l=i.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==e.type)){for(s=[],o=0;l>o;o++)a=i[o],n=a.selector+" ",s[n]===t&&(s[n]=a.needsContext?lt(n,this).index(c)>=0:lt.find(n,this,null,[c]).length),s[n]&&s.push(a);s.length&&r.push({elem:c,handlers:s})}return i.length>l&&r.push({elem:this,handlers:i.slice(l)}),r},fix:function(e){if(e[lt.expando])return e;var t,i,n,a=e.type,s=e,o=this.fixHooks[a];for(o||(this.fixHooks[a]=o=Lt.test(a)?this.mouseHooks:Gt.test(a)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,e=new lt.Event(s),t=n.length;t--;)i=n[t],e[i]=s[i];return e.target||(e.target=s.srcElement||V),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,a,s,o=i.button,r=i.fromElement;return null==e.pageX&&null!=i.clientX&&(a=e.target.ownerDocument||V,s=a.documentElement,n=a.body,e.pageX=i.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),e.pageY=i.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?i.toElement:r),e.which||o===t||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return lt.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==V.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===V.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var a=lt.extend(new lt.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?lt.event.trigger(a,null,t):lt.event.dispatch.call(t,a),a.isDefaultPrevented()&&i.preventDefault()}},lt.removeEvent=V.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===U&&(e[n]=null),e.detachEvent(n,i))},lt.Event=function(e,i){return this instanceof lt.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:c):this.type=e,i&&lt.extend(this,i),this.timeStamp=e&&e.timeStamp||lt.now(),this[lt.expando]=!0,t):new lt.Event(e,i)},lt.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},lt.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){lt.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,a=e.relatedTarget,s=e.handleObj;return(!a||a!==n&&!lt.contains(n,a))&&(e.type=s.origType,i=s.handler.apply(this,arguments),e.type=t),i}}}),lt.support.submitBubbles||(lt.event.special.submit={setup:function(){return lt.nodeName(this,"form")?!1:(lt.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,n=lt.nodeName(i,"input")||lt.nodeName(i,"button")?i.form:t;n&&!lt._data(n,"submitBubbles")&&(lt.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),lt._data(n,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&lt.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return lt.nodeName(this,"form")?!1:(lt.event.remove(this,"._submit"),t)}}),lt.support.changeBubbles||(lt.event.special.change={setup:function(){return Bt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(lt.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),lt.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),lt.event.simulate("change",this,e,!0)})),!1):(lt.event.add(this,"beforeactivate._change",function(e){var t=e.target;Bt.test(t.nodeName)&&!lt._data(t,"changeBubbles")&&(lt.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||lt.event.simulate("change",this.parentNode,e,!0)}),lt._data(t,"changeBubbles",!0))}),t)},handle:function(e){var i=e.target;return this!==i||e.isSimulated||e.isTrigger||"radio"!==i.type&&"checkbox"!==i.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return lt.event.remove(this,"._change"),!Bt.test(this.nodeName)}}),lt.support.focusinBubbles||lt.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){lt.event.simulate(t,e.target,lt.event.fix(e),!0)};lt.event.special[t]={setup:function(){0===i++&&V.addEventListener(e,n,!0)},teardown:function(){0===--i&&V.removeEventListener(e,n,!0)}}}),lt.fn.extend({on:function(e,i,n,a,s){var o,r;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=t);for(o in e)this.on(o,i,n,e[o],s);return this}if(null==n&&null==a?(a=i,n=i=t):null==a&&("string"==typeof i?(a=n,n=t):(a=n,n=i,i=t)),a===!1)a=c;else if(!a)return this;return 1===s&&(r=a,a=function(e){return lt().off(e),r.apply(this,arguments)},a.guid=r.guid||(r.guid=lt.guid++)),this.each(function(){lt.event.add(this,e,a,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var a,s;if(e&&e.preventDefault&&e.handleObj)return a=e.handleObj,lt(e.delegateTarget).off(a.namespace?a.origType+"."+a.namespace:a.origType,a.selector,a.handler),this;if("object"==typeof e){for(s in e)this.off(s,i,e[s]);return this}return(i===!1||"function"==typeof i)&&(n=i,i=t),n===!1&&(n=c),this.each(function(){lt.event.remove(this,e,n,i)})},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},trigger:function(e,t){return this.each(function(){lt.event.trigger(e,t,this)})},triggerHandler:function(e,i){var n=this[0];return n?lt.event.trigger(e,i,n,!0):t}}),function(e,t){function i(e){return ft.test(e+"")}function n(){var e,t=[];return e=function(i,n){return t.push(i+=" ")>A.cacheLength&&delete e[t.shift()],e[i]=n}}function a(e){return e[K]=!0,e}function s(e){var t=T.createElement("div");try{return e(t)}catch(i){return!1}finally{t=null}}function o(e,t,i,n){var a,s,o,r,l,c,u,h,f,m;if((t?t.ownerDocument||t:I)!==T&&R(t),t=t||T,i=i||[],!e||"string"!=typeof e)return i;if(1!==(r=t.nodeType)&&9!==r)return[];if(!O&&!n){if(a=mt.exec(e))if(o=a[1]){if(9===r){if(s=t.getElementById(o),!s||!s.parentNode)return i;if(s.id===o)return i.push(s),i}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&G(t,s)&&s.id===o)return i.push(s),i}else{if(a[2])return J.apply(i,Q.call(t.getElementsByTagName(e),0)),i;if((o=a[3])&&q.getByClassName&&t.getElementsByClassName)return J.apply(i,Q.call(t.getElementsByClassName(o),0)),i}if(q.qsa&&!F.test(e)){if(u=!0,h=K,f=t,m=9===r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(c=d(e),(u=t.getAttribute("id"))?h=u.replace(yt,"\\$&"):t.setAttribute("id",h),h="[id='"+h+"'] ",l=c.length;l--;)c[l]=h+p(c[l]);f=ht.test(e)&&t.parentNode||t,m=c.join(",")}if(m)try{return J.apply(i,Q.call(f.querySelectorAll(m),0)),i}catch(g){}finally{u||t.removeAttribute("id")}}}return D(e.replace(ot,"$1"),t,i,n)}function r(e,t){var i=t&&e,n=i&&(~t.sourceIndex||V)-(~e.sourceIndex||V);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function l(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function c(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function u(e){return a(function(t){return t=+t,a(function(i,n){for(var a,s=e([],i.length,t),o=s.length;o--;)i[a=s[o]]&&(i[a]=!(n[a]=i[a]))})})}function d(e,t){var i,n,a,s,r,l,c,u=$[e+" "];if(u)return t?0:u.slice(0);for(r=e,l=[],c=A.preFilter;r;){(!i||(n=rt.exec(r)))&&(n&&(r=r.slice(n[0].length)||r),l.push(a=[])),i=!1,(n=ct.exec(r))&&(i=n.shift(),a.push({value:i,type:n[0].replace(ot," ")}),r=r.slice(i.length));for(s in A.filter)!(n=pt[s].exec(r))||c[s]&&!(n=c[s](n))||(i=n.shift(),a.push({value:i,type:s,matches:n}),r=r.slice(i.length));if(!i)break}return t?r.length:r?o.error(e):$(e,l).slice(0)}function p(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function h(e,t,i){var n=t.dir,a=i&&"parentNode"===n,s=H++;return t.first?function(t,i,s){for(;t=t[n];)if(1===t.nodeType||a)return e(t,i,s)}:function(t,i,o){var r,l,c,u=j+" "+s;if(o){for(;t=t[n];)if((1===t.nodeType||a)&&e(t,i,o))return!0}else for(;t=t[n];)if(1===t.nodeType||a)if(c=t[K]||(t[K]={}),(l=c[n])&&l[0]===u){if((r=l[1])===!0||r===C)return r===!0}else if(l=c[n]=[u],l[1]=e(t,i,o)||C,l[1]===!0)return!0}}function f(e){return e.length>1?function(t,i,n){for(var a=e.length;a--;)if(!e[a](t,i,n))return!1;return!0}:e[0]}function m(e,t,i,n,a){for(var s,o=[],r=0,l=e.length,c=null!=t;l>r;r++)(s=e[r])&&(!i||i(s,n,a))&&(o.push(s),c&&t.push(r));return o}function g(e,t,i,n,s,o){return n&&!n[K]&&(n=g(n)),s&&!s[K]&&(s=g(s,o)),a(function(a,o,r,l){var c,u,d,p=[],h=[],f=o.length,g=a||b(t||"*",r.nodeType?[r]:r,[]),v=!e||!a&&t?g:m(g,p,e,r,l),y=i?s||(a?e:f||n)?[]:o:v;if(i&&i(v,y,r,l),n)for(c=m(y,h),n(c,[],r,l),u=c.length;u--;)(d=c[u])&&(y[h[u]]=!(v[h[u]]=d));if(a){if(s||e){if(s){for(c=[],u=y.length;u--;)(d=y[u])&&c.push(v[u]=d);s(null,y=[],c,l)}for(u=y.length;u--;)(d=y[u])&&(c=s?Y.call(a,d):p[u])>-1&&(a[c]=!(o[c]=d))}}else y=m(y===o?y.splice(f,y.length):y),s?s(null,o,y,l):J.apply(o,y)})}function v(e){for(var t,i,n,a=e.length,s=A.relative[e[0].type],o=s||A.relative[" "],r=s?1:0,l=h(function(e){return e===t},o,!0),c=h(function(e){return Y.call(t,e)>-1},o,!0),u=[function(e,i,n){return!s&&(n||i!==S)||((t=i).nodeType?l(e,i,n):c(e,i,n))}];a>r;r++)if(i=A.relative[e[r].type])u=[h(f(u),i)];else{if(i=A.filter[e[r].type].apply(null,e[r].matches),i[K]){for(n=++r;a>n&&!A.relative[e[n].type];n++);return g(r>1&&f(u),r>1&&p(e.slice(0,r-1)).replace(ot,"$1"),i,n>r&&v(e.slice(r,n)),a>n&&v(e=e.slice(n)),a>n&&p(e))}u.push(i)}return f(u)}function y(e,t){var i=0,n=t.length>0,s=e.length>0,r=function(a,r,l,c,u){var d,p,h,f=[],g=0,v="0",y=a&&[],b=null!=u,D=S,P=a||s&&A.find.TAG("*",u&&r.parentNode||r),_=j+=null==D?1:Math.random()||.1;for(b&&(S=r!==T&&r,C=i);null!=(d=P[v]);v++){if(s&&d){for(p=0;h=e[p++];)if(h(d,r,l)){c.push(d);break}b&&(j=_,C=++i)}n&&((d=!h&&d)&&g--,a&&y.push(d))}if(g+=v,n&&v!==g){for(p=0;h=t[p++];)h(y,f,r,l);if(a){if(g>0)for(;v--;)y[v]||f[v]||(f[v]=Z.call(c));f=m(f)}J.apply(c,f),b&&!a&&f.length>0&&g+t.length>1&&o.uniqueSort(c)}return b&&(j=_,S=D),y};return n?a(r):r}function b(e,t,i){for(var n=0,a=t.length;a>n;n++)o(e,t[n],i);return i}function D(e,t,i,n){var a,s,o,r,l,c=d(e);if(!n&&1===c.length){if(s=c[0]=c[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&9===t.nodeType&&!O&&A.relative[s[1].type]){if(t=A.find.ID(o.matches[0].replace(Dt,Pt),t)[0],!t)return i;e=e.slice(s.shift().value.length)}for(a=pt.needsContext.test(e)?0:s.length;a--&&(o=s[a],!A.relative[r=o.type]);)if((l=A.find[r])&&(n=l(o.matches[0].replace(Dt,Pt),ht.test(s[0].type)&&t.parentNode||t))){if(s.splice(a,1),e=n.length&&p(s),!e)return J.apply(i,Q.call(n,0)),i;break}}return x(e,c)(n,t,O,i,ht.test(e)),i}function P(){}var _,C,A,M,k,x,w,S,R,T,N,O,F,E,B,G,L,K="sizzle"+-new Date,I=e.document,q={},j=0,H=0,W=n(),$=n(),z=n(),U=typeof t,V=1<<31,X=[],Z=X.pop,J=X.push,Q=X.slice,Y=X.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},et="[\\x20\\t\\r\\n\\f]",tt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",it=tt.replace("w","w#"),nt="([*^$|!~]?=)",at="\\["+et+"*("+tt+")"+et+"*(?:"+nt+et+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+it+")|)|)"+et+"*\\]",st=":("+tt+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+at.replace(3,8)+")*)|.*)\\)|)",ot=RegExp("^"+et+"+|((?:^|[^\\\\])(?:\\\\.)*)"+et+"+$","g"),rt=RegExp("^"+et+"*,"+et+"*"),ct=RegExp("^"+et+"*([\\x20\\t\\r\\n\\f>+~])"+et+"*"),ut=RegExp(st),dt=RegExp("^"+it+"$"),pt={ID:RegExp("^#("+tt+")"),CLASS:RegExp("^\\.("+tt+")"),NAME:RegExp("^\\[name=['\"]?("+tt+")['\"]?\\]"),TAG:RegExp("^("+tt.replace("w","w*")+")"),ATTR:RegExp("^"+at),PSEUDO:RegExp("^"+st),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+et+"*(even|odd|(([+-]|)(\\d*)n|)"+et+"*(?:([+-]|)"+et+"*(\\d+)|))"+et+"*\\)|)","i"),needsContext:RegExp("^"+et+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+et+"*((?:-\\d)?\\d*)"+et+"*\\)|)(?=[^-]|$)","i")},ht=/[\x20\t\r\n\f]*[+~]/,ft=/^[^{]+\{\s*\[native code/,mt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,gt=/^(?:input|select|textarea|button)$/i,vt=/^h\d$/i,yt=/'|\\/g,bt=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,Dt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,Pt=function(e,t){var i="0x"+t-65536;return i!==i?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(55296|i>>10,56320|1023&i)};try{Q.call(I.documentElement.childNodes,0)[0].nodeType}catch(_t){Q=function(e){for(var t,i=[];t=this[e++];)i.push(t);return i}}k=o.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},R=o.setDocument=function(e){var n=e?e.ownerDocument||e:I;return n!==T&&9===n.nodeType&&n.documentElement?(T=n,N=n.documentElement,O=k(n),q.tagNameNoComments=s(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),q.attributes=s(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),q.getByClassName=s(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),q.getByName=s(function(e){e.id=K+0,e.innerHTML="<a name='"+K+"'></a><div name='"+K+"'></div>",N.insertBefore(e,N.firstChild);var t=n.getElementsByName&&n.getElementsByName(K).length===2+n.getElementsByName(K+0).length;return q.getIdNotName=!n.getElementById(K),N.removeChild(e),t}),A.attrHandle=s(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==U&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},q.getIdNotName?(A.find.ID=function(e,t){if(typeof t.getElementById!==U&&!O){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},A.filter.ID=function(e){var t=e.replace(Dt,Pt);return function(e){return e.getAttribute("id")===t}}):(A.find.ID=function(e,i){if(typeof i.getElementById!==U&&!O){var n=i.getElementById(e);return n?n.id===e||typeof n.getAttributeNode!==U&&n.getAttributeNode("id").value===e?[n]:t:[]}},A.filter.ID=function(e){var t=e.replace(Dt,Pt);return function(e){var i=typeof e.getAttributeNode!==U&&e.getAttributeNode("id");return i&&i.value===t}}),A.find.TAG=q.tagNameNoComments?function(e,i){return typeof i.getElementsByTagName!==U?i.getElementsByTagName(e):t}:function(e,t){var i,n=[],a=0,s=t.getElementsByTagName(e);if("*"===e){for(;i=s[a++];)1===i.nodeType&&n.push(i);return n}return s},A.find.NAME=q.getByName&&function(e,i){return typeof i.getElementsByName!==U?i.getElementsByName(name):t},A.find.CLASS=q.getByClassName&&function(e,i){return typeof i.getElementsByClassName===U||O?t:i.getElementsByClassName(e)},E=[],F=[":focus"],(q.qsa=i(n.querySelectorAll))&&(s(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||F.push("\\["+et+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||F.push(":checked")}),s(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&F.push("[*^$]="+et+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),F.push(",.*:")})),(q.matchesSelector=i(B=N.matchesSelector||N.mozMatchesSelector||N.webkitMatchesSelector||N.oMatchesSelector||N.msMatchesSelector))&&s(function(e){q.disconnectedMatch=B.call(e,"div"),B.call(e,"[s!='']:x"),E.push("!=",st)}),F=RegExp(F.join("|")),E=RegExp(E.join("|")),G=i(N.contains)||N.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},L=N.compareDocumentPosition?function(e,t){var i;return e===t?(w=!0,0):(i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&i||e.parentNode&&11===e.parentNode.nodeType?e===n||G(I,e)?-1:t===n||G(I,t)?1:0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var i,a=0,s=e.parentNode,o=t.parentNode,l=[e],c=[t];if(e===t)return w=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:0;if(s===o)return r(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)c.unshift(i);for(;l[a]===c[a];)a++;return a?r(l[a],c[a]):l[a]===I?-1:c[a]===I?1:0},w=!1,[0,0].sort(L),q.detectDuplicates=w,T):T},o.matches=function(e,t){return o(e,null,null,t)},o.matchesSelector=function(e,t){if((e.ownerDocument||e)!==T&&R(e),t=t.replace(bt,"='$1']"),!(!q.matchesSelector||O||E&&E.test(t)||F.test(t)))try{var i=B.call(e,t);if(i||q.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(n){}return o(t,T,null,[e]).length>0},o.contains=function(e,t){return(e.ownerDocument||e)!==T&&R(e),G(e,t)},o.attr=function(e,t){var i;return(e.ownerDocument||e)!==T&&R(e),O||(t=t.toLowerCase()),(i=A.attrHandle[t])?i(e):O||q.attributes?e.getAttribute(t):((i=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:i&&i.specified?i.value:null},o.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},o.uniqueSort=function(e){var t,i=[],n=1,a=0;if(w=!q.detectDuplicates,e.sort(L),w){for(;t=e[n];n++)t===e[n-1]&&(a=i.push(n));for(;a--;)e.splice(i[a],1)}return e},M=o.getText=function(e){var t,i="",n=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=M(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[n];n++)i+=M(t);return i},A=o.selectors={cacheLength:50,createPseudo:a,match:pt,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Dt,Pt),e[3]=(e[4]||e[5]||"").replace(Dt,Pt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||o.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&o.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return pt.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:i&&ut.test(i)&&(t=d(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(Dt,Pt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=W[e+" "];return t||(t=RegExp("(^|"+et+")"+e+"("+et+"|$)"))&&W(e,function(e){return t.test(e.className||typeof e.getAttribute!==U&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(n){var a=o.attr(n,e);return null==a?"!="===t:t?(a+="","="===t?a===i:"!="===t?a!==i:"^="===t?i&&0===a.indexOf(i):"*="===t?i&&a.indexOf(i)>-1:"$="===t?i&&a.slice(-i.length)===i:"~="===t?(" "+a+" ").indexOf(i)>-1:"|="===t?a===i||a.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,i,n,a){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),r="of-type"===t;return 1===n&&0===a?function(e){return!!e.parentNode}:function(t,i,l){var c,u,d,p,h,f,m=s!==o?"nextSibling":"previousSibling",g=t.parentNode,v=r&&t.nodeName.toLowerCase(),y=!l&&!r;if(g){if(s){for(;m;){for(d=t;d=d[m];)if(r?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&y){for(u=g[K]||(g[K]={}),c=u[e]||[],h=c[0]===j&&c[1],p=c[0]===j&&c[2],d=h&&g.childNodes[h];d=++h&&d&&d[m]||(p=h=0)||f.pop();)if(1===d.nodeType&&++p&&d===t){u[e]=[j,h,p];break}}else if(y&&(c=(t[K]||(t[K]={}))[e])&&c[0]===j)p=c[1];else for(;(d=++h&&d&&d[m]||(p=h=0)||f.pop())&&((r?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++p||(y&&((d[K]||(d[K]={}))[e]=[j,p]),d!==t)););return p-=a,p===n||0===p%n&&p/n>=0}}},PSEUDO:function(e,t){var i,n=A.pseudos[e]||A.setFilters[e.toLowerCase()]||o.error("unsupported pseudo: "+e);return n[K]?n(t):n.length>1?(i=[e,e,"",t],A.setFilters.hasOwnProperty(e.toLowerCase())?a(function(e,i){for(var a,s=n(e,t),o=s.length;o--;)a=Y.call(e,s[o]),e[a]=!(i[a]=s[o])}):function(e){return n(e,0,i)}):n}},pseudos:{not:a(function(e){var t=[],i=[],n=x(e.replace(ot,"$1"));return n[K]?a(function(e,t,i,a){for(var s,o=n(e,null,a,[]),r=e.length;r--;)(s=o[r])&&(e[r]=!(t[r]=s))}):function(e,a,s){return t[0]=e,n(t,null,s,i),!i.pop()}}),has:a(function(e){return function(t){return o(e,t).length>0}}),contains:a(function(e){return function(t){return(t.textContent||t.innerText||M(t)).indexOf(e)>-1}}),lang:a(function(e){return dt.test(e||"")||o.error("unsupported lang: "+e),e=e.replace(Dt,Pt).toLowerCase(),function(t){var i;do if(i=O?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===N},focus:function(e){return e===T.activeElement&&(!T.hasFocus||T.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!A.pseudos.empty(e)},header:function(e){return vt.test(e.nodeName)},input:function(e){return gt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:u(function(){return[0]}),last:u(function(e,t){return[t-1]
}),eq:u(function(e,t,i){return[0>i?i+t:i]}),even:u(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:u(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:u(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:u(function(e,t,i){for(var n=0>i?i+t:i;t>++n;)e.push(n);return e})}};for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})A.pseudos[_]=l(_);for(_ in{submit:!0,reset:!0})A.pseudos[_]=c(_);x=o.compile=function(e,t){var i,n=[],a=[],s=z[e+" "];if(!s){for(t||(t=d(e)),i=t.length;i--;)s=v(t[i]),s[K]?n.push(s):a.push(s);s=z(e,y(a,n))}return s},A.pseudos.nth=A.pseudos.eq,A.filters=P.prototype=A.pseudos,A.setFilters=new P,R(),o.attr=lt.attr,lt.find=o,lt.expr=o.selectors,lt.expr[":"]=lt.expr.pseudos,lt.unique=o.uniqueSort,lt.text=o.getText,lt.isXMLDoc=o.isXML,lt.contains=o.contains}(e);var qt=/Until$/,jt=/^(?:parents|prev(?:Until|All))/,Ht=/^.[^:#\[\.,]*$/,Wt=lt.expr.match.needsContext,$t={children:!0,contents:!0,next:!0,prev:!0};lt.fn.extend({find:function(e){var t,i,n,a=this.length;if("string"!=typeof e)return n=this,this.pushStack(lt(e).filter(function(){for(t=0;a>t;t++)if(lt.contains(n[t],this))return!0}));for(i=[],t=0;a>t;t++)lt.find(e,this[t],i);return i=this.pushStack(a>1?lt.unique(i):i),i.selector=(this.selector?this.selector+" ":"")+e,i},has:function(e){var t,i=lt(e,this),n=i.length;return this.filter(function(){for(t=0;n>t;t++)if(lt.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(d(this,e,!1))},filter:function(e){return this.pushStack(d(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?Wt.test(e)?lt(e,this.context).index(this[0])>=0:lt.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var i,n=0,a=this.length,s=[],o=Wt.test(e)||"string"!=typeof e?lt(e,t||this.context):0;a>n;n++)for(i=this[n];i&&i.ownerDocument&&i!==t&&11!==i.nodeType;){if(o?o.index(i)>-1:lt.find.matchesSelector(i,e)){s.push(i);break}i=i.parentNode}return this.pushStack(s.length>1?lt.unique(s):s)},index:function(e){return e?"string"==typeof e?lt.inArray(this[0],lt(e)):lt.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?lt(e,t):lt.makeArray(e&&e.nodeType?[e]:e),n=lt.merge(this.get(),i);return this.pushStack(lt.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),lt.fn.andSelf=lt.fn.addBack,lt.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return lt.dir(e,"parentNode")},parentsUntil:function(e,t,i){return lt.dir(e,"parentNode",i)},next:function(e){return u(e,"nextSibling")},prev:function(e){return u(e,"previousSibling")},nextAll:function(e){return lt.dir(e,"nextSibling")},prevAll:function(e){return lt.dir(e,"previousSibling")},nextUntil:function(e,t,i){return lt.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return lt.dir(e,"previousSibling",i)},siblings:function(e){return lt.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return lt.sibling(e.firstChild)},contents:function(e){return lt.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:lt.merge([],e.childNodes)}},function(e,t){lt.fn[e]=function(i,n){var a=lt.map(this,t,i);return qt.test(e)||(n=i),n&&"string"==typeof n&&(a=lt.filter(n,a)),a=this.length>1&&!$t[e]?lt.unique(a):a,this.length>1&&jt.test(e)&&(a=a.reverse()),this.pushStack(a)}}),lt.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?lt.find.matchesSelector(t[0],e)?[t[0]]:[]:lt.find.matches(e,t)},dir:function(e,i,n){for(var a=[],s=e[i];s&&9!==s.nodeType&&(n===t||1!==s.nodeType||!lt(s).is(n));)1===s.nodeType&&a.push(s),s=s[i];return a},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var zt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ut=/ jQuery\d+="(?:null|\d+)"/g,Vt=RegExp("<(?:"+zt+")[\\s/>]","i"),Xt=/^\s+/,Zt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Jt=/<([\w:]+)/,Qt=/<tbody/i,Yt=/<|&#?\w+;/,ei=/<(?:script|style|link)/i,ti=/^(?:checkbox|radio)$/i,ii=/checked\s*(?:[^=]|=\s*.checked.)/i,ni=/^$|\/(?:java|ecma)script/i,ai=/^true\/(.*)/,si=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,oi={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:lt.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ri=p(V),li=ri.appendChild(V.createElement("div"));oi.optgroup=oi.option,oi.tbody=oi.tfoot=oi.colgroup=oi.caption=oi.thead,oi.th=oi.td,lt.fn.extend({text:function(e){return lt.access(this,function(e){return e===t?lt.text(this):this.empty().append((this[0]&&this[0].ownerDocument||V).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(lt.isFunction(e))return this.each(function(t){lt(this).wrapAll(e.call(this,t))});if(this[0]){var t=lt(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return lt.isFunction(e)?this.each(function(t){lt(this).wrapInner(e.call(this,t))}):this.each(function(){var t=lt(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=lt.isFunction(e);return this.each(function(i){lt(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){lt.nodeName(this,"body")||lt(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=0;null!=(i=this[n]);n++)(!e||lt.filter(e,[i]).length>0)&&(t||1!==i.nodeType||lt.cleanData(b(i)),i.parentNode&&(t&&lt.contains(i.ownerDocument,i)&&g(b(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&lt.cleanData(b(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&lt.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return lt.clone(this,e,t)})},html:function(e){return lt.access(this,function(e){var i=this[0]||{},n=0,a=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(Ut,""):t;if(!("string"!=typeof e||ei.test(e)||!lt.support.htmlSerialize&&Vt.test(e)||!lt.support.leadingWhitespace&&Xt.test(e)||oi[(Jt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Zt,"<$1></$2>");try{for(;a>n;n++)i=this[n]||{},1===i.nodeType&&(lt.cleanData(b(i,!1)),i.innerHTML=e);i=0}catch(s){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=lt.isFunction(e);return t||"string"==typeof e||(e=lt(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,i=this.parentNode;i&&(lt(this).remove(),i.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,i,n){e=tt.apply([],e);var a,s,o,r,l,c,u=0,d=this.length,p=this,g=d-1,v=e[0],y=lt.isFunction(v);if(y||!(1>=d||"string"!=typeof v||lt.support.checkClone)&&ii.test(v))return this.each(function(a){var s=p.eq(a);y&&(e[0]=v.call(this,a,i?s.html():t)),s.domManip(e,i,n)});if(d&&(c=lt.buildFragment(e,this[0].ownerDocument,!1,this),a=c.firstChild,1===c.childNodes.length&&(c=a),a)){for(i=i&&lt.nodeName(a,"tr"),r=lt.map(b(c,"script"),f),o=r.length;d>u;u++)s=c,u!==g&&(s=lt.clone(s,!0,!0),o&&lt.merge(r,b(s,"script"))),n.call(i&&lt.nodeName(this[u],"table")?h(this[u],"tbody"):this[u],s,u);if(o)for(l=r[r.length-1].ownerDocument,lt.map(r,m),u=0;o>u;u++)s=r[u],ni.test(s.type||"")&&!lt._data(s,"globalEval")&&lt.contains(l,s)&&(s.src?lt.ajax({url:s.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):lt.globalEval((s.text||s.textContent||s.innerHTML||"").replace(si,"")));c=a=null}return this}}),lt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){lt.fn[e]=function(e){for(var i,n=0,a=[],s=lt(e),o=s.length-1;o>=n;n++)i=n===o?this:this.clone(!0),lt(s[n])[t](i),it.apply(a,i.get());return this.pushStack(a)}}),lt.extend({clone:function(e,t,i){var n,a,s,o,r,l=lt.contains(e.ownerDocument,e);if(lt.support.html5Clone||lt.isXMLDoc(e)||!Vt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(li.innerHTML=e.outerHTML,li.removeChild(s=li.firstChild)),!(lt.support.noCloneEvent&&lt.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||lt.isXMLDoc(e)))for(n=b(s),r=b(e),o=0;null!=(a=r[o]);++o)n[o]&&y(a,n[o]);if(t)if(i)for(r=r||b(e),n=n||b(s),o=0;null!=(a=r[o]);o++)v(a,n[o]);else v(e,s);return n=b(s,"script"),n.length>0&&g(n,!l&&b(e,"script")),n=r=a=null,s},buildFragment:function(e,t,i,n){for(var a,s,o,r,l,c,u,d=e.length,h=p(t),f=[],m=0;d>m;m++)if(s=e[m],s||0===s)if("object"===lt.type(s))lt.merge(f,s.nodeType?[s]:s);else if(Yt.test(s)){for(r=r||h.appendChild(t.createElement("div")),l=(Jt.exec(s)||["",""])[1].toLowerCase(),u=oi[l]||oi._default,r.innerHTML=u[1]+s.replace(Zt,"<$1></$2>")+u[2],a=u[0];a--;)r=r.lastChild;if(!lt.support.leadingWhitespace&&Xt.test(s)&&f.push(t.createTextNode(Xt.exec(s)[0])),!lt.support.tbody)for(s="table"!==l||Qt.test(s)?"<table>"!==u[1]||Qt.test(s)?0:r:r.firstChild,a=s&&s.childNodes.length;a--;)lt.nodeName(c=s.childNodes[a],"tbody")&&!c.childNodes.length&&s.removeChild(c);for(lt.merge(f,r.childNodes),r.textContent="";r.firstChild;)r.removeChild(r.firstChild);r=h.lastChild}else f.push(t.createTextNode(s));for(r&&h.removeChild(r),lt.support.appendChecked||lt.grep(b(f,"input"),D),m=0;s=f[m++];)if((!n||-1===lt.inArray(s,n))&&(o=lt.contains(s.ownerDocument,s),r=b(h.appendChild(s),"script"),o&&g(r),i))for(a=0;s=r[a++];)ni.test(s.type||"")&&i.push(s);return r=null,h},cleanData:function(e,t){for(var i,n,a,s,o=0,r=lt.expando,l=lt.cache,c=lt.support.deleteExpando,u=lt.event.special;null!=(i=e[o]);o++)if((t||lt.acceptData(i))&&(a=i[r],s=a&&l[a])){if(s.events)for(n in s.events)u[n]?lt.event.remove(i,n):lt.removeEvent(i,n,s.handle);l[a]&&(delete l[a],c?delete i[r]:typeof i.removeAttribute!==U?i.removeAttribute(r):i[r]=null,Y.push(a))}}});var ci,ui,di,pi=/alpha\([^)]*\)/i,hi=/opacity\s*=\s*([^)]*)/,fi=/^(top|right|bottom|left)$/,mi=/^(none|table(?!-c[ea]).+)/,gi=/^margin/,vi=RegExp("^("+ct+")(.*)$","i"),yi=RegExp("^("+ct+")(?!px)[a-z%]+$","i"),bi=RegExp("^([+-])=("+ct+")","i"),Di={BODY:"block"},Pi={position:"absolute",visibility:"hidden",display:"block"},_i={letterSpacing:0,fontWeight:400},Ci=["Top","Right","Bottom","Left"],Ai=["Webkit","O","Moz","ms"];lt.fn.extend({css:function(e,i){return lt.access(this,function(e,i,n){var a,s,o={},r=0;if(lt.isArray(i)){for(s=ui(e),a=i.length;a>r;r++)o[i[r]]=lt.css(e,i[r],!1,s);return o}return n!==t?lt.style(e,i,n):lt.css(e,i)},e,i,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:_(this))?lt(this).show():lt(this).hide()})}}),lt.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=di(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":lt.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,a){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,r,l=lt.camelCase(i),c=e.style;if(i=lt.cssProps[l]||(lt.cssProps[l]=P(c,l)),r=lt.cssHooks[i]||lt.cssHooks[l],n===t)return r&&"get"in r&&(s=r.get(e,!1,a))!==t?s:c[i];if(o=typeof n,"string"===o&&(s=bi.exec(n))&&(n=(s[1]+1)*s[2]+parseFloat(lt.css(e,i)),o="number"),!(null==n||"number"===o&&isNaN(n)||("number"!==o||lt.cssNumber[l]||(n+="px"),lt.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(c[i]="inherit"),r&&"set"in r&&(n=r.set(e,n,a))===t)))try{c[i]=n}catch(u){}}},css:function(e,i,n,a){var s,o,r,l=lt.camelCase(i);return i=lt.cssProps[l]||(lt.cssProps[l]=P(e.style,l)),r=lt.cssHooks[i]||lt.cssHooks[l],r&&"get"in r&&(o=r.get(e,!0,n)),o===t&&(o=di(e,i,a)),"normal"===o&&i in _i&&(o=_i[i]),""===n||n?(s=parseFloat(o),n===!0||lt.isNumeric(s)?s||0:o):o},swap:function(e,t,i,n){var a,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];a=i.apply(e,n||[]);for(s in t)e.style[s]=o[s];return a}}),e.getComputedStyle?(ui=function(t){return e.getComputedStyle(t,null)},di=function(e,i,n){var a,s,o,r=n||ui(e),l=r?r.getPropertyValue(i)||r[i]:t,c=e.style;return r&&(""!==l||lt.contains(e.ownerDocument,e)||(l=lt.style(e,i)),yi.test(l)&&gi.test(i)&&(a=c.width,s=c.minWidth,o=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=r.width,c.width=a,c.minWidth=s,c.maxWidth=o)),l}):V.documentElement.currentStyle&&(ui=function(e){return e.currentStyle},di=function(e,i,n){var a,s,o,r=n||ui(e),l=r?r[i]:t,c=e.style;return null==l&&c&&c[i]&&(l=c[i]),yi.test(l)&&!fi.test(i)&&(a=c.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),c.left="fontSize"===i?"1em":l,l=c.pixelLeft+"px",c.left=a,o&&(s.left=o)),""===l?"auto":l}),lt.each(["height","width"],function(e,i){lt.cssHooks[i]={get:function(e,n,a){return n?0===e.offsetWidth&&mi.test(lt.css(e,"display"))?lt.swap(e,Pi,function(){return k(e,i,a)}):k(e,i,a):t},set:function(e,t,n){var a=n&&ui(e);return A(e,t,n?M(e,i,n,lt.support.boxSizing&&"border-box"===lt.css(e,"boxSizing",!1,a),a):0)}}}),lt.support.opacity||(lt.cssHooks.opacity={get:function(e,t){return hi.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,a=lt.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=n&&n.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===lt.trim(s.replace(pi,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=pi.test(s)?s.replace(pi,a):s+" "+a)}}),lt(function(){lt.support.reliableMarginRight||(lt.cssHooks.marginRight={get:function(e,i){return i?lt.swap(e,{display:"inline-block"},di,[e,"marginRight"]):t}}),!lt.support.pixelPosition&&lt.fn.position&&lt.each(["top","left"],function(e,i){lt.cssHooks[i]={get:function(e,n){return n?(n=di(e,i),yi.test(n)?lt(e).position()[i]+"px":n):t}}})}),lt.expr&&lt.expr.filters&&(lt.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!lt.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||lt.css(e,"display"))},lt.expr.filters.visible=function(e){return!lt.expr.filters.hidden(e)}),lt.each({margin:"",padding:"",border:"Width"},function(e,t){lt.cssHooks[e+t]={expand:function(i){for(var n=0,a={},s="string"==typeof i?i.split(" "):[i];4>n;n++)a[e+Ci[n]+t]=s[n]||s[n-2]||s[0];return a}},gi.test(e)||(lt.cssHooks[e+t].set=A)});var Mi=/%20/g,ki=/\[\]$/,xi=/\r?\n/g,wi=/^(?:submit|button|image|reset|file)$/i,Si=/^(?:input|select|textarea|keygen)/i;lt.fn.extend({serialize:function(){return lt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=lt.prop(this,"elements");return e?lt.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!lt(this).is(":disabled")&&Si.test(this.nodeName)&&!wi.test(e)&&(this.checked||!ti.test(e))}).map(function(e,t){var i=lt(this).val();return null==i?null:lt.isArray(i)?lt.map(i,function(e){return{name:t.name,value:e.replace(xi,"\r\n")}}):{name:t.name,value:i.replace(xi,"\r\n")}}).get()}}),lt.param=function(e,i){var n,a=[],s=function(e,t){t=lt.isFunction(t)?t():null==t?"":t,a[a.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=lt.ajaxSettings&&lt.ajaxSettings.traditional),lt.isArray(e)||e.jquery&&!lt.isPlainObject(e))lt.each(e,function(){s(this.name,this.value)});else for(n in e)S(n,e[n],i,s);return a.join("&").replace(Mi,"+")},lt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){lt.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),lt.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var Ri,Ti,Ni=lt.now(),Oi=/\?/,Fi=/#.*$/,Ei=/([?&])_=[^&]*/,Bi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Gi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Li=/^(?:GET|HEAD)$/,Ki=/^\/\//,Ii=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,qi=lt.fn.load,ji={},Hi={},Wi="*/".concat("*");try{Ti=X.href}catch($i){Ti=V.createElement("a"),Ti.href="",Ti=Ti.href}Ri=Ii.exec(Ti.toLowerCase())||[],lt.fn.load=function(e,i,n){if("string"!=typeof e&&qi)return qi.apply(this,arguments);var a,s,o,r=this,l=e.indexOf(" ");return l>=0&&(a=e.slice(l,e.length),e=e.slice(0,l)),lt.isFunction(i)?(n=i,i=t):i&&"object"==typeof i&&(o="POST"),r.length>0&&lt.ajax({url:e,type:o,dataType:"html",data:i}).done(function(e){s=arguments,r.html(a?lt("<div>").append(lt.parseHTML(e)).find(a):e)}).complete(n&&function(e,t){r.each(n,s||[e.responseText,t,e])}),this},lt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){lt.fn[t]=function(e){return this.on(t,e)}}),lt.each(["get","post"],function(e,i){lt[i]=function(e,n,a,s){return lt.isFunction(n)&&(s=s||a,a=n,n=t),lt.ajax({url:e,type:i,dataType:s,data:n,success:a})}}),lt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ti,type:"GET",isLocal:Gi.test(Ri[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Wi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":lt.parseJSON,"text xml":lt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?N(N(e,lt.ajaxSettings),t):N(lt.ajaxSettings,e)},ajaxPrefilter:R(ji),ajaxTransport:R(Hi),ajax:function(e,i){function n(e,i,n,a){var s,d,y,b,P,C=i;2!==D&&(D=2,l&&clearTimeout(l),u=t,r=a||"",_.readyState=e>0?4:0,n&&(b=O(p,_,n)),e>=200&&300>e||304===e?(p.ifModified&&(P=_.getResponseHeader("Last-Modified"),P&&(lt.lastModified[o]=P),P=_.getResponseHeader("etag"),P&&(lt.etag[o]=P)),204===e?(s=!0,C="nocontent"):304===e?(s=!0,C="notmodified"):(s=F(p,b),C=s.state,d=s.data,y=s.error,s=!y)):(y=C,(e||!C)&&(C="error",0>e&&(e=0))),_.status=e,_.statusText=(i||C)+"",s?m.resolveWith(h,[d,C,_]):m.rejectWith(h,[_,C,y]),_.statusCode(v),v=t,c&&f.trigger(s?"ajaxSuccess":"ajaxError",[_,p,s?d:y]),g.fireWith(h,[_,C]),c&&(f.trigger("ajaxComplete",[_,p]),--lt.active||lt.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var a,s,o,r,l,c,u,d,p=lt.ajaxSetup({},i),h=p.context||p,f=p.context&&(h.nodeType||h.jquery)?lt(h):lt.event,m=lt.Deferred(),g=lt.Callbacks("once memory"),v=p.statusCode||{},y={},b={},D=0,P="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===D){if(!d)for(d={};t=Bi.exec(r);)d[t[1].toLowerCase()]=t[2];t=d[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===D?r:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return D||(e=b[i]=b[i]||e,y[e]=t),this},overrideMimeType:function(e){return D||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>D)for(t in e)v[t]=[v[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||P;return u&&u.abort(t),n(0,t),this}};if(m.promise(_).complete=g.add,_.success=_.done,_.error=_.fail,p.url=((e||p.url||Ti)+"").replace(Fi,"").replace(Ki,Ri[1]+"//"),p.type=i.method||i.type||p.method||p.type,p.dataTypes=lt.trim(p.dataType||"*").toLowerCase().match(ut)||[""],null==p.crossDomain&&(a=Ii.exec(p.url.toLowerCase()),p.crossDomain=!(!a||a[1]===Ri[1]&&a[2]===Ri[2]&&(a[3]||("http:"===a[1]?80:443))==(Ri[3]||("http:"===Ri[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=lt.param(p.data,p.traditional)),T(ji,p,i,_),2===D)return _;c=p.global,c&&0===lt.active++&&lt.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Li.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(Oi.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=Ei.test(o)?o.replace(Ei,"$1_="+Ni++):o+(Oi.test(o)?"&":"?")+"_="+Ni++)),p.ifModified&&(lt.lastModified[o]&&_.setRequestHeader("If-Modified-Since",lt.lastModified[o]),lt.etag[o]&&_.setRequestHeader("If-None-Match",lt.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||i.contentType)&&_.setRequestHeader("Content-Type",p.contentType),_.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Wi+"; q=0.01":""):p.accepts["*"]);for(s in p.headers)_.setRequestHeader(s,p.headers[s]);if(p.beforeSend&&(p.beforeSend.call(h,_,p)===!1||2===D))return _.abort();P="abort";for(s in{success:1,error:1,complete:1})_[s](p[s]);if(u=T(Hi,p,i,_)){_.readyState=1,c&&f.trigger("ajaxSend",[_,p]),p.async&&p.timeout>0&&(l=setTimeout(function(){_.abort("timeout")},p.timeout));try{D=1,u.send(y,n)}catch(C){if(!(2>D))throw C;n(-1,C)}}else n(-1,"No Transport");return _},getScript:function(e,i){return lt.get(e,t,i,"script")},getJSON:function(e,t,i){return lt.get(e,t,i,"json")}}),lt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return lt.globalEval(e),e}}}),lt.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),lt.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=V.head||lt("head")[0]||V.documentElement;return{send:function(t,a){i=V.createElement("script"),i.async=!0,e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||a(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(t,!0)}}}});var zi=[],Ui=/(=)\?(?=&|$)|\?\?/;lt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zi.pop()||lt.expando+"_"+Ni++;return this[e]=!0,e}}),lt.ajaxPrefilter("json jsonp",function(i,n,a){var s,o,r,l=i.jsonp!==!1&&(Ui.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ui.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(s=i.jsonpCallback=lt.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Ui,"$1"+s):i.jsonp!==!1&&(i.url+=(Oi.test(i.url)?"&":"?")+i.jsonp+"="+s),i.converters["script json"]=function(){return r||lt.error(s+" was not called"),r[0]},i.dataTypes[0]="json",o=e[s],e[s]=function(){r=arguments},a.always(function(){e[s]=o,i[s]&&(i.jsonpCallback=n.jsonpCallback,zi.push(s)),r&&lt.isFunction(o)&&o(r[0]),r=o=t}),"script"):t});var Vi,Xi,Zi=0,Ji=e.ActiveXObject&&function(){var e;for(e in Vi)Vi[e](t,!0)};lt.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&E()||B()}:E,Xi=lt.ajaxSettings.xhr(),lt.support.cors=!!Xi&&"withCredentials"in Xi,Xi=lt.support.ajax=!!Xi,Xi&&lt.ajaxTransport(function(i){if(!i.crossDomain||lt.support.cors){var n;return{send:function(a,s){var o,r,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(r in i.xhrFields)l[r]=i.xhrFields[r];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||a["X-Requested-With"]||(a["X-Requested-With"]="XMLHttpRequest");try{for(r in a)l.setRequestHeader(r,a[r])}catch(c){}l.send(i.hasContent&&i.data||null),n=function(e,a){var r,c,u,d;try{if(n&&(a||4===l.readyState))if(n=t,o&&(l.onreadystatechange=lt.noop,Ji&&delete Vi[o]),a)4!==l.readyState&&l.abort();else{d={},r=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(d.text=l.responseText);try{u=l.statusText}catch(p){u=""}r||!i.isLocal||i.crossDomain?1223===r&&(r=204):r=d.text?200:404}}catch(h){a||s(-1,h)}d&&s(r,u,d,c)},i.async?4===l.readyState?setTimeout(n):(o=++Zi,Ji&&(Vi||(Vi={},lt(e).unload(Ji)),Vi[o]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(t,!0)}}}});var Qi,Yi,en=/^(?:toggle|show|hide)$/,tn=RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),nn=/queueHooks$/,an=[q],sn={"*":[function(e,t){var i,n,a=this.createTween(e,t),s=tn.exec(t),o=a.cur(),r=+o||0,l=1,c=20;if(s){if(i=+s[2],n=s[3]||(lt.cssNumber[e]?"":"px"),"px"!==n&&r){r=lt.css(a.elem,e,!0)||i||1;do l=l||".5",r/=l,lt.style(a.elem,e,r+n);while(l!==(l=a.cur()/o)&&1!==l&&--c)}a.unit=n,a.start=r,a.end=s[1]?r+(s[1]+1)*i:i}return a}]};lt.Animation=lt.extend(K,{tweener:function(e,t){lt.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,a=e.length;a>n;n++)i=e[n],sn[i]=sn[i]||[],sn[i].unshift(t)},prefilter:function(e,t){t?an.unshift(e):an.push(e)}}),lt.Tween=j,j.prototype={constructor:j,init:function(e,t,i,n,a,s){this.elem=e,this.prop=i,this.easing=a||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=s||(lt.cssNumber[i]?"":"px")},cur:function(){var e=j.propHooks[this.prop];return e&&e.get?e.get(this):j.propHooks._default.get(this)},run:function(e){var t,i=j.propHooks[this.prop];return this.pos=t=this.options.duration?lt.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):j.propHooks._default.set(this),this}},j.prototype.init.prototype=j.prototype,j.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=lt.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){lt.fx.step[e.prop]?lt.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[lt.cssProps[e.prop]]||lt.cssHooks[e.prop])?lt.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},j.propHooks.scrollTop=j.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},lt.each(["toggle","show","hide"],function(e,t){var i=lt.fn[t];lt.fn[t]=function(e,n,a){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(H(t,!0),e,n,a)}}),lt.fn.extend({fadeTo:function(e,t,i,n){return this.filter(_).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var a=lt.isEmptyObject(e),s=lt.speed(t,i,n),o=function(){var t=K(this,lt.extend({},e),s);o.finish=function(){t.stop(!0)},(a||lt._data(this,"finish"))&&t.stop(!0)};return o.finish=o,a||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,i,n){var a=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=lt.timers,o=lt._data(this);if(i)o[i]&&o[i].stop&&a(o[i]);else for(i in o)o[i]&&o[i].stop&&nn.test(i)&&a(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&lt.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=lt._data(this),n=i[e+"queue"],a=i[e+"queueHooks"],s=lt.timers,o=n?n.length:0;for(i.finish=!0,lt.queue(this,e,[]),a&&a.cur&&a.cur.finish&&a.cur.finish.call(this),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),lt.each({slideDown:H("show"),slideUp:H("hide"),slideToggle:H("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){lt.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),lt.speed=function(e,t,i){var n=e&&"object"==typeof e?lt.extend({},e):{complete:i||!i&&t||lt.isFunction(e)&&e,duration:e,easing:i&&t||t&&!lt.isFunction(t)&&t};return n.duration=lt.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in lt.fx.speeds?lt.fx.speeds[n.duration]:lt.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){lt.isFunction(n.old)&&n.old.call(this),n.queue&&lt.dequeue(this,n.queue)},n},lt.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},lt.timers=[],lt.fx=j.prototype.init,lt.fx.tick=function(){var e,i=lt.timers,n=0;for(Qi=lt.now();i.length>n;n++)e=i[n],e()||i[n]!==e||i.splice(n--,1);i.length||lt.fx.stop(),Qi=t},lt.fx.timer=function(e){e()&&lt.timers.push(e)&&lt.fx.start()},lt.fx.interval=13,lt.fx.start=function(){Yi||(Yi=setInterval(lt.fx.tick,lt.fx.interval))},lt.fx.stop=function(){clearInterval(Yi),Yi=null},lt.fx.speeds={slow:600,fast:200,_default:400},lt.fx.step={},lt.expr&&lt.expr.filters&&(lt.expr.filters.animated=function(e){return lt.grep(lt.timers,function(t){return e===t.elem}).length}),lt.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){lt.offset.setOffset(this,e,t)});var i,n,a={top:0,left:0},s=this[0],o=s&&s.ownerDocument;return o?(i=o.documentElement,lt.contains(i,s)?(typeof s.getBoundingClientRect!==U&&(a=s.getBoundingClientRect()),n=W(o),{top:a.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:a.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):a):void 0},lt.offset={setOffset:function(e,t,i){var n=lt.css(e,"position");"static"===n&&(e.style.position="relative");var a,s,o=lt(e),r=o.offset(),l=lt.css(e,"top"),c=lt.css(e,"left"),u=("absolute"===n||"fixed"===n)&&lt.inArray("auto",[l,c])>-1,d={},p={};u?(p=o.position(),a=p.top,s=p.left):(a=parseFloat(l)||0,s=parseFloat(c)||0),lt.isFunction(t)&&(t=t.call(e,i,r)),null!=t.top&&(d.top=t.top-r.top+a),null!=t.left&&(d.left=t.left-r.left+s),"using"in t?t.using.call(e,d):o.css(d)}},lt.fn.extend({position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===lt.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),lt.nodeName(e[0],"html")||(i=e.offset()),i.top+=lt.css(e[0],"borderTopWidth",!0),i.left+=lt.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-lt.css(n,"marginTop",!0),left:t.left-i.left-lt.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||V.documentElement;e&&!lt.nodeName(e,"html")&&"static"===lt.css(e,"position");)e=e.offsetParent;return e||V.documentElement})}}),lt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);lt.fn[e]=function(a){return lt.access(this,function(e,a,s){var o=W(e);return s===t?o?i in o?o[i]:o.document.documentElement[a]:e[a]:(o?o.scrollTo(n?lt(o).scrollLeft():s,n?s:lt(o).scrollTop()):e[a]=s,t)},e,a,arguments.length,null)}}),lt.each({Height:"height",Width:"width"},function(e,i){lt.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,a){lt.fn[a]=function(a,s){var o=arguments.length&&(n||"boolean"!=typeof a),r=n||(a===!0||s===!0?"margin":"border");return lt.access(this,function(i,n,a){var s;return lt.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(s=i.documentElement,Math.max(i.body["scroll"+e],s["scroll"+e],i.body["offset"+e],s["offset"+e],s["client"+e])):a===t?lt.css(i,n,r):lt.style(i,n,a,r)},i,o?a:t,o,null)}})}),e.jQuery=e.$=lt,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return lt})}(window),define("abilities",{Attack:{Characteristic:"DEX"},Block:{Characteristic:"DEX"},Dodge:{Characteristic:"AGI"},"Wear Armor":{Characteristic:"STR"},"Magic Projection":{Characteristic:"DEX"},"Psychic Projection":{Characteristic:"DEX"},Summon:{Characteristic:"POW",Summoning:!0},Control:{Characteristic:"WP",Summoning:!0},Bind:{Characteristic:"POW",Summoning:!0},Banish:{Characteristic:"POW",Summoning:!0},Acrobatics:{Field:"Athletics",Characteristic:"AGI"},Athleticism:{Field:"Athletics",Characteristic:"AGI"},Climb:{Field:"Athletics",Characteristic:"AGI"},Jump:{Field:"Athletics",Characteristic:"STR"},Ride:{Field:"Athletics",Characteristic:"AGI"},Swim:{Field:"Athletics",Characteristic:"AGI"},Alchemy:{Field:"Creative",Characteristic:"INT"},Animism:{Field:"Creative",Characteristic:"POW"},Art:{Field:"Creative",Characteristic:"POW",specializations:["painting","sculpture"]},Dance:{Field:"Creative",Characteristic:"AGI",knowledge:!0,specializations:["ballroom dancing"]},Forging:{Field:"Creative",Characteristic:"DEX",knowledge:!0,specializations:["firearms","Ghestal wood","heavy armor","kitchen utensils","swords"]},Jewelry:{Field:"Creative",Characteristic:"DEX",specializations:["carving wood","shaping glass"]},Music:{Field:"Creative",Characteristic:"POW",knowledge:!0,specializations:["drums","fiddle","singing"]},"Ritual Calligraphy":{Field:"Creative",Characteristic:"DEX"},Runes:{Field:"Creative",Characteristic:"DEX"},"Sleight of Hand":{Field:"Creative",Characteristic:"DEX",specializations:["juggling","prestidigitation","reloading"]},Tailoring:{Field:"Creative",Characteristic:"DEX"},Notice:{Field:"Perceptive",Characteristic:"PER",passive:!0},Search:{Field:"Perceptive",Characteristic:"PER"},Track:{Field:"Perceptive",Characteristic:"PER"},Etiquette:{Field:"Social",Characteristic:"INT"},Intimidate:{Field:"Social",Characteristic:"WP"},Leadership:{Field:"Social",Characteristic:"POW",passive:!0},Persuasion:{Field:"Social",Characteristic:"INT",specializations:["deception","debate","seduction"]},Streetwise:{Field:"Social",Characteristic:"INT"},Style:{Field:"Social",Characteristic:"POW",passive:!0},Trading:{Field:"Social",Characteristic:"INT",specializations:["armor","artifacts","clothing","firearms","gems","jewelry","livestock","paintings","perfume","poison","sculpture","swords","wine"]},Disguise:{Field:"Subterfuge",Characteristic:"DEX"},Hide:{Field:"Subterfuge",Characteristic:"PER"},"Lock Picking":{Field:"Subterfuge",Characteristic:"DEX"},Poisons:{Field:"Subterfuge",Characteristic:"INT",kowledge:!0},Theft:{Field:"Subterfuge",Characteristic:"DEX"},Stealth:{Field:"Subterfuge",Characteristic:"AGI"},"Trap Lore":{Field:"Subterfuge",Characteristic:"DEX"},Animals:{Field:"Intellectual",Characteristic:"INT",knowledge:!0,specializations:["bears","cats","dogs","horses","lions","tigers","wolves"]},Appraisal:{Field:"Intellectual",Characteristic:"INT",knowledge:!0},"Herbal Lore":{Field:"Intellectual",Characteristic:"INT",knowledge:!0},History:{Field:"Intellectual",Characteristic:"INT",knowledge:!0,specializations:["Christian","local"]},Law:{Field:"Intellectual",Characteristic:"INT"},Memorize:{Field:"Intellectual",Characteristic:"INT"},"Magic Appraisal":{Field:"Intellectual",Characteristic:"POW",knowledge:!0,passive:!0},Medicine:{Field:"Intellectual",Characteristic:"INT",knowledge:!0,specializations:["first aid","surgery"]},Navigation:{Field:"Intellectual",Characteristic:"INT",knowledge:!0},Occult:{Field:"Intellectual",Characteristic:"INT",knowledge:!0,specializations:["artifacts","Ki","local myths","magic","psychic abilities","religion","supernatural creatures"]},Science:{Field:"Intellectual",Characteristic:"INT",knowledge:!0},Tactics:{Field:"Intellectual",Characteristic:"INT"},Composure:{Field:"Vigor",Characteristic:"WP",passive:!0},"Feats of Strength":{Field:"Vigor",Characteristic:"STR"},"Withstand Pain":{Field:"Vigor",Characteristic:"WP"}}),define("classes",[],function(){var e,t;
return e=function(){return this instanceof e?(this["Life Point Multiple"]=20,this["Life Points"]=1,this.LP=5,this.Initiative=5,this.MK=20,this["Innate Psychic Points"]=3,this.Combat=50,this.Attack=2,this.Block=2,this.Dodge=2,this["Wear Armor"]=2,this.Ki=2,this["Accumulation Multiple"]=20,this["Martial Knowledge"]=5,this.Supernatural=50,this.Zeon=3,this["MA Multiple"]=70,this["Zeon Regeneration Multiple"]=35,this["Magic Projection"]=3,this.Summon=3,this.Control=3,this.Bind=3,this.Banish=3,this["Magic Level"]=5,this.Psychic=50,this["Psychic Points"]=20,this["Psychic Projection"]=3,this.Athletics=2,this.Social=2,this.Perceptive=2,this.Intellectual=2,this.Vigor=2,this.Subterfuge=2,this.Creative=2,this.reduced={},this.bonuses={},void 0):new e},t={"Acrobatic Warrior":new e,Assassin:new e,"Dark Paladin":new e,Freelancer:new e,Illusionist:new e,Mentalist:new e,Paladin:new e,Ranger:new e,Shadow:new e,Summoner:new e,Tao:new e,Technician:new e,Thief:new e,Warlock:new e,Warrior:new e,"Warrior Mentalist":new e,"Warrior Summoner":new e,Weaponsmaster:new e,Wizard:new e,"Wizard Mentalist":new e},function(e){e.Archetypes=["Fighter"],e.LP=10,e.MK=25,e.Combat=60,e.Block=3,e.Intellectual=3,e.bonuses={Attack:5,Dodge:5,Acrobatics:10,Jump:10,Athleticism:10,"Sleight of Hand":10,Style:10}}(t["Acrobatic Warrior"]),function(e){e.Archetypes=["Prowler"],e.Initiative=10,e.Block=3,e["Wear Armor"]=3,e["Accumulation Multiple"]=25,e.Perceptive=1,e.Intellectual=3,e.Vigor=3,e.reduced.Stealth=1,e.reduced.Composure=2,e.reduced.Memorize=2,e.bonuses={Attack:5,Notice:10,Search:10,Hide:10,Stealth:10,Poisons:10,Composure:10,"Trap Lore":10}}(t.Assassin),function(e){e.Archetypes=["Fighter"],e.LP=15,e["Life Point Multiple"]=15,e.Combat=60,e.Zeon=2,e["MA Multiple"]=60,e["Zeon Regeneration Multiple"]=30,e.Control=1,e.Social=1,e.reduced.Composure=1,e.bonuses={Attack:5,"Wear Armor":5,Control:10,Zeon:20,Intimidate:10,Composure:10,Style:5,Persuasion:5},e.supernatural=function(e){e?(this.bonuses.Control=0,this.bonuses.Zeon=0,this.bonuses["Withstand Pain"]=10):(this.bonuses.Control=10,this.bonuses.Zeon=20,this.bonuses["Withstand Pain"]=0)}}(t["Dark Paladin"]),function(e){e.Archetypes=["Novel"],e["Innate Psychic Points"]=2,e.Combat=60,e.Supernatural=60,e.Zeon=2,e["MA Multiple"]=60,e["Zeon Regeneration Multiple"]=30,e.Summon=2,e.Control=2,e.Bind=2,e.Banish=2,e.Psychic=60,e["Psychic Projection"]=2,e.bonuses.Zeon=10}(t.Freelancer),function(e){e.Archetypes=["Mystic","Prowler"],e.Attack=3,e.Block=3,e["Wear Armor"]=3,e.Ki=2,e["Accumulation Multiple"]=25,e.Supernatural=60,e.Zeon=1,e["MA Multiple"]=60,e["Zeon Regeneration Multiple"]=30,e["Magic Projection"]=2,e.Vigor=3,e.reduced["Sleight of Hand"]=1,e.reduced.Persuasion=1,e.bonuses={Zeon:75,"Magic Appraisal":5,Stealth:10,Hide:10,"Sleight of Hand":10,Disguise:5,Theft:5,Persuasion:5}}(t.Illusionist),function(e){e.Archetypes=["Psychic"],e.MK=10,e["Innate Psychic Points"]=1,e.Attack=3,e.Block=3,e["Wear Armor"]=3,e.Ki=3,e["Accumulation Multiple"]=30,e.Psychic=60,e["Psychic Points"]=10,e["Psychic Projection"]=2,e.Vigor=3}(t.Mentalist),function(e){e.Archetypes=["Fighter"],e.LP=15,e["Life Point Multiple"]=15,e.Combat=60,e.Zeon=2,e["MA Multiple"]=60,e["Zeon Regeneration Multiple"]=30,e.Banish=1,e.Social=1,e.Subterfuge=3,e.reduced["Withstand Pain"]=1,e.bonuses={Block:5,"Wear Armor":10,Banish:10,Zeon:20,Leadership:10,"Withstand Pain":10,Style:5},e.supernatural=function(e){e?(this.bonuses.Banish=0,this.bonuses.Zeon=0,this.bonuses.Composure=10):(this.bonuses.Banish=10,this.bonuses.Zeon=20,this.bonuses.Composure=0)}}(t.Paladin),function(e){e.Archetypes=["Fighter","Prowler"],e.LP=10,e.Combat=60,e["Accumulation Multiple"]=25,e.Perceptive=1,e.Intellectual=3,e.Vigor=3,e.reduced["Trap Lore"]=1,e.reduced["Herbal Lore"]=2,e.reduced.Animals=1,e.reduced.Medicine=2,e.bonuses={Attack:5,Notice:10,Search:10,Track:10,"Trap Lore":5,Animals:5,"Herbal Lore":5},e.detect_ki=function(e){e&&(this.bonuses={"Detect Ki":10})}}(t.Ranger),function(e){e.Archetypes=["Fighter","Prowler"],e.Initiative=10,e.MK=25,e.Combat=60,e.Block=3,e.Intellectual=3,e.bonuses={Attack:5,Dodge:5,"Ki Concealment":5,Notice:10,Search:10,Hide:10,Stealth:5}}(t.Shadow),function(e){e.Archetypes=["Mystic"],e.MK=10,e.Attack=3,e.Block=3,e["Wear Armor"]=3,e.Ki=3,e["Accumulation Multiple"]=30,e.Supernatural=60,e.Zeon=1,e["MA Multiple"]=60,e["Zeon Regeneration Multiple"]=30,e.Summon=1,e.Control=1,e.Bind=1,e.Banish=1,e.Vigor=3,e.reduced.Occult=1,e.bonuses={Zeon:50,Summon:10,Control:10,Bind:10,Banish:10,"Magic Appraisal":5,Occult:10}}(t.Summoner),function(e){e.Archetypes=["Domine","Fighter"],e["Life Point Multiple"]=20,e.LP=10,e.MK=30,e.Combat=60,e["Accumulation Multiple"]=15,e.Intellectual=3,e.bonuses.Style=5}(t.Tao),function(e){e.Archetypes=["Domine"],e.MK=50,e.Combat=60,e.Ki=1,e["Accumulation Multiple"]=10,e.Intellectual=3,e.bonuses.Attack=5}(t.Technician),function(e){e.Archetypes=["Prowler"],e.Initiative=10,e.Block=3,e["Wear Armor"]=3,e["Accumulation Multiple"]=25,e.Athletics=1,e.Intellectual=3,e.Vigor=3,e.Subterfuge=1,e.reduced.Appraisal=1,e.bonuses={Dodge:5,"Ki Concealment":5,Notice:5,Search:5,Hide:5,Stealth:5,"Trap Lore":5,"Sleight of Hand":5,Theft:10}}(t.Thief),function(e){e.Archetypes=["Fighter","Mystic"],e.LP=10,e["Accumulation Multiple"]=25,e.Zeon=1,e["MA Multiple"]=50,e["Zeon Regeneration Multiple"]=25,e["Magic Projection"]=2,e.Summon=2,e.Control=2,e.Bind=2,e.Banish=2,e.bonuses={Attack:5,Block:5,Dodge:5,Zeon:20,"Magic Appraisal":5}}(t.Warlock),function(e){e.Archetypes=["Fighter"],e["Life Point Multiple"]=15,e.LP=15,e.MK=25,e.Combat=60,e.Intellectual=3,e.reduced["Feats of Strength"]=1,e.bonuses={Attack:5,Block:5,"Wear Armor":5,"Feats of Strength":5}}(t.Warrior),function(e){e.Archetypes=["Fighter","Psychic"],e.LP=10,e["Innate Psychic Points"]=1,e["Accumulation Multiple"]=25,e["Psychic Points"]=15,e["Psychic Projection"]=2,e.Intellectual=3,e.bonuses={Attack:5,Block:5,Dodge:5}}(t["Warrior Mentalist"]),function(e){e.Archetypes=["Fighter","Mystic"],e.LP=10,e.Zeon=1,e["MA Multiple"]=60,e["Zeon Regeneration Multiple"]=30,e.Summon=1,e.Control=1,e.Bind=1,e.Banish=1,e.Vigor=3,e.bonuses={Zeon:20,Attack:5,Block:5,Dodge:5,Summon:5,Control:5,Bind:5,Banish:5,Occult:5}}(t["Warrior Summoner"]),function(e){e.Archetypes=["Fighter"],e["Life Point Multiple"]=10,e.LP=20,e.Initiative=5,e.MK=10,e.Combat=60,e["Wear Armor"]=1,e.Ki=3,e["Accumulation Multiple"]=30,e.Intellectual=3,e.Vigor=1,e.Subterfuge=3,e.reduced["Feats of Strength"]=1,e.bonuses={Attack:5,Block:5,"Wear Armor":10,"Feats of Strength":5}}(t.Weaponsmaster),function(e){e.Archetypes=["Mystic"],e.MK=10,e.Attack=3,e.Block=3,e["Wear Armor"]=3,e.Ki=3,e["Accumulation Multiple"]=30,e.Supernatural=60,e.Zeon=1,e["MA Multiple"]=50,e["Zeon Regeneration Multiple"]=25,e["Magic Projection"]=2,e.Summon=2,e.Control=2,e.Bind=2,e.Banish=2,e.Vigor=3,e.reduced["Magic Appraisal"]=1,e.bonuses={Zeon:100,"Magic Appraisal":10,Occult:5}}(t.Wizard),function(e){e.Archetypes=["Mystic","Psychic"],e.MK=10,e["Innate Psychic Points"]=1,e.Attack=3,e.Block=3,e["Wear Armor"]=3,e.Ki=3,e["Accumulation Multiple"]=30,e.Supernatural=50,e.Zeon=1,e["MA Multiple"]=50,e["Zeon Regeneration Multiple"]=25,e["Magic Projection"]=2,e.Summon=2,e.Control=2,e.Bind=2,e.Banish=2,e["Psychic Points"]=10,e["Psychic Projection"]=2,e.Vigor=3,e.reduced["Magic Appraisal"]=1,e.bonuses={Zeon:100,"Magic Appraisal":10,Occult:5}}(t["Wizard Mentalist"]),t}),define("cultural_roots",{"Abel (Middle Class / Lower Class)":{Athleticism:15,Ride:10,Swim:10,Notice:15,"Slight of Hand":10,Persuasion:10,History:{local:10}},"Abel (Bourgeois)":{Ride:10,Swim:10,Persuasion:15,Style:10,History:{local:10},Appraisal:15,Dance:10},"Abel (Nobility / High Nobility)":{Ride:10,Style:10,Leadership:20,Persuasion:10,History:{local:10},Dance:10,choices:[{Art:10,Music:10}]},"Alberia (Middle Class / Lower Class)":{Athleticism:10,Climb:10,Notice:10,Track:10,Animals:10,"Herbal Lore":10,Stealth:10,"Trap Lore":10},"Alberia (Nobility)":{Athleticism:10,Climb:10,Notice:10,Music:15,Leadership:15,Persuasion:10,History:{local:10}},"Argos (Middle Class / Low Class)":{Athleticism:10,Ride:10,Climb:10,Notice:10,Track:5,History:{local:10},"Resist Pain":10,Occult:{religion:15}},"Argos (Nobility)":{Athleticism:10,Ride:10,Leadership:20,Notice:10,Composure:5,History:{local:15},Occult:{religion:10}},"Arlan (Middle Class / Lower Class)":{Ride:5,Swim:10,Persuasion:20,History:{local:10},Appraisal:20,Navigation:15},"Arlan (Bourgeois / High Bourgeoisie)":{Ride:10,Swim:10,Persuasion:20,Style:5,History:{local:10},Appraisal:20,Navigation:5},"Baho (The Scholar Caste)":{Swim:10,Persuasion:10,Notice:10,Animals:5,Science:15,History:5,Memorize:10,Art:15},"Baho (The Warrior Caste)":{Athleticism:10,Swim:10,Climb:10,Intimidate:15,Notice:5,Composure:10,"Feats of Strength":10,"Resist Pain":10},"Bellafonte (Middle Class / Lower Class)":{Athleticism:10,Ride:15,Swim:5,Notice:10,Composure:10,"Feats of Strength":10,History:{local:10},Occult:{religion:10}},"Bellafonte (Nobility / High Nobility)":{Athleticism:10,Ride:15,Leadership:20,Notice:5,Composure:10,History:{local:10},Occult:{religion:10}},"Dalaborn (Middle Class / Lower Class)":{Athleticism:10,Ride:10,Intimidate:10,Notice:10,Composure:10,"Feats of Strength":10,History:{local:10},Forging:10},"Dalaborn (Nobility / High Nobility)":{Athleticism:10,Ride:10,Intimidate:10,Leadership:20,Notice:10,Composure:10,History:{local:10}},"Dwänholf (Middle Class / Poor Class)":{Swim:10,Intimidate:15,Persuasion:5,Notice:15,Navigation:10,Hide:10,Theft:10,Stealth:5},"Dwänholf (Wealthy Class)":{Swim:10,Initimidate:10,Persuasion:20,Notice:10,Leadership:10,Theft:5,Appraisal:15},"Estigia (Middle Class / Lower Class)":{Athleticism:10,Notice:15,Tracking:10,History:{local:10},Occult:{religion:10},Appraisal:5,Art:5,Forging:15},"Estigia (Bourgeois Bureaucrat / Nobility)":{Ride:10,Style:15,Intimidate:5,Persuasion:10,Notice:5,History:{local:15},Occult:{religion:15},Art:5},"Gabriel (Middle Class / Indigent)":{Atheticism:10,Acrobatics:10,Ride:10,Swim:10,Persuasion:10,Notice:10,History:{local:10},"Feats of Strength":10},"Gabriel (Bourgeois)":{Ride:10,Style:10,Persuasion:20,Appraisal:10,History:10,Dance:15,choices:[{Art:5,Music:5}]},"Gabriel (Nobility / High Nobility)":{Ride:10,Style:20,Leadership:10,Persuasion:10,History:10,Dance:10,choices:[{Art:5,Music:5}]},"Galgados (Middle Class / Lower Class)":{Acrobatics:5,Athleticism:15,Climb:10,Notice:10,Track:10,Animals:10,"Herbal Lore":10,Stealth:10},"Goldar (Exiled / Peasant)":{Athleticism:15,Ride:10,Swim:10,Hide:10,Notice:10,Track:15,Animals:5,"Herbal Lore":5},"Goldar (Northerner)":{Athleticism:10,Ride:10,Swim:10,Intimidate:10,Notice:10,Track:10,Animals:5,"Feats of Strength":15},"Goldar (Erling, Sklamo or Honorable Escaldo)":{Athleticism:10,Ride:10,Swim:10,choices:[{Intimidate:10,Music:10},{Track:10,History:{local:10}}],Notice:10,Animals:10,Leadership:10},"Haufman (Northern / Northern Peasant)":{Athleticism:10,Climb:10,Intimidate:10,Notice:10,Track:10,Composure:10,"Feats of Strength":10,"Resist Pain":10},"Haufman (Saerinmir)":{Athleticism:10,Climb:10,Intimidate:10,Notice:10,Swim:10,Composure:10,Navigation:10,"Resist Pain":10},"Haufman (Nobleman)":{Athleticism:10,Intimidate:10,Notice:10,Leadership:20,Composure:10,History:{local:10},"Resist Pain":10},"Helenia (Middle Class / Lower Class)":{Athleticism:10,Ride:20,Climb:10,Swim:10,Notice:10,Animals:10,"Herbal Lore":10},"Helenia (Nomad)":{Athleticism:10,Ride:20,Climb:10,Animals:10,"Herbal Lore":20,Track:10},"Helenia (Nobility)":{Athleticism:10,Ride:20,Climb:10,Swim:10,Notice:10,Animals:10,Leadership:10},"Hendell (Peasant)":{Athleticism:10,Ride:10,History:{local:10},Notice:10,Track:10,Animals:15,"Herbal Lore":15},"Hendell (Northerner)":{Athleticism:10,Ride:10,History:{local:10},Intimidate:10,Notice:10,Track:10,Animals:10,"Feats of Strength":10},"Hendell (Lochgjest)":{Athleticism:10,Swim:10,Notice:10,Track:10,"Resist Pain":10,Hide:10,Stealth:10,Memorize:10},"Hendell (The First Caste)":{Athleticism:10,Ride:10,History:{local:10},Intimidate:10,Notice:10,Leadership:10,Persuasion:10,Appraisal:10},"Ilmora (Middle Class / Lower Class)":{Leadership:10,Persuasion:10,Science:10,"Herbal Lore":10,History:10,Medicine:10,Memorize:10,Art:10},"Ilmora (Nobility / High Nobility)":{Leadership:10,Persuasion:10,Science:10,History:10,Dance:10,Style:10,Memorize:10,Art:10},"Kanon (Middle Class / Lower Class)":{Athleticism:10,Ride:10,Swim:15,Notice:10,Animals:10,"Herbal Lore":10,Navigation:15},"Kanon (Nobility)":{Athleticism:10,Ride:10,Leadership:10,Notice:10,Persuasion:10,History:{local:10},Navigation:20},"Kashmir (All the inhabitants of The Savannah)":{Athleticism:20,Swim:5,Notice:10,Track:15,Animals:10,"Herbal Lore":5,Hide:5,Stealth:10},"Kushistan (Middle Class / Low Class)":{Athleticism:10,Ride:10,Climb:10,Notice:10,Track:15,Animals:10,Occult:{religion:5},Stealth:10},"Kushistan (Bourgeois / Nobility)":{Ride:10,Leadership:10,Persuasion:15,Style:10,History:{local:10},Occult:{religion:10},Appraisal:15},"Lannet (Lower Class)":{Athleticism:15,Swim:10,Climb:10,Notice:10,Animals:5,Herbalism:10,Occult:{religion:10},"Feats of Strength":10},"Lannet (Bourgeois / Samurai (courtesan))":{Athleticism:10,Swim:10,Style:20,Persuasion:10,History:{local:10},Art:10,Music:10},"Lannet (Samurai (warrior))":{Athleticism:10,Ride:10,Swim:10,Style:10,Intimidate:10,Notice:10,History:{local:10},Composure:10},"Lucrecio (Middle Class / Low Class)":{Athleticism:10,Ride:10,Notice:10,Science:10,History:10,Memorize:10,"Herbal Lore":10,Animals:10},"Lucrecio (High Class / High Bourgeoisie)":{Athleticism:10,Ride:10,Persuasion:10,Notice:10,Science:10,History:10,Memorize:10,choices:[{Art:10,Music:10}]},"Moth (Middle Class / Lower Class)":{Ride:10,Climb:10,Notice:15,Track:10,"Herbal Lore":15,Occult:{"local myths":10},Composure:10},"Moth (Zigeuner)":{Ride:10,Climb:10,Notice:10,Track:10,"Herbal Lore":5,Animals:5,Persuasion:10,Appraisal:10,Occult:{"local myths":20}},"Moth (Nobility)":{Ride:10,Notice:10,"Herbal Lore":10,Occult:{"local myths":15},Composure:10,Leadership:15,Intimidate:10},"Nanwe (All members of local tribes)":{Athleticism:10,Climb:10,Notice:10,Track:10,Animals:10,"Herbal Lore":10,Hide:10,Stealth:10},"Nanwe (Citizen Middle Class / Bourgeois)":{Swim:10,Climb:5,Persuasion:10,Notice:15,Track:15,Animals:15,Hide:5,Stealth:5},"Phaion Eien Seimon (Middle Class / Lower Class)":{Athleticism:10,Ride:10,Swim:10,Persuasion:15,Notice:10,History:{local:10},Navigation:10,"Feats of Strength":5},"Phaion Eien Seimon (Bourgeois / Nobility)":{Ride:10,Style:10,Leadership:10,Persuasion:15,History:{local:10},Appraisal:10,Dance:10,choices:[{Art:5,Music:5}]},"Remo (Middle Class / Lower Class)":{Athleticism:10,Swim:10,Jump:10,Intimidate:10,Notice:10,Hide:10,Theft:10,Stealth:10},"Remo (Bourgeois / Nobility)":{Ride:10,Swim:10,Persuasion:10,Notice:10,Composure:10,Intimidate:10,History:{local:10},Appraisal:10},"Salazar (All Nomads)":{Athleticism:15,Ride:10,Notice:10,Search:10,Track:15,Animals:5,Hide:5,Stealth:10},"Shivat (Middle Class / Lower Class)":{Acrobatics:10,Athleticism:10,Swim:10,Climb:10,Style:10,Notice:10,Animals:10,"Herbal Lore":10},"Shivat (Nobility / Bourgeoisie / Bureaucrat)":{Ride:10,Style:15,Persuasion:20,Notice:10,History:10,Occult:5,Dance:5,choice:[{Art:5},{Music:5}]},"The Dominion (Middle Class / Lower Class)":{Swim:10,Persuasion:10,Notice:10,History:{Christian:25},Occult:{religion:25}},"The Dominion (Nobility / Priest / High Nobility / Cardinal)":{Leadership:10,Persuasion:20,Notice:10,History:{Christian:20},Occult:{religion:30}},"Togarini (Middle Class / Lower Class)":{Athleticism:10,Ride:10,Climb:10,Notice:10,"Sleight of Hand":10,Composure:10,Persuasion:10,History:{local:10}},"Togarini (Bourgeois)":{Ride:10,Persuasion:10,Style:10,Composure:10,History:{local:10},Appraisal:20,Dance:10},"Togarini (Nobility / High Nobility)":{Ride:10,Style:10,Composure:10,Leadership:10,Intimidate:10,Persuasion:10,History:{local:10},Dance:10}}),define("psychic_disciplines",{disciplines:{Cryokinesis:{"Create Chill":{Level:1,Minimum:"Easy",Maintenance:!0},Freeze:{Level:1,Minimum:"Difficult",Maintenance:!0},"Sense Temperature":{Level:1,Minimum:"Difficult",Maintenance:!0},"Eliminate Cold":{Level:1,Minimum:"Easy",Maintenance:!1},"Cold Dominion":{Level:1,Minimum:"Medium",Maintenance:!0},Crystallize:{Level:2,Minimum:"Absurd",Maintenance:!0},"Ice Splinters":{Level:2,Minimum:"Absurd",Maintenance:!1},"Decrease Ambient Temperature":{Level:2,Minimum:"Very Difficult",Maintenance:!0},"Ice Shield":{Level:2,Minimum:"Difficult",Maintenance:!0},"Absolute Zero":{Level:3,Minimum:"Absurd",Maintenance:!0},"Everlasting Moment":{Level:3,Minimum:"Absurd",Maintenance:!0},"Major Cold":{Level:3,Minimum:"Almost Impossible",Maintenance:!0}},Energy:{"Energy Object Creation":{Level:1,Minimum:"Difficult",Maintenance:!0},"Energy Discharge":{Level:1,Minimum:"Difficult",Maintenance:!1},"Create Energy":{Level:1,Minimum:"Medium",Maintenance:!0},"Energy Shield":{Level:1,Minimum:"Difficult",Maintenance:!0},"Sense Energy":{Level:1,Minimum:"Medium",Maintenance:!0},"Modify Nature":{Level:2,Minimum:"Very Difficult",Maintenance:!1},"Undo Energy":{Level:2,Minimum:"Difficult",Maintenance:!1},Immunity:{Level:2,Minimum:"Absurd",Maintenance:!0},"Control Energy":{Level:2,Minimum:"Difficult",Maintenance:!0},"Energy Dome":{Level:3,Minimum:"Absurd",Maintenance:!1},"Major Energy":{Level:3,Minimum:"Almost Impossible",Maintenance:!0}},"Physical Increase":{"Increase Jump Ability":{Level:1,Minimum:"Easy",Maintenance:!0},"Increase Ability":{Level:1,Minimum:"Medium",Maintenance:!0},"Increase Acrobatics":{Level:1,Minimum:"Easy",Maintenance:!0},"Increase Strength":{Level:1,Minimum:"Medium",Maintenance:!0},Inhumanity:{Level:1,Minimum:"Medium",Maintenance:!0},"Increase Motion":{Level:1,Minimum:"Difficult",Maintenance:!0},"Increase Reaction":{Level:2,Minimum:"Difficult",Maintenance:!0},"Perception Increase":{Level:2,Minimum:"Difficult",Maintenance:!0},"Increase Endurance":{Level:2,Minimum:"Difficult",Maintenance:!0},Regeneration:{Level:2,Minimum:"Difficult",Maintenance:!0},"Fatigue Elimination":{Level:3,Minimum:"Absurd",Maintenance:!1},"Total Increase":{Level:3,Minimum:"Absurd",Maintenance:!0},Imbue:{Level:3,Minimum:"Absurd",Maintenance:!0}},Psychokinesis:{"Minor Psychokinesis":{Level:1,Minimum:"Easy",Maintenance:!0},"Psychokinetic Impact":{Level:1,Minimum:"Medium",Maintenance:!1},"Psychokinetic Trap":{Level:1,Minimum:"Medium",Maintenance:!0},"Psychokinetic Shield":{Level:1,Minimum:"Medium",Maintenance:!0},"Psychokinetic Armor":{Level:1,Minimum:"Medium",Maintenance:!0},"Motion Detection":{Level:2,Minimum:"Difficult",Maintenance:!0},Repulsion:{Level:2,Minimum:"Very Difficult",Maintenance:!0},Ballistics:{Level:2,Minimum:"Difficult",Maintenance:!1},Shatter:{Level:2,Minimum:"Very Difficult",Maintenance:!1},"Psychokinetic Flight":{Level:2,Minimum:"Difficult",Maintenance:!0},"Organic Psychokinesis":{Level:2,Minimum:"Difficult",Maintenance:!0},"Ground Control":{Level:3,Minimum:"Absurd",Maintenance:!0},"Atomic Restructuring":{Level:3,Minimum:"Impossible",Maintenance:!1},"Major Psychokinesis":{Level:3,Minimum:"Almost Impossible",Maintenance:!0}},Pyrokinesis:{"Create Fire":{Level:1,Minimum:"Easy",Maintenance:!0},"Extinguish Fire":{Level:1,Minimum:"Easy",Maintenance:!1},"Control Fire":{Level:1,Minimum:"Medium",Maintenance:!0},Immolate:{Level:1,Minimum:"Difficult",Maintenance:!1},"Igneous Maintenance":{Level:2,Minimum:"Difficult",Maintenance:!0},"Fire Immunity":{Level:2,Minimum:"Difficult",Maintenance:!0},"Igneous Barrier":{Level:2,Minimum:"Very Difficult",Maintenance:!0},"Raise Temperature":{Level:2,Minimum:"Very Difficult",Maintenance:!0},Consume:{Level:3,Minimum:"Absurd",Maintenance:!1},Nova:{Level:3,Minimum:"Difficult",Maintenance:!0},"Major Fire":{Level:3,Minimum:"Almost Impossible",Maintenance:!1}},Sentience:{"Sense Feelings":{Level:1,Minimum:"Medium",Maintenance:!0},"Intensify Feelings":{Level:1,Minimum:"Medium",Maintenance:!0},"Detect Feelings":{Level:1,Minimum:"Medium",Maintenance:!0},"Connect Senses":{Level:1,Minimum:"Medium",Maintenance:!0},"Project Senses":{Level:2,Minimum:"Very Difficult",Maintenance:!0},"Eliminate Senses":{Level:2,Minimum:"Very Difficult",Maintenance:!0},"Create Feelings":{Level:2,Minimum:"Difficult",Maintenance:!0},"Infuse Feelings":{Level:2,Minimum:"Very Difficult",Maintenance:!0},"Destroy Feelings":{Level:3,Minimum:"Absurd",Maintenance:!1},Area:{Level:3,Minimum:"Very Difficult",Maintenance:!0}},Telemetry:{"Sense Residues":{Level:1,Minimum:"Easy",Maintenance:!0},"Read Past":{Level:2,Minimum:"Very Difficult",Maintenance:!1},"Human Erudition":{Level:3,Minimum:"Difficult",Maintenance:!1},"See In History":{Level:3,Minimum:"Absurd",Maintenance:!0}},Telepathy:{"Area Scanning":{Level:1,Minimum:"Medium",Maintenance:!0},"Mental Restraint":{Level:1,Minimum:"Medium",Maintenance:!0},"Mind Reading":{Level:1,Minimum:"Medium",Maintenance:!0},"Mental Communication":{Level:1,Minimum:"Medium",Maintenance:!0},"Psychic Shield":{Level:1,Minimum:"Medium",Maintenance:!0},"Psychic Illusion":{Level:1,Minimum:"Medium",Maintenance:!0},"Mental Research":{Level:2,Minimum:"Difficult",Maintenance:!0},"Psychic Assault":{Level:2,Minimum:"Difficult",Maintenance:!1},"Psychic Connection":{Level:2,Minimum:"Difficult",Maintenance:!0},"Alter Memory":{Level:2,Minimum:"Very Difficult",Maintenance:!1},"Astral Shape":{Level:2,Minimum:"Very Difficult",Maintenance:!0},"Psychic Tracking":{Level:2,Minimum:"Very Difficult",Maintenance:!0},"Mind Control":{Level:3,Minimum:"Very Difficult",Maintenance:!0},"Psychic Death":{Level:3,Minimum:"Absurd",Maintenance:!1},Area:{Level:3,Minimum:"Very Difficult",Maintenance:!0}},Causality:{"Create Chaos":{Level:1,Minimum:"Absurd",Maintenance:!0},"Delete Law of Causality":{Level:2,Minimum:"Absurd",Maintenance:!0},"Alter Climate":{Level:2,Minimum:"Very Difficult",Maintenance:!1},"Create Order":{Level:3,Minimum:"Impossible",Maintenance:!0},"Control Causality":{Level:3,Minimum:"Almost Impossible",Maintenance:!1}},Electromagnetism:{"Perceive Electricity":{Level:1,Minimum:"Difficult",Maintenance:!1},"Create Electricity":{Level:1,Minimum:"Medium",Maintenance:!0},"Electricity Control":{Level:1,Minimum:"Medium",Maintenance:!0},"Magnetic Manipulation":{Level:1,Minimum:"Difficult",Maintenance:!0},"Magnetic Shield":{Level:2,Minimum:"Difficult",Maintenance:!0},"Read Electrical Impulses":{Level:2,Minimum:"Difficult",Maintenance:!0},"Electricity Arc":{Level:2,Minimum:"Difficult",Maintenance:!1},"Magnetic Acceleration Attack":{Level:3,Minimum:"Almost Impossible",Maintenance:!1},"Control Electrical Impulses":{Level:3,Minimum:"Almost Impossible",Maintenance:!0}},Teleportation:{"Relocate Object":{Level:1,Minimum:"Medium",Maintenance:!1},"Teleport Self":{Level:1,Minimum:"Difficult",Maintenance:!1},"Defensive Transportation":{Level:1,Minimum:"Difficult",Maintenance:!0},"Major Teleport Self":{Level:2,Minimum:"Absurd",Maintenance:!1},Aleph:{Level:3,Minimum:"Absurd",Maintenance:!0},"Major Relocate Object":{Level:3,Minimum:"Almost Impossible",Maintenance:!1},Teleport:{Level:3,Minimum:"Absurd",Maintenance:!1}},Light:{"Manipulate Light":{Level:1,Minimum:"Difficult",Maintenance:!0},"Create Light":{Level:1,Minimum:"Medium",Maintenance:!0},"Flash of Light":{Level:1,Minimum:"Medium",Maintenance:!1},"Screen of Light":{Level:2,Minimum:"Very Difficult",Maintenance:!0},Hologram:{Level:2,Minimum:"Absurd",Maintenance:!0},Laser:{Level:3,Minimum:"Absurd",Maintenance:!1}},Hypersensitivity:{"Filter Senses":{Level:1,Minimum:"Easy",Maintenance:!0},"Move Sense":{Level:2,Minimum:"Medium",Maintenance:!0},"Superior Sense":{Level:3,Minimum:"Absurd",Maintenance:!0}}},matrix_powers:{"Sense Matrices":{Level:1,Minimum:"Easy",Maintenance:!0},"Destroy Matrices":{Level:1,Minimum:"Difficult",Maintenance:!0},"Hide Matrices":{Level:1,Minimum:"Medium",Maintenance:!0},"Link Matrices":{Level:1,Minimum:"Difficult",Maintenance:!0}}}),define("magic_paths",{Air:{},Creation:{},Darkness:{},Destruction:{},Earth:{},Essence:{},Fire:{},Illusion:{},Light:{},Necromany:{},Water:{}}),define("tables",{characteristics:["STR","DEX","AGI","CON","INT","POW","WP","PER"],primary_combat_abilities:["Attack","Block","Dodge"],elements:["Air","Darkness","Earth","Fire","Light","Water"],fields:["Athletics","Creative","Intellectual","Perceptive","Social","Subterfuge","Vigor"],modifiers:[0,-30,-20,-10,-5,0,5,5,10,10,15,20,20,25,25,30,35,35,40,40,45],base_lp:[0,5,20,40,55,70,85,95,110,120,135,150,160,175,185,200,215,225,240,250,265],base_zeon:[0,5,20,40,55,70,85,95,110,120,135,150,160,175,185,200,215,225,240,250,265],base_ma:[0,0,0,0,0,5,5,5,10,10,10,10,15,15,15,20,25,25,30,30,35],magic_level:[0,0,0,0,0,0,10,20,30,40,50,75,100,150,200,300,400,500,600,700,800],klutzy:["Attack","Block","Disguise","Forging","Lock Picking","Sleight of Hand","Theft","Trap Lore"],opposite_elements:{Air:"Earth",Darkness:"Light",Earth:"Air",Fire:"Water",Light:"Darkness",Water:"Fire"},regeneration:[0,0,0,1,1,1,1,1,2,2,3,4,5,6,7,8,9,10,11,12,12],resistances:{DR:"CON",MR:"POW",PhR:"CON",VR:"CON",PsR:"WP"},theorems:["Standard","Natural Magic","Onmyodo","Shamanism","Vodoun"],xp_chart:[0,100,225,375,550,750,975,1225,1500,1800,2125,2475,2850,3250,3675,4125]}),define("essential_abilities",["magic_paths","psychic_disciplines","tables"],function(e,t,i){return{advantages:{"Access to a Psychic Discipline":{DP:15,Gnosis:5,Options:Object.keys(t.disciplines),Option_Title:"Select a discipline",Incompatible:["Access to Psychic Disciplines"]},"Access to Psychic Disciplines":{DP:30,Gnosis:5,Incompatible:["Access to a Psychic Discipline"]},"Acute Sense":{DP:10,Gnosis:0,Options:["Hearing","Sight","Smell","Taste","Touch"],Option_Title:"Select the enhanced sense"},Ambidextrous:{DP:30,Gnosis:0},"Amplify Sustained Power":{Category:"Psychic",DP:30,Gnosis:5},"Aquatic Breathing":{DP:10,Gnosis:0},"Attribute Increased +1":{DP:20,Gnosis:0,Options:i.characteristics,Option_Title:"Select the characteristic to increase"},"Attribute Increased +2":{DP:40,Gnosis:5,Options:i.characteristics,Option_Title:"Select the characteristic to increase"},"Attribute Increased +3":{DP:60,Gnosis:15,Options:i.characteristics,Option_Title:"Select the characteristic to increase"},Attuned:{DP:10,Gnosis:5,Options:[],Option_Title:"Select the attuned element or type of creature"},"Contested Spell Mastery":{Category:"Magic",DP:10,Gnosis:10},"Danger Sense":{DP:40,Gnosis:20},"Divine Physical Characteristics":{DP:80,Gnosis:30,Incompatible:["Superhuman Physical Characteristics","Supernatural Physical Characteristics"]},"Divine Spiritual Characteristics":{DP:80,Gnosis:35,Incompatible:["Superhuman Spiritual Characteristics","Supernatural Spiritual Characteristics"]},"Does Not Breathe":{DP:10,Gnosis:15,Incompatible:["Physical Exemption"]},"Does Not Eat":{DP:10,Gnosis:15,Incompatible:["Physical Exemption"]},"Does Not Sleep":{DP:10,Gnosis:15,Incompatible:["Physical Exemption"]},"Extreme Concentration":{Category:"Psychic",DP:30,Gnosis:5,Incompatible:["No Concentration"]},Focus:{Category:"Psychic",DP:20,Gnosis:5},"Fatigue Resistance":{DP:10,Gnosis:0,Multiple:!0,Incompatible:["Physical Exemption","Tireless"]},"Gestureless Casting":{Category:"Magic",DP:20,Gnosis:5,Incompatible:["Require Gestures"]},Gift:{DP:30,Gnosis:5},"Improved Innate Magic":{Category:"Magic",DP:20,Gnosis:5},"Immune to Climatic Phenomena":{DP:10,Gnosis:15,Incompatible:["Physical Exemption"]},"Immune to Natural Diseases":{DP:10,Gnosis:20,Incompatible:["Physical Exemption"]},"Immune to Natural Poisons":{DP:20,Gnosis:20,Incompatible:["Physical Exemption"]},"Immune to Pain":{DP:20,Gnosis:0},"Increased Psychic Modifiers":{Category:"Psychic",DP:10,Gnosis:20},Inhumanity:{DP:10,Gnosis:0,Incompatible:["Zen"]},"Ki Recovery":{DP:20,Gnosis:20},"Natural Immunity to an Element (Half Damage)":{DP:10,Gnosis:20,Options:i.elements,Option_Title:"Select an element",Alternatives:["Natural Immunity to an Element (Complete Immunity)"]},"Natural Immunity to an Element (Complete Immunity)":{DP:10,Gnosis:20,Options:i.elements,Option_Title:"Select an element",Alternatives:["Natural Immunity to an Element (Half Damage)"]},"Natural Knowledge of a Path 20":{Category:"Magic",DP:10,Gnosis:10,Options:Object.keys(e),Option_Title:"Select a path",Alternatives:["Natural Knowledge of a Path 40","Natural Knowledge of a Path 60","Natural Knowledge of a Path 80","Natural Knowledge of a Path 90"]},"Natural Knowledge of a Path 40":{Category:"Magic",DP:20,Gnosis:15,Options:Object.keys(e),Option_Title:"Select a path",Alternatives:["Natural Knowledge of a Path 20","Natural Knowledge of a Path 60","Natural Knowledge of a Path 80","Natural Knowledge of a Path 90"]},"Natural Knowledge of a Path 60":{Category:"Magic",DP:30,Gnosis:20,Options:Object.keys(e),Option_Title:"Select a path",Alternatives:["Natural Knowledge of a Path 20","Natural Knowledge of a Path 40","Natural Knowledge of a Path 80","Natural Knowledge of a Path 90"]},"Natural Knowledge of a Path 80":{Category:"Magic",DP:40,Gnosis:25,Options:Object.keys(e),Option_Title:"Select a path",Alternatives:["Natural Knowledge of a Path 20","Natural Knowledge of a Path 40","Natural Knowledge of a Path 60","Natural Knowledge of a Path 90"]},"Natural Knowledge of a Path 90":{Category:"Magic",DP:50,Gnosis:30,Options:Object.keys(e),Option_Title:"Select a path",Alternatives:["Natural Knowledge of a Path 20","Natural Knowledge of a Path 40","Natural Knowledge of a Path 60","Natural Knowledge of a Path 80"]},"Natural Power":{Category:"Magic",DP:10,Gnosis:20},"Opposite Magic":{Category:"Magic",DP:10,Gnosis:20},"Passive Concentration":{Category:"Psychic",DP:30,Gnosis:5,Incompatible:["No Concentration"]},"Physical Exemption":{DP:50,Gnosis:20,Incompatible:["Does Not Breathe","Does Not Eat","Does Not Sleep","Immune to Climatic Phenomena","Immune to Natural Diseases","Immune to Natural Poisons","Tirless","Without Unconsciousness"]},"Psychic Ambivalence":{Category:"Psychic",DP:30,Gnosis:15},"Psychic Fatigue Resistance":{Category:"Psychic",DP:30,Gnosis:5},"Psychic Inclination":{Category:"Psychic",DP:20,Gnosis:5,Options:Object.keys(t.disciplines),Option_Title:"Select a discipline"},"Psychic Point Recovery":{Category:"Psychic",DP:20,Gnosis:5},"Psychological Immunity":{DP:20,Gnosis:10},"Superhuman Physical Characteristics":{DP:20,Gnosis:0,Incompatible:["Divine Physical Characteristics","Supernatural Physical Characteristics"]},"Superhuman Spiritual Characteristics":{DP:20,Gnosis:5,Incompatible:["Divine Spiritual Characteristics","Supernatural Spiritual Characteristics"]},"Supernatural Physical Characteristics":{DP:40,Gnosis:20,Incompatible:["Divine Physical Characteristics","Superhuman Physical Characteristics"]},"Supernatural Spiritual Characteristics":{DP:40,Gnosis:20,Incompatible:["Divine Spiritual Characteristics","Superhuman Spiritual Characteristics"]},"Superior Magic Recovery":{Category:"Magic",DP:30,Gnosis:5,Incompatible:["Magic Blockage","Slow Recovery of Magic"]},Survivor:{DP:10,Gnosis:0},Tireless:{DP:20,Gnosis:15,Incompatible:["Fatigue Resistance","Physical Exemption"]},"Unnatural Size":{DP:10,Gnosis:0,Options:[-5,-4,-3,-2,-1,1,2,3,4,5],Option_Title:"Select the size modifier to apply"},"Unspoken Casting":{Category:"Magic",DP:20,Gnosis:5,Incompatible:["Oral Requirement"]},"To the Limit":{DP:5,Gnosis:20},"Without Unconsciousness":{DP:10,Gnosis:5,Incompatible:["Physical Exemption"]},Zen:{DP:20,Gnosis:25,Incompatible:["Inhumanity"]}},disadvantages:{"Action Requirement":{Category:"Magic",DP:-20,Gnosis:5,Options:[],Option_Title:"Enter the type of action required"},"Additional Vulnerable Point":{DP:-20,Gnosis:0,Options:[],Option_Title:"Describe the vulnerable point"},"Atrophied Members":{DP:-20,Gnosis:0,Options:["Arms","Legs"],Option_Title:"Select the affected members"},Blind:{DP:-20,Gnosis:0},"Extreme Need":{DP:-20,Gnosis:10,Options:[],Option_Title:"Describe the type and frequency of need"},"Lack of a Sense":{DP:-10,Gnosis:0,Options:["Hearing","Smell","Taste","Touch"],Option_Title:"Select a sense"},"Magic Blockage":{Category:"Magic",DP:-30,Gnosis:5,Incompatible:["Slow Recovery of Magic","Superior Magic Recovery"]},"Magical Exhaustion":{Category:"Magic",DP:-10,Gnosis:5},"Natural Vulnerability to an Element (50% More Damage)":{DP:-10,Gnosis:20,Options:i.elements,Option_Title:"Select an element",Alternatives:["Natural Vulnerability to an Element (Double Damage)"]},"Natural Vulnerability to an Element (Double Damage)":{DP:-20,Gnosis:20,Options:i.elements,Option_Title:"Select an element",Alternatives:["Natural Vulnerability to an Element (50% More Damage)"]},"No Concentration":{Category:"Psychic",DP:-10,Gnosis:5,Incompatible:["Extreme Concentration","Passive Concentration"]},"Oral Requirement":{Category:"Magic",DP:-10,Gnosis:5,Incompatible:["Unspoken Casting"]},"Physical Need":{DP:-10,Gnosis:0,Options:[],Option_Title:"Describe the type and frequency of need"},"Psychic Consumption":{Category:"Psychic",DP:-20,Gnosis:5},"Psychic Exhaustion":{Category:"Psychic",DP:-10,Gnosis:5},"Racial Fear":{DP:-10,Gnosis:10,Options:[],Option_Title:"Describe the source of fear"},"Racial Terror":{DP:-20,Gnosis:10,Options:[],Option_Title:"Describe the source of terror"},"Racial Vice":{DP:-10,Gnosis:0,Options:[],Option_Title:"Describe the vice"},"Require Gestures":{Category:"Magic",DP:-10,Gnosis:5,Incompatible:["Gestureless Casting"]},"Slow Recovery of Magic":{Category:"Magic",DP:-10,Gnosis:5,Incompatible:["Magic Blockage","Superior Magic Recovery"]},"Vulnerability to a Type of Attack":{DP:-20,Gnosis:10,Options:[],Option_Title:"Enter the type of attack"},"Vulnerable to Harm":{DP:-30,Gnosis:0}}}
}),define("libs/utils",[],function(){return Object.keys=Object.keys||function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=i.length;return function(a){var s,o,r=[];if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("Object.keys called on a non-object");for(o in a)e.call(a,o)&&r.push(o);if(t)for(s=0;n>s;s++)e.call(a,i[s])&&r.push(i[s]);return r}}(),{intersection:function(e,t){for(var i=0,n=0,a=[];e.length>i&&t.length>n;)e[i]<t[n]?i++:e[i]>t[n]?n++:(a.push(e[i]),i++,n++);return a}}}),define("character",["jquery","abilities","classes","cultural_roots","psychic_disciplines","essential_abilities","tables","libs/utils"],function(e,t,i,n,a,s,o,r){var l=function(){return this instanceof l?(this.Advantages={},this.Disadvantages={},this.Race="",this.XP=0,this.levels=[{Class:"Freelancer",DP:{}}],void 0):new l};return l.prototype.ability=function(a,s,r){var l,c,u,d,p,h,f,m,g,v,y,b,D,P,_=this.Advantages,C=this.Disadvantages,A=t[a],M=0,k=A.Characteristic,x=_["Combat Senses"],w=this.levels.length,S=0,R=1,T=this.Race,N=this.level(),O=0,F="Wear Armor"===a&&_["Use of Armor"];if(r!==void 0&&(w=0===r?1:r),b=_["Natural Learner"],b&&b.Ability===a&&(S+=10*b.Points),b=_["Natural Learner, Field"],b&&b.Field===A.Field&&(S+=5*(b.Points-1)),b=_["Cultural Roots"]){if(c=b,d=[],"string"!=typeof b&&(c=b.Background,d=b.Choices),h=n[c],a in h)l=h[a];else if(-1!==e.inArray(a,d))for(d=h.choices,v=d.length,m=0;v>m;m++){u=d[m];for(y in u)u.hasOwnProperty(y)&&y===a&&(l=u[y])}else l=0;"number"!=typeof l?(D=Object.keys(l)[0],D===s&&(M+=l[D])):M+=l}"Increased Natural Bonus"in _&&(R=2),"Without any Natural Bonus"in C&&(R=0);for(m=0;w>m;m++)g=this.levels[m],p=i[g.Class],l=g.DP[a],l&&(O+=l),f=g.Freelancer,f&&e.inArray(a,f)>=0&&(O+=0===N?5:10),l=p.bonuses[a],l&&(M+=0===N?Math.floor(l/2):l),x===a?M+=5:F&&(M+=5*F),g["Natural Bonus"]===a&&(M+=this.modifier(k,m+1)*R),M+=S;return"Field"in A&&("Jack of All Trades"in _?O+=10:5>O&&(O-=30)),M>50&&-1!==e.inArray(a,o.primary_combat_abilities)&&(M=50),"Acute Senses"in _&&-1!==e.inArray(a,["Notice","Search"])&&(M+=30),"Klutzy"in this.Disadvantages&&-1!==e.inArray(a,o.klutzy)&&(O-=30),"Psychic Immunity"in _&&"Composure"===a&&(M+=60),"Seducer"in _&&"Persuasion"===a&&"seduction"===s&&(M+=60),"Talented"in _&&"Sleight of Hand"===a&&(M+=30),"Devah Nephilim"===T&&e.inArray(a,["Banish","Bind"])&&(M+=10),s&&(P=this.Specializations,P&&(D=P[a],D===s&&(M+=40))),O+=M+this.modifier(k,r)},l.prototype.appearance=function(){var e="Appearance"in this?this.Appearance:5;return"D'Anjayni Nephilim"===this.Race&&(3>e&&(e=3),e>7&&(e=7)),"Unattractive"in this.Disadvantages&&(e=2),e},l.prototype.change_class=function(e,t){var i=e>0?e-1:0,n=this.levels;n[i].Class=t,n.length>i+1&&!("Versatile"in this.Advantages)&&(n[i+1].Class=t)},l.prototype.clear=function(){this.Advantages={},this.Disadvantages={},this.Race="",this.XP=0,this.levels=[{Class:"Freelancer",DP:{}}],"Created"in this&&delete this.Created,"Element"in this&&delete this.Element,"First Martial Art"in this&&delete this["First Martial Art"],"Gnosis"in this&&delete this.Gnosis,"Insufficient Martial Knowledge"in this&&delete this["Insufficient Martial Knowledge"],"Racial Level"in this&&delete this["Racial Level"],"Specializations"in this&&delete this.Specializations},l.prototype.characteristic=function(e,t){var i,n,a,s,o,r,l=this.levels[0].DP,c=this.Advantages,u=this.Disadvantages,d=e in this?this[e]:5;if(t||(t=this.level()),r=c["Increase One Characteristic to Nine"])for(s=r.length,n=0;s>n;n++)r[n]===e&&(d=9);if(r=c["Repeat a Characteristics Roll"])for(s=r.length,n=0;s>n;n++)a=r[n],a.Characteristic===e&&(d=a.Roll);if(r=c["Add One Point to a Characteristic"])for(s=r.length,n=0;s>n;n++)r[n]===e&&(d+=1);if(r=l["Attribute Increased +1"])for(s=r.length,n=0;s>n;n++)r[n]===e&&(d+=1);if(r=l["Attribute Increased +2"])for(s=r.length,n=0;s>n;n++)r[n]===e&&(d+=2);if(r=l["Attribute Increased +3"]){for(s=r.length,i=0,n=0;s>n;n++)r[n]===e&&(i+=1);i&&(d+=i+2)}for(u["Deduct Two Points from a Characteristic"]===e&&(d-=2),"Jayan Nephilim"===this.Race&&"STR"===e&&(d+=1),n=0;t>n&&this.levels.length>n;n++)o=this.levels[n],o.Characteristic===e&&(d+=1);return d>20&&(d=20),d},l.prototype.class_change_dp=function(e){var t,n,a,s,o=60,l=this.levels;return 2>e?0:(a=l[e-1].Class,t=l[e-2].Class,a===t?0:(s=i[a].Archetypes,n=i[t].Archetypes,"Freelancer"===a||"Freelancer"===t?o=20:1===s.length&&1===n.length&&s[0]===n[0]?o=20:r.intersection(s,n).length>0&&(o=40),"Versatile"in this.Advantages&&(o/=2),o))},l.prototype.class_change_possible=function(e){var t=this.levels,i=this["Racial Level"];return i&&i>=e?!1:2>e?!1:"Versatile"in this.Advantages?!0:2===e?!1:t[e-2].Class!==t[e-3].Class?!1:this.level()>e&&t[e-1].Class!==t[e].Class?!1:!0},l.prototype.creation_stage=function(){var e,t,i,n,a=0,o=this.levels,r=o.length,l=o[0].Class;for(t=0;r>t;t++){if(n=o[t],n.Characteristic||n["Natural Bonus"])return 6;if(t>0&&n.Class!==l)return 6;e=n.DP;for(i in e)if(e.hasOwnProperty(i))if(i in s.advantages)a+=1;else{if(!(i in s.disadvantages))return 6;a+=1}}return Object.keys(this.Advantages).length>0||Object.keys(this.Disadvantages).length>0?5:this.STR?4:a>0?3:this.Gnosis||this.Element?2:1},l.prototype.damage_resistance_multiple=function(){var e=this.size();return 4>e?1:9>e?2:25>e?5:29>e?10:34>e?15:20},l.prototype.discipline_access=function(){var e=this.levels[0].DP,t=this.Advantages,i=t["Access to One Psychic Discipline"];return i?[i]:"Free Access to Any Psychic Discipline"in t?Object.keys(a.disciplines):"Access to a Psychic Discipline"in e?[e["Access to a Psychic Discipline"]]:"Access to Psychic Disciplines"in e?Object.keys(a.disciplines):[]},l.prototype.element_allowed=function(){var e=this.Type;return"Between Worlds"===e||"Spirit"===e},l.prototype.fatigue=function(){var e=this.levels[0].DP,t=e["Fatigue Resistance"],i=this.characteristic("CON"),n=this.Advantages.Untiring;return"Tireless"in e||"Physical Exemption"in e?"N/A":("Jayan Nephilim"===this.Race&&(i+=1),n&&(i+=3*n),t&&(i+=2*t),"Exhausted"in this.Disadvantages&&i--,i)},l.prototype.gender=function(){var e=this.Gender;return e?e:"Male"},l.prototype.gnosis=function(){var e=this.Gnosis;return e?e:0},l.prototype.is_corporeal_undead=function(){var e=this.Type;return e&&e.indexOf("Between Worlds, Undead")>-1},l.prototype.is_spirit=function(){var e=this.Type;return e&&e.indexOf("Spirit")>-1},l.prototype.level=function(){var e,t=o.xp_chart,i=this.XP;if(i>=4125)return 16;for(e=0;16>e;e++)if(t[e]>i)return e},l.prototype.level_info=function(e){return this.levels[0===e?0:e-1]},l.prototype.life_points=function(){var e,t,n,a,s=this.modifier("CON"),r=this.Advantages["Hard to Kill"],l=this.level(),c=this.levels,u=c.length,d=o.base_lp[this.characteristic("CON")];for(this.is_spirit()&&(d=o.base_lp[this.characteristic("POW")]),t=0;u>t;t++)n=c[t],e=i[n.Class],l>0&&(d+=e.LP),a=n.DP["Life Point Multiple"],a&&(d+=a*s),a=n.DP["Life Points"],a&&(d+=a*this.damage_resistance_multiple()),r&&(d+=10*r);return d},l.prototype.modifier=function(e,t){return o.modifiers[this.characteristic(e,t)]},l.prototype.presence=function(){return 5*this.level()+25},l.prototype.racial_abilities=function(){switch(this.Race){case"D'Anjayni Nephilim":return"Pass Without Trace, Forgetfulness, +30 to Resistance vs. detection, Silent Whisper, -3 XP";case"Daimah Nephilim":return"See the Essence, Sense the Forest, +3 Regeneration in thick forest or jungle, Movement in the Forest, -2 XP";case"Devah Nephilim":return"+10 to Resistances vs. mind reading and emotion alteration, The Eye of the Soul, +10 Bind and Banish, -10 PhR and DR, -3 XP";case"Duk'zarist Nephilim":return"+10 to Resistances vs. Dark, Automatically pass between life and death PhR checks, Limited Needs, Sense Light and Dark, Night Vision, Allergic to Metal, -5 XP";case"Ebudan Nephilim":return"+30 to Resistance vs. Forgetfulness and Emotional Control OR (Immune to attacks that cannot damage Energy, Flight Value 12), -3 XP";case"Jayan Nephilim":return"Spiritual Vision, -3 XP";case"Sylvain Nephilim":return"+10 to Resistances vs. Light, Sense Light and Dark, Limited Needs, -4 XP";case"Vetala Nephilim":return"+50 PhR vs. Criticals, Blood Ecstasy, +1 Regeneration, Photosensitive Skin, Blood Obsession, -20 DR, -3 XP";default:return""}},l.prototype.regeneration=function(){var t=this.gnosis(),i=this.Advantages.Regeneration,n=o.regeneration[this.characteristic("CON")];return-1!==e.inArray(this.Race,["Duk'zarist Nephilim","Sylvain Nephilim","Vetala Nephilim"])&&(n+=1),i&&(n+=2*i),this.is_corporeal_undead()&&(n=0),n>18&&40>t?n=18:n>19&&45>t?n=19:n>20&&(n=20),n},l.prototype.second_hand_penalty=function(){return"Ambidextrous"in this.Advantages?10:"Ambidextrous"in this.levels[0].DP?10:40},l.prototype.set_natural_bonus=function(e,t){var i=this.levels;1>e||e>i.length||(i[e-1]["Natural Bonus"]=t)},l.prototype.set_freelancer_bonus=function(t,i,n){var a,s=0===t?0:t-1,o=this.levels;if(!(0>t||t>o.length))if(a=o[s].Freelancer,a||(a=[],o[s].Freelancer=a),e.trim(n))a[e.inArray(n,a)]=i;else{if(a.length>=5)return;a.push(i)}},l.prototype.size=function(){var e=this.characteristic("STR")+this.characteristic("CON"),t=this.Advantages["Uncommon Size"],i=this.levels[0].DP["Unnatural Size"];switch(this.Race){case"Daimah Nephilim":e-=1;break;case"Jayan Nephilim":e+=2}return t&&(e+=t),i&&(e+=i),e},l.prototype.size_category=function(){var e=this.size();return 3>=e?"Miniscule":8>=e?"Small":22>=e?"Medium":24>=e?"Big":28>=e?"Enormous":33>=e?"Giant":"Colossal"},l.prototype.summary=function(){var t,i,n=[],a={},s=this.levels,o=s.length,r=this.Name,l="";for(r&&(l=r+" "),i=0;o>i;i++)t=s[i].Class,-1===e.inArray(t,n)?(n.push(t),a[t]=1):a[t]++;for(l+="(",o=n.length,i=0;o>i;i++)t=n[i],i>0&&(l+=", "),l+=t,l+=" ",l+=a[t];return l+=")"},l.prototype.type_and_gnosis=function(){var e,t=this.Element,i=this.Gnosis,n=this.Type;return n&&"Human"!==n?(e=n,t&&(e+=", Elemental"),"number"==typeof i&&(e+=" "+i),e):""},l.prototype.has_gift=function(){var e=this.Advantages;return"The Gift"in e?!0:"Incomplete Gift"in e?!0:"Gift"in this.levels[0].DP?!0:!1},l}),define("characters",["character"],function(e){return{all:[new e],current:function(){return this.all[0]}}}),define("ki_abilities",["tables"],function(e){return{"Absorption of Energy":{MK:30,Requirements:["Use of Ki","Presence Extrusion"]},"Age Control":{MK:20,Requirements:["Use of Ki","Ki Control","Physical Dominion"]},"Arcane Magnitude":{MK:40,Requirements:["Use of Ki","Ki Control","Physical Dominion","Multiplication of Bodies","Magnitude"]},"Arcane Multiplication of Bodies":{MK:40,Requirements:["Use of Ki","Ki Control","Physical Dominion","Multiplication of Bodies","Greater Multiplication of Bodies"]},"Armor of Arcane Energy":{MK:10,Requirements:["Use of Ki","Presence Extrusion","Energy Armor","Armor of Greater Energy"]},"Armor of Emptiness":{MK:20,Requirements:["Use of Nemesis"]},"Armor of Greater Energy":{MK:10,Requirements:["Use of Ki","Presence Extrusion","Energy Armor"]},"Aura Extension":{MK:10,Requirements:["Use of Ki","Presence Extrusion"]},"Aura of Concealment":{MK:10,Requirements:["Use of Ki","Use of Necessary Energy","Ki Concealment"]},"Aura of Emptiness":{MK:30,Requirements:["Use of Nemesis"]},"Binding Cancellation":{MK:30,Requirements:["Use of Nemesis"]},"Body of Emptiness":{MK:10,Requirements:["Use of Nemesis"]},"Characteristic Augmentation":{MK:20,Requirements:["Use of Ki","Use of Necessary Energy"]},"Combat Aura":{MK:40,Requirements:["Use of Ki","Ki Control"]},"Destruction By Ki":{MK:20,Requirements:["Use of Ki","Presence Extrusion"]},"Elemental Attack":{MK:10,Requirements:["Use of Ki","Presence Extrusion","Aura Extension"],Options:e.elements,Option_Title:"Select an element"},"Elemental Immunity: Cold":{MK:20,Requirements:["Use of Ki","Use of Necessary Energy","Elimination of Necessities"]},"Elemental Immunity: Electricity":{MK:20,Requirements:["Use of Ki","Use of Necessary Energy","Elimination of Necessities"]},"Elemental Immunity: Fire":{MK:20,Requirements:["Use of Ki","Use of Necessary Energy","Elimination of Necessities"]},"Elimination of Necessities":{MK:10,Requirements:["Use of Ki","Use of Necessary Energy"]},"Emptiness Extrusion":{MK:30,Requirements:["Use of Nemesis"]},"Energy Armor":{MK:10,Requirements:["Use of Ki","Presence Extrusion"]},Erudition:{MK:10,Requirements:["Use of Ki","Ki Control","Ki Detection"]},"Essence of Emptiness":{MK:20,Requirements:["Use of Nemesis","Body of Emptiness"]},"False Death":{MK:10,Requirements:["Use of Ki","Use of Necessary Energy","Ki Concealment"]},Flight:{MK:20,Requirements:["Use of Ki","Weight Elimination","Levitation"]},"Form of Emptiness":{MK:30,Requirements:["Use of Nemesis","Body of Emptiness","Emptiness Extrusion"]},"Greater Ki Cancellation":{MK:20,Requirements:["Use of Nemesis","Ki Cancellation"]},"Greater Magic Cancellation":{MK:20,Requirements:["Use of Nemesis","Magic Cancellation"]},"Greater Matrices Cancellation":{MK:20,Requirements:["Use of Nemesis","Matrices Cancellation"]},"Greater Multiplication of Bodies":{MK:30,Requirements:["Use of Ki","Ki Control","Physical Dominion","Multiplication of Bodies"]},"Improvised Combat Techniques":{MK:50,Requirements:["Use of Ki"]},"Increased Damage":{MK:10,Requirements:["Use of Ki","Presence Extrusion","Aura Extension"]},"Increased Reach":{MK:10,Requirements:["Use of Ki","Presence Extrusion","Aura Extension"]},"Increased Speed":{MK:10,Requirements:["Use of Ki","Presence Extrusion","Aura Extension"]},"Inhuman (Nemesis)":{MK:20,Requirements:["Use of Nemesis"]},Inhumanity:{MK:30,Requirements:["Use of Ki"]},"Ki Cancellation":{MK:30,Requirements:["Use of Nemesis"]},"Ki Concealment":{MK:10,Requirements:["Use of Ki","Use of Necessary Energy"]},"Ki Control":{MK:30,Requirements:["Use of Ki"]},"Ki Detection":{MK:20,Requirements:["Use of Ki","Ki Control"]},"Ki Healing":{MK:10,Requirements:["Use of Ki","Ki Transmission"]},"Ki Transmission":{MK:10,Requirements:["Use of Ki"]},Levitation:{MK:20,Requirements:["Use of Ki","Weight Elimination"]},"Life Sacrifice":{MK:10,Requirements:["Use of Ki","Ki Transmission"]},"Magic Cancellation":{MK:30,Requirements:["Use of Nemesis"]},Magnitude:{MK:30,Requirements:["Use of Ki","Ki Control","Physical Dominion","Multiplication of Bodies"]},"Mass Movement":{MK:20,Requirements:["Use of Ki","Weight Elimination","Levitation","Object Motion"]},"Matrices Cancellation":{MK:30,Requirements:["Use of Nemesis"]},"Movement of Emptiness":{MK:20,Requirements:["Use of Nemesis","Body of Emptiness"]},"Multiplication of Bodies":{MK:30,Requirements:["Use of Ki","Ki Control","Physical Dominion"]},"No Needs":{MK:10,Requirements:["Use of Nemesis","Body of Emptiness"]},Noht:{MK:30,Requirements:["Use of Nemesis"]},"Object Motion":{MK:10,Requirements:["Use of Ki","Weight Elimination","Levitation"]},"One with the Nothing":{MK:40,Requirements:["Use of Nemesis","Body of Emptiness"]},"Penalty Reduction":{MK:20,Requirements:["Use of Ki","Use of Necessary Energy"]},"Physical Change":{MK:30,Requirements:["Use of Ki","Ki Control","Physical Dominion"]},"Physical Dominion":{MK:10,Requirements:["Use of Ki","Ki Control"]},"Physical Shield":{MK:10,Requirements:["Use of Ki","Presence Extrusion"]},"Presence Extrusion":{MK:10,Requirements:["Use of Ki"]},Recovery:{MK:20,Requirements:["Use of Ki","Use of Necessary Energy","Penalty Reduction"]},"Restore Others":{MK:10,Requirements:["Use of Ki","Use of Necessary Energy","Penalty Reduction","Recovery"]},Stabilize:{MK:10,Requirements:["Use of Ki","Ki Transmission","Ki Healing"]},"Superior Change":{MK:20,Requirements:["Use of Ki","Ki Control","Physical Dominion","Physical Change"]},"Superior Characteristic Augmentation":{MK:20,Requirements:["Use of Ki","Use of Necessary Energy","Characteristic Augmentation"]},"Superior Healing":{MK:10,Requirements:["Use of Ki","Ki Transmission","Ki Healing"]},"Technique Imitation":{MK:50,Requirements:["Use of Ki","Ki Control"]},"Technique Pushing":{MK:20,Requirements:["Use of Ki"]},Undetectable:{MK:10,Requirements:["Use of Nemesis"]},"Use of Ki":{MK:40},"Use of Necessary Energy":{MK:10,Requirements:["Use of Ki"]},"Use of Nemesis":{MK:70},"Weight Elimination":{MK:10,Requirements:["Use of Ki"]},Zen:{MK:50,Requirements:["Use of Ki","Inhumanity"]},"Zen (Nemesis)":{MK:40,Requirements:["Use of Nemesis","Inhuman (Nemesis)"]}}}),define("martial_arts",{Aikido:{Base:{Damage:10,Requirements:{"Sleight of Hand":20}},Advanced:{Advantages:["No penalties to Trapping or Take Down during a counterattack"],Bonus:{Block:10,Dodge:10},MK:10,Requirements:{"Sleight of Hand":40,Attack:100,Defense:120}},Supreme:{Advantages:["+2 to opposed Characteristic checks for Trapping or Take Down during or after a counterattack","Add 4 times opponent's STR to Base Damage on counterattack"],Bonus:{Block:10,Dodge:10},Damage:10,MK:10,Requirements:{"Sleight of Hand":80,Defense:200}}},Asakusen:{Base:{MK:10,Requirements:{"Martial Art":{"Kung Fu":"Advanced"},Attack:160,Defense:160}},Arcane:{Advantages:["Kung Fu (Supreme) +20 bonus is increased to +40","+20 to Criticals on Aimed Attacks on vital points"],"Master Bonus":{Attack:10,Block:10,Dodge:10},MK:10,Requirements:{"Martial Art":{"Kung Fu":"Supreme"},"Ki Abilities":["Inhumanity"],Attack:280,Defense:280}}},Boxing:{Base:{Bonus:{Initiative:5},Damage:{Base:10,Multiplier:2},Requirements:{"Feats of Strength":30}},Advanced:{Advantages:["+10 to Attack when making a counterattack"],Bonus:{Initiative:5},Damage:{Base:20,Multiplier:2},MK:10,Requirements:{"Feats of Strength":60,Attack:120,Defense:120}},Supreme:{Bonus:{Attack:10,Initiative:10},Damage:{Base:30,Multiplier:2},MK:10,Requirements:{"Feats of Strength":120,Attack:200,Defense:200}}},Capoeira:{Base:{Advantages:["Can affect 3 opponents with Area Attack (as Medium weapon)"],Damage:20,Requirements:{Dance:20}},Advanced:{Advantages:["Can affect 5 opponents with Area Attack (as Large weapon)"],Replace:!0,Bonus:{Dodge:10},MK:10,Requirements:{Dance:40,Dodge:120}},Supreme:{Advantages:["Can perform Area Attack with only -10 to Attack"],Bonus:{Dodge:10},MK:10,Requirements:{Dance:120,Dodge:200}}},Dumah:{Base:{Advantages:["Can attack as Cut or Thrust","-2 to opponent's AT","+10 to Breakage"],Bonus:{Attack:20},Damage:10,MK:10,Requirements:{"Martial Art":{Kempo:"Advanced",Capoeira:"Advanced"},"Ki Abilities":["Presence Extrusion"]}},Arcane:{Advantages:["Can attack as Cut or Thrust","-6 to opponent's AT","+25 to Breakage","Attacks automatically cause bleeding"],Damage:20,"Master Bonus":{Attack:20},MK:10,Replace:!0,Requirements:{"Martial Art":{Kempo:"Supreme",Capoeira:"Supreme"},"Ki Abilities":["Inhumanity"],Attack:280}}},Emp:{Base:{Advantages:["Disarm with no penalty and +3 to Characteristic checks when performing it"],Bonus:{Atack:20,Initiative:10},MK:10,Requirements:{"Martial Art":{Kempo:"Advanced",Kuan:"Advanced","Malla-Yuddha":"Advanced"},Attack:200}},Arcane:{Advantages:["Free disarm attempt on any successful defense"],Bonus:{Initiative:10},"Master Bonus":{Attack:20},MK:10,Requirements:{"Martial Art":{Kempo:"Supreme",Kuan:"Supreme","Malla-Yuddha":"Supreme"},Attack:280,Defense:260}}},Enuth:{Base:{Advantages:["+20 to Criticals when trying to knock opponent unconscious","Can reduce damage to exact amount desired"],Bonus:{Block:20,Dodge:20},MK:10,Requirements:{"Martial Art":{Sambo:"Advanced",Shotokan:"Advanced"},Attack:160,Defense:160}},Arcane:{Advantages:["All hits have chance of knocking enemy unconscious with +50 to Critical level","Can reduce damage to exact amount desired","Can determine opponent's remaining LP after each hit"],"Master Bonus":{Attack:15,Block:15,Dodge:15},MK:10,Replace:!0,Requirements:{"Martial Art":{Sambo:"Supreme",Shotokan:"Supreme"},"Ki Abilities":["Inhumanity","Erudition"],Attack:280,Defense:280}}},Exelion:{Base:{Damage:{Base:"Presence x2",Characteristic:"POW"},Bonus:{Attack:10},MK:15,Requirements:{"Martial Art":{Kardad:"Advanced","Tai Chi":"Advanced"},Attack:200,"Ki Abilities":["Aura Extension"]}},Arcane:{"Master Bonus":{Attack:25},MK:20,Requirements:{"Martial Art":{Kardad:"Supreme","Tai Chi":"Supreme"},"Ki Abilities":["Inhumanity"],Attack:300}}},Godhand:{Base:{Advantages:["Can sacrifice an attack to gain +30 Attack and +50 Damage to first attack next turn"],Bonus:{Attack:10},MK:10,Requirements:{"Martial Art":{Boxing:"Advanced",Shotokan:"Advanced"},Attack:200}},Arcane:{Advantages:["Can sacrifice an attack to gain +60 Attack and +100 Damage to first attack next turn"],"Master Bonus":{Attack:15},MK:10,Replace:!0,Requirements:{"Martial Art":{Boxing:"Supreme",Shotokan:"Supreme"},"Ki Abilities":["Inhumanity","Presence Extrusion"],Attack:300}}},Grappling:{Base:{Advantages:["Penalties for Trapping and Take Down are halved"],Damage:10,Requirements:{"Feats of Strength":20}},Advanced:{Advantages:["No penalties for Trapping and Take Down"],Replace:!0,Damage:20,MK:10,Requirements:{"Feats of Strength":40,Attack:130}},Supreme:{Advantages:["Full damage instead of half when executing Trapping or Take Down"],MK:10,Requirements:{"Feats of Strength":120,Attack:200}}},Hakyoukuken:{Base:{Advantages:["-2 to AT of soft armors","+20 to Critical level rolls against organic beings"],Bonus:{Attack:10,Initiative:20},Damage:20,MK:10,Requirements:{"Martial Art":{Shotokan:"Advanced","Muay Thai":"Advanced"},"Ki Abilities":["Use of Necessary Energy"],Attack:200}},Arcane:{Advantages:["Soft armors ignored except Quality bonus","+40 to Critical level rolls against organic beings"],Bonus:{Initiative:20},Damage:30,"Master Bonus":{Attack:20},MK:10,Replace:!0,Requirements:{"Martial Art":{Shotokan:"Supreme","Muay Thai":"Supreme"},"Ki Abilities":["Inhumanity"],Attack:300}}},Hanja:{Base:{Advantages:["No penalties to defend against attacks from back","No penalties to defense in confined spaces","Can attack enemies at any position without penalty"],Bonus:{Block:10,Dodge:10},MK:10,Requirements:{"Martial Art":{"Soo Bahk":"Advanced"},"Ki Abilities":["Ki Detection"],Notice:200,Defense:200}},Arcane:{Advantages:["No penalties when Partially or Mostly Immobilized or Put at Weapon's Point"],"Master Bonus":{Attack:20},MK:10,Requirements:{"Martial Art":{"Soo Bahk":"Supreme"},"Ki Abilities":["Inhumanity","Erudition"],Notice:240,Defense:300}}},Kardad:{Base:{Advantages:["+1 to Characteristic checks vs. Trapping and Take Down or to escape a hold"],Damage:10,Requirements:{Athleticism:40,"Sleight of Hand":20}},Advanced:{Advantages:["+3 to Characteristic checks vs. Trapping and Take Down or to escape a hold"],Replace:!0,Bonus:{Block:10,Dodge:10},Damage:20,MK:10,Requirements:{Athleticism:60,"Sleight of Hand":40,Defense:120}},Supreme:{Advantages:["Can once per turn retry a failed Characteristic check vs. Trapping or Take Down or to escape a hold"],Bonus:{Block:10,Dodge:10},Damage:30,MK:10,Requirements:{Athleticism:120,"Sleight of Hand":100}}},Kempo:{Base:{Advantages:["Additional attacks are at -15 instead of -25"],Damage:10},Advanced:{Advantages:["Additional attacks are at -10 instead of -25"],Replace:!0,Damage:20,MK:10,Requirements:{Attack:120}},Supreme:{Advantages:["Additional attacks limit as if Attack was 100 higher"],Bonus:{Attack:10},MK:10,Requirements:{Attack:200}}},Kuan:{Base:{Advantages:["Penalty to Block against thrown projectiles is halved"],Damage:10,Requirements:{"Sleight of Hand":40}},Advanced:{Advantages:["Penalty to Block and Dodge against fired projectiles is halved"],Bonus:{Block:10},Damage:20,MK:10,Requirements:{"Sleight of Hand":60,Defense:120}},Supreme:{Advantages:["No penalty to Block or Dodge against projectiles"],Replace:!0,Bonus:{Block:10},MK:10,Requirements:{"Sleight of Hand":60,Defense:120}}},"Kung Fu":{Base:{Damage:20,Requirements:{Acrobatics:20,"Sleight of Hand":20,Style:10}},Advanced:{Advantages:["+10 to Attack, Block, Damage, Dodge, or Initiative each turn"],MK:10,Requirements:{Acrobatics:40,"Sleight of Hand":40,Style:20,Attack:120,Defense:120}},Supreme:{Advantages:["+20 to Attack, Block, Damage, or Initiative each turn","Can strike as Thrust or Impact"],Replace:!0,MK:10,Requirements:{Acrobatics:120,"Sleight of Hand":120,Style:100,Attack:200,Defense:200}}},Lama:{Base:{Bonus:{Block:10,Dodge:10},Damage:10,Requirements:{Style:20}},Advanced:{Advantages:["Defense penalties don't start until third attack"],Damage:20,MK:10,Requirements:{Defense:130,Style:40}},Supreme:{Advantages:["Defense penalties don't start until fourth attack"],Bonus:{Block:10,Dodge:10},MK:10,Requirements:{Defense:200,Style:80}}},"Lama Tsu":{Base:{Advantages:["Two additional defenses with no penalty per turn"],Bonus:{Block:20,Dodge:20},MK:10,Requirements:{"Martial Art":{Lama:"Advanced"},"Ki Abilities":["Ki Detection"],Style:120,Defense:220}},Arcane:{Advantages:["Never suffer penalties for additional defenses"],"Master Bonus":{Block:20,Dodge:20},MK:10,Replace:!0,Requirements:{"Martial Art":{Lama:"Supreme"},"Ki Abilities":["Erudition"],Style:140,Defense:300}}},"Malla-Yuddha":{Base:{Advantages:["+10 to Fortitude when Blocking with bare hands"],Damage:20,Requirements:{"Sleight of Hand":20}},Advanced:{Advantages:["Takes no damage when Blocking with bare hands"],Replace:!0,Bonus:{Block:10},Damage:30,MK:10,Requirements:{"Sleight of Hand":40,Defense:120}},Supreme:{Advantages:["Can attempt Disarm with no penalty when counterattack succeeds"],Bonus:{Block:20},Damage:40,MK:10,Requirements:{"Sleight of Hand":100,Block:200}}},Melkaiah:{Base:{Advantages:["+3 to Characteristic checks when performing Take Down or Trapping"],Bonus:{Attack:10},MK:10,Requirements:{"Martial Art":{Grappling:"Advanced",Pankration:"Advanced"},"Ki Abilities":["Inhumanity"],Attack:160,Defense:160}},Arcane:{Advantages:["+50 to Attack when releasing opponent to use Complete Attack","+3 to Characteristic checks when performing Crush or Strangle"],"Master Bonus":{Attack:10,Block:10,Dodge:10},MK:10,Requirements:{"Martial Art":{Grappling:"Supreme",Pankration:"Supreme"},Attack:260,Defense:260}}},"Muay Thai":{Base:{Damage:{Base:20,Multiplier:2},Requirements:{"Feats of Strength":30}},Advanced:{Damage:{Base:20,Multiplier:3},MK:10,Requirements:{"Feats of Strength":40,Attack:130}},Supreme:{Advantages:"+10 to Critical level",Damage:{Base:20,Multiplier:4},MK:10,Requirements:{"Feats of Strength":160,Attack:200}}},Mushin:{Base:{Advantages:["Can attack pressure points to require PhR instead of directly taking LP"],Bonus:{Attack:10},MK:15,Requirements:{"Martial Art":{"Kung Fu":"Advanced","Xing Quan":"Advanced"},"Medicine (Anatomy)":100,Attack:200}},Arcane:{Advantages:["Can inflict special effects via pressure point attacks"],"Master Bonus":{Attack:20},MK:15,Requirements:{"Martial Art":{"Kung Fu":"Supreme","Xing Quan":"Supreme"},"Ki Abilities":["Inhumanity"],"Medicine (Anatomy)":120,Attack:300}}},Pankration:{Base:{Advantages:["Penalty for Trapping is halved"],Damage:20,Requirements:{Athleticism:30,"Feats of Strength":30}},Advanced:{MK:10,Requirements:{Athleticism:50,"Feats of Strength":50,Attack:110,Defense:110}},Supreme:{Advantages:["Trapped opponents suffer -5 instead of -3 to escape"],Bonus:{Block:10,Dodge:10},MK:10,Requirements:{"Feats of Strength":120,Defense:200}}},"Rex Frame":{Base:{Advantages:["AT 3 against all attack types","Damage Barrier 60"],Bonus:{Block:10,Dodge:10},MK:10,Requirements:{"Martial Art":{"Malla-Yuddha":"Advanced","Muay Thai":"Advanced"},Defense:200,"Ki Abilities":["Inhumanity"]}},Arcane:{Advantages:["AT 6 against all attack types","Damage Barrier 200"],"Master Bonus":{Block:20,Dodge:20},MK:20,Replace:!0,Requirements:{"Martial Art":{"Malla-Yuddha":"Supreme","Muay Thai":"Supreme"},Defense:300,"Ki Abilities":["Zen"]}}},Sambo:{Base:{Advantages:["Penalties for Take Down and Disarm are halved"],Damage:10},Advanced:{Advantages:["Penalties for Trapping and Area Attack are halved"],Bonus:{Block:10},Damage:20,MK:10,Requirements:{Attack:130}},Supreme:{Advantages:["Penalties for Aimed Attacks are halved"],Bonus:{Block:10},Damage:30,MK:10,Requirements:{Attack:200,Defense:200}}},Selene:{Base:{Advantages:["Double counterattack bonus"],Bonus:{Block:20,Dodge:20},MK:10,Requirements:{"Martial Art":{Aikido:"Advanced"},Defense:200}},Arcane:{Advantages:["Can counterattack even if no attacks left unless on defensive"],"Master Bonus":{Block:20,Dodge:20},MK:10,Requirements:{"Martial Art":{Aikido:"Supreme"},"Ki Abilities":["Inhumanity"],Defense:300}}},Seraphite:{Base:{Advantages:["Can gain +20 to Attack in exchange for -30 to defense"],Bonus:{Attack:20},Damage:10,MK:10,Requirements:{"Martial Art":{Shotokan:"Advanced",Kempo:"Advanced"},"Ki Abilities":["Presence Extrusion"],Attack:180}},Arcane:{Advantages:["Can gain +30 to Attack in exchange for -50 to defense","Can attack on turn even if put on Defensive unless a Critical was suffered"],"Master Bonus":{Attack:20},MK:10,Requirements:{"Martial Art":{Shotokan:"Supreme",Kempo:"Supreme"},Attack:280}}},Shephon:{Base:{Advantages:["Pure Defense bonus increased to +60"],Bonus:{Block:20,Dodge:20},MK:10,Requirements:{"Martial Art":{Aikido:"Advanced",Kuan:"Advanced"},"Ki Abilities":["Use of Ki"],Defense:200}},Arcane:{Advantages:["Pure Defense bonus increased to +100"],"Master Bonus":{Block:20,Dodge:20},MK:10,Replace:!0,Requirements:{"Martial Art":{Aikido:"Supreme",Kuan:"Supreme"},Defense:300}}},Shotokan:{Base:{Bonus:{Attack:5},Damage:20},Advanced:{Bonus:{Attack:5},Damage:30,MK:10,Requirements:{Attack:120,Defense:120}},Supreme:{Bonus:{Attack:10},Damage:50,MK:10,Requirements:{Attack:200}}},"Soo Bahk":{Base:{Advantages:["Penalty to defending from flanks is halved"],Damage:10,Requirements:{Notice:50}},Advanced:{Advantages:["No penalty when defending from flanks","Can attack enemies at flanks without facing them"],Replace:!0,Bonus:{Block:10,Dodge:10},Damage:20,MK:10,Requirements:{Notice:90,Defense:120}},Supreme:{Advantages:["No penalty to Attack or Defense when knocked down"],Bonus:{Block:10,Dodge:10},Damage:30,MK:10,Requirements:{Notice:120,Acrobatics:60,Defense:200}}},Suyanta:{Base:{Advantages:["Can inflict damage to Ki Points instead of LP"],Bonus:{Attack:10},MK:15,Requirements:{"Martial Art":{"Tai Chi":"Advanced"},"Ki Abilities":["Presence Extrusion"],Attack:200}},Arcane:{Advantages:["Inflicts damage to both LP and Ki Points"],Damage:"POW","Master Bonus":{Attack:15},MK:20,Replace:!0,Requirements:{"Martial Art":{"Tai Chi":"Supreme"},"Ki Abilities":["Inhumanity"],Attack:300}}},"Tae Kwon Do":{Base:{Advantages:["Can make one additional attack with legs at -30"],Damage:10},Advanced:{Advantages:["Can make one additional attack with legs at -20"],Replace:!0,Damage:20,MK:10,Requirements:{Attack:130,Defense:100}},Supreme:{Advantages:["Can make one additional attack with legs at no penalty"],Replace:!0,MK:10,Requirements:{Attack:200}}},"Tai Chi":{Base:{Damage:{Base:20,Characteristic:"POW"},MK:10},Advanced:{Damage:{Base:20,Characteristic:"POW",Multiplier:2},MK:20,Requirements:{"Ki Abilities":["Use of Ki"]}},Supreme:{Damage:{Base:20,Characteristic:"POW",Multiplier:3},MK:30,Requirements:{"Ki Abilities":["Use of Necessary Energy"],Attack:180,Defense:180}}},Velez:{Base:{Advantages:["Can strike as Energy"],Bonus:{Block:20,Dodge:20},MK:20,Requirements:{"Martial Art":{"Tai Chi":"Advanced","Kung Fu":"Advanced"},"Ki Abilities":["Presence Extrusion"]}},Arcane:{Advantages:["Attacks are intangible and invisible","Can use Power for opposed Characteristic checks for maneuvers"],"Master Bonus":{Block:15,Dodge:15},MK:20,Requirements:{"Martial Art":{"Tai Chi":"Supreme","Kung Fu":"Supreme"},Attack:280}}},"Xing Quan":{Base:{Advantages:["+10 to Attack when focused on one enemy who lost initiative"],Damage:10,Requirements:{"Sleight of Hand":20}},Advanced:{Advantages:["+20 to Attack when focused on one enemy who lost initiative"],Replace:!0,Damage:20,MK:10,Requirements:{"Sleight of Hand":50,Initiative:100,Attack:120}},Supreme:{Advantages:["+30 to Attack when focused on one enemy who lost initiative"],Damage:30,MK:10,Replace:!0,Requirements:{"Sleight of Hand":100,Initiative:120,Attack:200}}}}),define("modules",{"Similar Weapon":{Primary:"Combat",DP:10,Options:[],Option_Title:"Select a Weapon"},"Mixed-Class Weapon":{Primary:"Combat",DP:15,Options:[],Option_Title:"Select a Weapon"},"Different Type / Unarmed":{Primary:"Combat",DP:20,Options:[],Option_Title:"Select a Weapon"},"Whole-Class Weapons":{Primary:"Combat",DP:50,Options:["Axe","Cord","Mace","Pole","Shield","Short Arm","Sword","Two-handed"],Option_Title:"Select a Class of Weapons"},"Projectile Weapons":{Primary:"Combat",DP:50},Throwing:{Primary:"Combat",DP:50},"Improvised Weapons":{Primary:"Combat",DP:50},"Barbarian Module":{Primary:"Combat",DP:50,Notes:"War Axe, Battle Axe, Two-handed Sword, Bastard Sword, Heavy Battle Mace"},"Ninja Module":{Primary:"Combat",DP:50,Notes:"Katana, Tanto, Claws, Shuriken, Kusari-gama"},"Duel Module":{Primary:"Combat",DP:50,Notes:"Rapier, Foil, Parrying Dagger, Saber, Long Sword"},"Pirate Module":{Primary:"Combat",DP:50,Notes:"Harpoon, Gladiator's Net, Hook, Saber, Handaxe"},"Nomad Module":{Primary:"Combat",DP:50,Notes:"Dagger, Chakram, Long Bow, Scimitar, Lance"},"Hunt Module":{Primary:"Combat",DP:50,Notes:"Javelin, Bow, Short Sword, Lance, Bolos"},"Knight Module":{Primary:"Combat",DP:50,Notes:"Long Sword, Cavalry Lance, Mace, Bastard Sword, Shield"},"Gladiator Module":{Primary:"Combat",DP:50,Notes:"Short Sword, Gladiator's Net, Buckler, Trident, Whip"},"Assassin Module":{Primary:"Combat",DP:50,Notes:"Short Sword, Miniature Crossbow, Club, Blowgun, Stiletto"},"Soldier Module":{Primary:"Combat",DP:50,Notes:"Crossbow, Long Sword, Halberd, Lance, Shield"},"Indigenous Module":{Primary:"Combat",DP:50,Notes:"Javelin, Lance, Full Shield, Bow, Blowgun"},"Bandit Module":{Primary:"Combat",DP:50,Notes:"Dagger, Crossbow, Short Sword, Mace, Club"},"Batto jutsu / Iai jutsu":{Primary:"Combat",DP:30},"Area Attack":{Primary:"Combat",DP:40},"Precision Attack":{Primary:"Combat",DP:50},"Disarming Attack":{Primary:"Combat",DP:40},"Magic Projection as an Attack":{Primary:"Supernatural",DP:75},"Magic Projection as a Defense":{Primary:"Supernatural",DP:75},"Psychic Projection Module":{Primary:"Psychic",DP:100},"Graceful Parry Module":{Primary:"Combat",DP:30},"Armor Reduction Module":{Primary:"Combat",DP:40},"Blind Fighting Module":{Primary:"Combat",DP:40},"Running Shot Module":{Primary:"Combat",DP:40},"Moving Target Module":{Primary:"Combat",DP:50},"Multiple Target Module":{Primary:"Combat",DP:40},"Defense Against Projectiles Module":{Primary:"Combat",DP:40},"Additional Attacks Module":{Primary:"Combat",DP:40},"Multiple Missiles":{Primary:"Combat",DP:20},"Second Weapon: Defensive Style":{Primary:"Combat",DP:30},"Increased Critical":{Primary:"Combat",DP:20},"Unusual Attacks":{Primary:"Combat",DP:20},"Unusual Traps":{Primary:"Combat",DP:40},Bodyguard:{Primary:"Combat",DP:30},"Movement in Confined Spaces":{Primary:"Combat",DP:30},"Dodging with Shield":{Primary:"Combat",DP:30},"Firm Grip":{Primary:"Combat",DP:10}}),define("primaries",["jquery","abilities","essential_abilities","martial_arts","modules","libs/utils"],function(e,t,i,n,a){var s=function(){var o,r,l,c,u,d=i.advantages,p=i.disadvantages;
if(!(this instanceof s))return new s;this.Combat=["Attack","Block","Dodge","Wear Armor","Ki","Accumulation Multiple","Martial Knowledge","Save Combat DP for later"],this.Supernatural=["Zeon","MA Multiple","Zeon Regeneration Multiple","Magic Projection","Summon","Control","Bind","Banish","Magic Level","Save Supernatural DP for later"],this.Psychic=["Psychic Points","Psychic Projection","Save Psychic DP for later"],this.Other=e.map(Object.keys(t),function(e){return"Field"in t[e]?e:null}),this.Other.push("Life Point Multiple"),this.Other.push("Life Points"),this.Other.push("Save generic DP for later");for(u in this)if(this.hasOwnProperty(u))for(o=this[u],r=o.length,l=0;r>l;l++)this.reverse_lookup_cache[o[l]]=u;for(c in d)d.hasOwnProperty(c)&&(this.reverse_lookup_cache[c]="Other");for(c in p)p.hasOwnProperty(c)&&(this.reverse_lookup_cache[c]="Other");for(c in n)n.hasOwnProperty(c)&&(this.reverse_lookup_cache[c]="Combat");for(c in a)a.hasOwnProperty(c)&&(this.reverse_lookup_cache[c]=a[c].Primary)};return s.prototype.reverse_lookup_cache={},s.prototype.for_ability=function(e){return this.reverse_lookup_cache[e]},new s}),+function(e){function t(){e(n).remove(),e(a).each(function(t){var n=i(e(this));n.hasClass("open")&&(n.trigger(t=e.Event("hide.bs.dropdown")),t.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown"))})}function i(t){var i=t.attr("data-target");i||(i=t.attr("href"),i=i&&/#/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&e(i);return n&&n.length?n:t.parent()}var n=".dropdown-backdrop",a="[data-toggle=dropdown]",s=function(t){e(t).on("click.bs.dropdown",this.toggle)};s.prototype.toggle=function(n){var a=e(this);if(!a.is(".disabled, :disabled")){var s=i(a),o=s.hasClass("open");if(t(),!o){if("ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t),s.trigger(n=e.Event("show.bs.dropdown")),n.isDefaultPrevented())return;s.toggleClass("open").trigger("shown.bs.dropdown"),a.focus()}return!1}},s.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var n=e(this);if(t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled")){var s=i(n),o=s.hasClass("open");if(!o||o&&27==t.keyCode)return 27==t.which&&s.find(a).focus(),n.click();var r=e("[role=menu] li:not(.divider):visible a",s);if(r.length){var l=r.index(r.filter(":focus"));38==t.keyCode&&l>0&&l--,40==t.keyCode&&r.length-1>l&&l++,~l||(l=0),r.eq(l).focus()}}}};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var i=e(this),n=i.data("dropdown");n||i.data("dropdown",n=new s(this)),"string"==typeof t&&n[t].call(i)})},e.fn.dropdown.Constructor=s,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",a,s.prototype.toggle).on("keydown.bs.dropdown.data-api",a+", [role=menu]",s.prototype.keydown)}(window.jQuery),+function(e){var t=function(t,i){this.options=i,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var i=this,n=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var n=e.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(document.body),i.$element.show(),n&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var a=e.Event("shown.bs.modal",{relatedTarget:t});n?i.$element.find(".modal-dialog").one(e.support.transition.end,function(){i.$element.focus().trigger(a)}).emulateTransitionEnd(300):i.$element.focus().trigger(a)}))},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=e.support.transition&&i;if(this.$backdrop=e('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;n?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var i=e.fn.modal;e.fn.modal=function(i,n){return this.each(function(){var a=e(this),s=a.data("bs.modal"),o=e.extend({},t.DEFAULTS,a.data(),"object"==typeof i&&i);s||a.data("bs.modal",s=new t(this,o)),"string"==typeof i?s[i](n):o.show&&s.show(n)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=i,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var i=e(this),n=i.attr("href"),a=e(i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),s=a.data("modal")?"toggle":e.extend({remote:!/#/.test(n)&&n},a.data(),i.data());t.preventDefault(),a.modal(s,this).one("hide",function(){i.is(":visible")&&i.focus()})}),e(document).on("show.bs.modal",".modal",function(){e(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){e(document.body).removeClass("modal-open")})}(window.jQuery),+function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,i,n){this.enabled=!0,this.type=t,this.$element=e(i),this.options=this.getOptions(n);for(var a=this.options.trigger.split(" "),s=a.length;s--;){var o=a[s];if("click"==o)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=o){var r="hover"==o?"mouseenter":"focus",l="hover"==o?"mouseleave":"blur";this.$element.on(r+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,n){i[e]!=n&&(t[e]=n)}),t},t.prototype.enter=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show),void 0):i.show()},t.prototype.leave=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide),void 0):i.hide()},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(t),t.isDefaultPrevented())return;var i=this.tip();this.setContent(),this.options.animation&&i.addClass("fade");var n="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,s=a.test(n);s&&(n=n.replace(a,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(n),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var o=this.getPosition(),r=i[0].offsetWidth,l=i[0].offsetHeight;if(s){var c=this.$element.parent(),u=n,d=document.documentElement.scrollTop||document.body.scrollTop,p="body"==this.options.container?window.innerWidth:c.outerWidth(),h="body"==this.options.container?window.innerHeight:c.outerHeight(),f="body"==this.options.container?0:c.offset().left;n="bottom"==n&&o.top+o.height+l-d>h?"top":"top"==n&&0>o.top-d-l?"bottom":"right"==n&&o.right+r>p?"left":"left"==n&&f>o.left-r?"right":n,i.removeClass(u).addClass(n)}var m=this.getCalculatedOffset(n,o,r,l);this.applyPlacement(m,n),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var i,n=this.tip(),a=n[0].offsetWidth,s=n[0].offsetHeight,o=parseInt(n.css("margin-top"),10),r=parseInt(n.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(r)&&(r=0),e.top=e.top+o,e.left=e.left+r,n.offset(e).addClass("in");var l=n[0].offsetWidth,c=n[0].offsetHeight;if("top"==t&&c!=s&&(i=!0,e.top=e.top+s-c),/bottom|top/.test(t)){var u=0;0>e.left&&(u=-2*e.left,e.left=0,n.offset(e),l=n[0].offsetWidth,c=n[0].offsetHeight),this.replaceArrow(u-a+l,l,"left")}else this.replaceArrow(c-s,c,"top");i&&n.offset(e)},t.prototype.replaceArrow=function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function t(){"in"!=i.hoverState&&n.detach()}var i=this,n=this.tip(),a=e.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,t).emulateTransitionEnd(150):t(),this.$element.trigger("hidden.bs."+this.type),this)},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,i=this.options;return e=t.attr("data-original-title")||("function"==typeof i.title?i.title.call(t[0]):i.title)},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var i=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;i.tip().hasClass("in")?i.leave(i):i.enter(i)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=e.fn.tooltip;e.fn.tooltip=function(i){return this.each(function(){var n=e(this),a=n.data("bs.tooltip"),s="object"==typeof i&&i;a||n.data("bs.tooltip",a=new t(this,s)),"string"==typeof i&&a[i]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(window.jQuery),+function(e){var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var i=e.fn.popover;e.fn.popover=function(i){return this.each(function(){var n=e(this),a=n.data("bs.popover"),s="object"==typeof i&&i;a||n.data("bs.popover",a=new t(this,s)),"string"==typeof i&&a[i]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(window.jQuery),+function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),n=t.attr("data-target");if(n||(n=t.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var a=i.find(".active:last a")[0],s=e.Event("show.bs.tab",{relatedTarget:a});if(t.trigger(s),!s.isDefaultPrevented()){var o=e(n);this.activate(t.parent("li"),i),this.activate(o,o.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:a})})}}},t.prototype.activate=function(t,i,n){function a(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),n&&n()}var s=i.find("> .active"),o=n&&e.support.transition&&s.hasClass("fade");o?s.one(e.support.transition.end,a).emulateTransitionEnd(150):a(),s.removeClass("in")};var i=e.fn.tab;e.fn.tab=function(i){return this.each(function(){var n=e(this),a=n.data("bs.tab");a||n.data("bs.tab",a=new t(this)),"string"==typeof i&&a[i]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=i,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),+function(e){var t=function(i,n){this.options=e.extend({},t.DEFAULTS,n),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(i),this.affixed=this.unpin=null,this.checkPosition()};t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=e(document).height(),n=this.$window.scrollTop(),a=this.$element.offset(),s=this.options.offset,o=s.top,r=s.bottom;"object"!=typeof s&&(r=o=s),"function"==typeof o&&(o=s.top()),"function"==typeof r&&(r=s.bottom());var l=null!=this.unpin&&n+this.unpin<=a.top?!1:null!=r&&a.top+this.$element.height()>=i-r?"bottom":null!=o&&o>=n?"top":!1;this.affixed!==l&&(this.unpin&&this.$element.css("top",""),this.affixed=l,this.unpin="bottom"==l?a.top-n:null,this.$element.removeClass(t.RESET).addClass("affix"+(l?"-"+l:"")),"bottom"==l&&this.$element.offset({top:document.body.offsetHeight-r-this.$element.height()}))}};var i=e.fn.affix;e.fn.affix=function(i){return this.each(function(){var n=e(this),a=n.data("bs.affix"),s="object"==typeof i&&i;a||n.data("bs.affix",a=new t(this,s)),"string"==typeof i&&a[i]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=i,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),i=t.data();i.offset=i.offset||{},i.offsetBottom&&(i.offset.bottom=i.offsetBottom),i.offsetTop&&(i.offset.top=i.offsetTop),t.affix(i)})})}(window.jQuery),+function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]}}e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one(e.support.transition.end,function(){i=!0});var a=function(){i||e(n).trigger(e.support.transition.end)};return setTimeout(a,t),this},e(function(){e.support.transition=t()})}(window.jQuery),define("bootstrap",function(){}),define("libs/spinner",["require","jquery"],function(e){var t=e("jquery"),i=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.spinner.defaults,i),this.$input=this.$element.find(".spinner-input"),this.$element.on("keyup",this.$input,t.proxy(this.change,this)),this.options.hold?(this.$element.on("mousedown",".spinner-up",t.proxy(function(){this.startSpin(!0)},this)),this.$element.on("mouseup",".spinner-up, .spinner-down",t.proxy(this.stopSpin,this)),this.$element.on("mouseout",".spinner-up, .spinner-down",t.proxy(this.stopSpin,this)),this.$element.on("mousedown",".spinner-down",t.proxy(function(){this.startSpin(!1)},this))):(this.$element.on("click",".spinner-up",t.proxy(function(){this.step(!0)},this)),this.$element.on("click",".spinner-down",t.proxy(function(){this.step(!1)},this))),this.switches={count:1,enabled:!0},this.switches.speed="medium"===this.options.speed?300:"fast"===this.options.speed?100:500,this.lastValue=null,this.render(),this.options.disabled&&this.disable()};i.prototype={constructor:i,render:function(){this.$input.val(this.options.value),this.$input.attr("maxlength",(this.options.max+"").split("").length)},change:function(){var e=this.$input.val();e/1?this.options.value=e/1:(e=e.replace(/[^0-9]/g,""),this.$input.val(e),this.options.value=e/1),this.triggerChangedEvent()},stopSpin:function(){clearTimeout(this.switches.timeout),this.switches.count=1,this.triggerChangedEvent()},triggerChangedEvent:function(){var e=this.value();e!==this.lastValue&&(this.lastValue=e,this.$element.trigger("changed",e),this.$element.trigger("change"))},startSpin:function(e){if(!this.options.disabled){var i=this.switches.count;1===i?(this.step(e),i=1):i=3>i?1.5:8>i?2.5:4,this.switches.timeout=setTimeout(t.proxy(function(){this.iterator(e)},this),this.switches.speed/i),this.switches.count++}},iterator:function(e){this.step(e),this.startSpin(e)},step:function(e){var t=this.options.value,i=e?this.options.max:this.options.min;if(e?i>t:t>i){var n=t+(e?1:-1)*this.options.step;(e?n>i:i>n)?this.value(i):this.value(n)}},min:function(e){return e>this.value()&&this.value(e),this.options.min=e,this},max:function(e){return this.value()>e&&this.value(e),this.options.max=e,this},value:function(e){return e!==void 0?(this.options.value=e,this.$input.val(e),this):this.options.value},disable:function(){this.options.disabled=!0,this.$input.attr("disabled",""),this.$element.find("button").addClass("disabled")},enable:function(){this.options.disabled=!1,this.$input.removeAttr("disabled"),this.$element.find("button").removeClass("disabled")}},t.fn.spinner=function(e,n){var a,s=this.each(function(){var s=t(this),o=s.data("spinner"),r="object"==typeof e&&e;o||s.data("spinner",o=new i(this,r)),"string"==typeof e&&(a=o[e](n))});return void 0===a?s:a},t.fn.spinner.defaults={value:1,min:1,max:999,step:1,hold:!0,speed:"medium",disabled:!1},t.fn.spinner.Constructor=i,t(function(){t("body").on("mousedown.spinner.data-api",".spinner",function(){var e=t(this);e.data("spinner")||e.spinner(e.data())})})}),define("widgets",["jquery","bootstrap","libs/spinner"],function(e){var t={};return t.create_dialog=function(t,i,n,a,s){var o,r,l=e("#"+t),c=l.find(".modal-content"),u=e('<div class="modal-footer"></div>'),d=e('<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button></div>');d.append(e('<h4 class="modal-title"></h4>').html(i)),c.prepend(d),a&&(o=e('<a href="#" class="btn"></a>').text(a),"OK"===a&&(r="OK",o.addClass("btn-primary")),o.on("click",s),u.append(o)),o=e('<a href="#" class="btn" data-dismiss="modal"></a>').text(n),r?o.addClass("btn-default"):o.addClass("btn-primary"),u.append(o),c.append(u),l.modal({show:!1})},t.create_spinner=function(t,i){var n,a='<div class="spinner-buttons btn-group-vertical"></div>',s='<button class="btn btn-default spinner-up"><i class="glyphicon glyphicon-chevron-up"></i></button>',o='<button class="btn btn-default spinner-down"><i class="glyphicon glyphicon-chevron-down"></i></button>',r=e(t),l='<input type="text" class="form-control input-mini spinner-input" />';r.each(function(t,r){r=e(r),r.append(e(l)),n=e(a),n.append(e(s)),n.append(e(o)),r.append(n),r.spinner(i)})},t}),define("martial_knowledge",["jquery","character","classes","ki_abilities","martial_arts"],function(e,t,i,n,a){t.prototype.add_dominion_technique=function(e,t,i,n,a){var s={Name:t,Level:i,MK:n},o=0===a?0:a-1,r=this.levels[o],l=r.MK,c=this.mk_remaining()[o];n>c+50||"Insufficient Martial Knowledge"in this||(l||(l={},r.MK=l),e in l||(l[e]=[]),l[e].push(s),n>c&&(this["Insufficient Martial Knowledge"]={Tree:e,Name:t,Penalty:-Math.floor((n-c)/10)}))},t.prototype.add_ki_ability=function(e,t,i){var a=0===t?0:t-1,s=n[e],o=s.MK,r=this.levels[a],l=r.MK,c=this.mk_remaining()[a];this.has_ki_ability(e,i)||o>c+50||"Insufficient Martial Knowledge"in this||(l||(l={},r.MK=l),e in l?(l[e].MK+=s.MK,l[e].Options.push(i),l[e].Options.sort()):l[e]=s.Option_Title?{MK:s.MK,Options:[i]}:s.MK,o>c&&(this["Insufficient Martial Knowledge"]={Name:e,Penalty:-Math.floor((o-c)/10)},s.Option_Title&&(this["Insufficient Martial Knowledge"].Option=i)))},t.prototype.dominion_techniques=function(){var e,t,i,a,s,o,r,l,c,u=this["Insufficient Martial Knowledge"],d=this.levels,p=d.length,h={};u&&"Tree"in u&&(t=u.Name,i=u.Tree,o=t+" (POW "+u.Penalty+" check to use)",h[i]=[o]);for(e=0;p>e;e++)if(s=d[e].MK)for(o in s)if(s.hasOwnProperty(o)&&!(o in n)){o in h||(h[o]=[]),l=s[o],c=l.length;for(a=0;c>a;a++)r=l[a],(o!==i||r!==t)&&h[o].push(r)}for(o in h)h.hasOwnProperty(o)&&h[o].sort();return h},t.prototype.has_ki_ability=function(t,i,a){var s,o,r=this.levels,l=r.length;if(a!==void 0&&(l=0===a?1:a),"Ki Concealment"===t&&"D'Anjayni Nephilim"===this.Race)return!0;for(o=0;l>o;o++)if(s=r[o].MK,s&&t in s){if(!n[t].Option_Title)return!0;if(e.inArray(i,s[t].Options)>=0)return!0}return!1},t.prototype.ki_abilities=function(){var e,t,i,a,s,o={},r=this["Insufficient Martial Knowledge"],l=this.levels,c=l.length,u=[];!r||"Tree"in r||(i=r.Name,e=i+" (","Option"in r&&(e+=r.Option+", "),e+="POW "+r.Penalty+" check to use)",u.push(e));for(t=0;c>t;t++)if(a=l[t].MK)for(s in a)if(a.hasOwnProperty(s)){if(!(s in n))continue;n[s].Option_Title?o[s]=s in o?o[s].concat(a[s].Options):a[s].Options:s!==i&&u.push(s)}for(s in o)o.hasOwnProperty(s)&&u.push(s+"("+o[s].join(", ")+")");return"D'Anjayni Nephilim"===this.Race&&u.push("Ki Concealment"),u.sort(),u},t.prototype.ki_accumulation=function(e){var t,i,n,a=this.levels,s=a.length,o=this.characteristic(e),r=1;for(o>=16?r=4:o>=13?r=3:o>=10&&(r=2),i=0;s>i;i++)t=a[i].DP,n=t["Accumulation Multiple"],n&&(n=n[e],n&&(r+=n));return r},t.prototype.ki_concealment=function(){var e,t,n,a=this.ability("Hide"),s="Imperceptible Ki"in this.Advantages,o=this.level(),r=this.levels,l=r.length,c=this.mk_totals()[l-1],u=Math.floor((c+a)/2);for(n=0;l>n;n++)t=i[r[n].Class],e=t.bonuses["Ki Concealment"],e&&(u+=0===o?Math.floor(e/2):e),s&&(u+=10);return"D'Anjayni Nephilim"===this.Race&&(u+=30),u},t.prototype.ki_detection=function(){var e="Ki Perception"in this.Advantages,t=this.levels.length,i=this.mk_totals()[t-1],n=this.ability("Notice"),a=Math.floor((i+n)/2);return e&&(a+=10*t),a},t.prototype.ki_points=function(e){var t,i,n,a=this.levels,s=a.length,o=this.characteristic(e);for(o>10&&(o+=o-10),i=0;s>i;i++)t=a[i].DP,n=t.Ki,n&&(n=n[e],n&&(o+=n));return o},t.prototype.mk_remaining=function(){var e,t,i=0===this.level(),n=[],a=this.mk_totals(),s=a.length,o=a[s-1];for(t=s-1;t>=0;t--)e=a[t]-this.mk_used(i?0:t+1),o>e&&(o=e),n[t]=Math.max(Math.min(e,o),0);return n},t.prototype.mk_totals=function(e){var t,n,s,o,r,l,c,u,d=this.levels,p=d.length,h=this.Advantages["Martial Mastery"],f=[],m=0;for(e!==void 0?p=0===e?1:e:e=this.level(),h&&(m+=40*h),o=0;p>o;o++){c=d[o],u=i[c.Class].MK,m+=0===e?u/2:u,s=c.DP;for(r in s)if(s.hasOwnProperty(r))if("Martial Knowledge"===r)m+=5*c.DP["Martial Knowledge"];else if(r in a)for(n=s[r],t=n.length,l=0;t>l;l++)u=a[r][n[l]].MK,u&&(m+=u);f.push(m)}return f},t.prototype.mk_used=function(e){var t,i,n,a,s,o,r=this.levels,l=r.length,c=0;for(e!==void 0&&(l=0===e?1:e),t=0;l>t;t++)if(a=r[t].MK)for(n in a)if(a.hasOwnProperty(n))if(o=a[n],"number"==typeof o)c+=o;else if(o.Options)c+=o.MK*o.Options.length;else for(s=o.length,i=0;s>i;i++)c+=o[i].MK;return c},t.prototype.remove_dominion_technique=function(e,t,i){var n,a,s,o=this["Insufficient Martial Knowledge"],r=0===i?0:i-1,l=this.levels[r].MK;if(1===l[e].length)delete l[e];else for(s=l[e],n=s.length,a=0;n>a;a++)if(s[a].Name===t){s.splice(a,1);break}o&&(o.Tree===e&&o.Name===t?delete this["Insufficient Martial Knowledge"]:this.update_level())},t.prototype.remove_ki_ability=function(t,i,a){var s,o=this["Insufficient Martial Knowledge"],r=0===i?0:i-1,l=n[t],c=this.levels[r].MK;l.Option_Title&&1!==c[t].Options.length?(s=c[t].Options,s.splice(e.inArray(a,s),1)):delete c[t],o&&(o.Name!==t||o.Tree?this.update_level():delete this["Insufficient Martial Knowledge"])},t.prototype.update_level=function(){for(var e,t,i,n,a,s,o,r=this.level(),l=0,c=this["Insufficient Martial Knowledge"],u=this.levels,d=u.length;d>r&&d>1;)u.pop(),d--;for(;r>d;)u.push({Class:u[d-1].Class,DP:{}}),d++;if(s=this.mk_totals()[d-1]-this.mk_used(),s>=0&&c)delete this["Insufficient Martial Knowledge"];else if(0>s){if(c){if(this.has_ki_ability(c.Name,c.Option))return c.Penalty=Math.floor(s/10),void 0;delete this["Insufficient Martial Knowledge"],c=void 0}for(i=u.length-1;i>=0;i--){a=u[i].MK;for(t in a)if(a.hasOwnProperty(t))if(o=a[t],"number"==typeof o)o>l&&(c={Name:t},l=o);else if(o.MK)o.MK>l&&(e=o.Options.length,c={Name:t,Option:o.Options[e-1]},l=o.MK);else for(e=o.length,n=0;e>n;n++)o[n].MK>l&&(c={Tree:t,Name:o[n].Name},l=o[n].MK);if(c){c.Penalty=-Math.floor((l-s)/10),this["Insufficient Martial Knowledge"]=c;break}}}}}),define("armor",["character","martial_knowledge"],function(e){e.prototype.armor_type=function(e){var t=this.Advantages,i=0;return this["Damage Resistance"]&&(i=this.damage_resistance_armor_type()),"Energy"===e?("Mystical Armor"in t&&(i+=2),this.has_ki_ability("Armor of Arcane Energy")?i+=6:this.has_ki_ability("Armor of Greater Energy")?i+=4:this.has_ki_ability("Energy Armor")&&(i+=2)):"Natural Armor"in t&&(i+=2),i},e.prototype.damage_reduction=function(){var e=0;return this.has_ki_ability("Noht")?-30:this.has_ki_ability("Armor of Emptiness")?-10:e},e.prototype.damage_barrier=function(){var e=0;return this.has_ki_ability("Physical Shield")&&(e=this.presence()),e},e.prototype.damage_resistance_armor_type=function(){var e=this.size();return 4>e?1:9>e?2:23>e?3:25>e?4:29>e?6:34>e?8:10}}),define("advantages",["jquery","abilities","magic_paths","psychic_disciplines","tables"],function(e,t,i,n,a){return{"Access to Natural Psychic Powers":{Cost:[1,2,3],Options:[],Option_Title:"Select a Power"},"Access to One Psychic Discipline":{Cost:1,Options:Object.keys(n.disciplines),Option_Title:"Select a discipline"},"Acute Senses":{Cost:1},"Add One Point to a Characteristic":{Cost:1,Options:a.characteristics,Option_Title:"Select the characteristic to increase"},Ambidextrous:{Cost:1},"Amplify Sustained Power":{Category:"Psychic",Cost:2},"Animal Affinity":{Cost:1},"Aptitude in a Field":{Cost:2,Options:a.fields,Option_Title:"Select a field"},"Aptitude in a Subject":{Cost:[1,2],Options:e.map(Object.keys(t),function(e){return"Field"in t[e]?e:null}),Option_Title:"Select a subject"},"Aptitude for Magic Development":{Category:"Magic",Cost:1},Artifact:{Category:"Background",Cost:[1,2,3],Options:[],Option_Title:"Enter the name of the artifact"},"Artifact Affinity":{Cost:1},"Been Around":{Category:"Background",Cost:[1,2,3]},"Born Wizard":{Category:"Magic",Cost:1},Charm:{Cost:1},"Combat Senses":{Cost:3,Options:a.primary_combat_abilities,Option_Title:"Select an ability"},Contacts:{Category:"Background",Cost:[1,2,3],Options:[],Option_Title:"Enter name of organization"},"Contested Spell Mastery":{Category:"Magic",Cost:1},"Cultural Roots":{Category:"Background",Cost:1,Options:[],Option_Title:"Select a background"},"Danger Sense":{Cost:2},Disquieting:{Cost:1},"Dual Limit":{Cost:1},Elan:{Cost:[1,2,3],Options:[],Option_Title:"Enter the name of the Beryl or Shajad"},"Elemental Compatibility":{Category:"Magic",Cost:1,Options:Object.keys(i),Option_Title:"Select a path"},"Exceptional Magic Resistance":{Cost:[1,2]},"Exceptional Physical Resistance":{Cost:[1,2]},"Exceptional Psychic Resistance":{Cost:[1,2]},"Extreme Concentration":{Category:"Psychic",Cost:2},Fame:{Category:"Background",Cost:[1,2]},Familiar:{Cost:[2,3]},Focus:{Category:"Psychic",Cost:1},Fortunate:{Cost:1},"Free Access to Any Psychic Discipline":{Cost:2},"Free Will":{Cost:1},"Good Luck":{Cost:1},"Gradual Magic Learning":{Category:"Magic",Cost:2},"Half-Attuned to the Tree":{Category:"Magic",Cost:2},"Hard to Kill":{Cost:[1,2,3]},"Immunity to Pain and Fatigue":{Cost:1},"Imperceptible Ki":{Cost:1},"Improved Innate Spell":{Category:"Magic",Cost:[1,2,3]},"Incomplete Gift":{Cost:1,Options:a.theorems,Option_Title:"Select the Theorem used"},"Increased Ki Accumulation":{Cost:[1,2]},"Increased Natural Bonus":{Cost:2},"Increased Psychic Modifiers":{Category:"Psychic",Cost:1},"Increase One Characteristic to Nine":{Cost:2,Options:a.characteristics,Option_Title:"Select the characteristic to increase"},"Jack of All Trades":{Cost:2},"Ki Perception":{Cost:1},"Ki Recovery":{Cost:[1,2,3]},"Light Sleeper":{Cost:1},Learning:{Cost:[1,2,3]},"Magic Nature":{Category:"Magic",Cost:[1,2,3]},"Magical Diction":{Category:"Magic",Cost:1},"Martial Learning":{Cost:1},"Martial Mastery":{Cost:[1,2,3]},"Mass Summoner":{Cost:[1,2,3]},"Masterful Seals":{Cost:1},"Mystical Armor":{Cost:1},"Natural Armor":{Cost:1},"Natural Knowledge of a Path":{Category:"Magic",Cost:1,Options:Object.keys(i),Option_Title:"Select a path"},"Natural Learner":{Cost:[1,2,3],Options:e.map(Object.keys(t),function(e){return"Field"in t[e]?e:null
}),Option_Title:"Select an ability"},"Natural Learner, Field":{Cost:[2,3],Options:a.fields,Option_Title:"Select a field"},"Natural Power":{Category:"Magic",Cost:1},"Night Vision":{Cost:1},"No Gestures":{Cost:1},"Opposite Magic":{Category:"Magic",Cost:1},"Passive Concentration":{Category:"Psychic",Cost:2},"Powerful Ally":{Category:"Background",Cost:[1,2,3],Options:[],Option_Title:"Enter powerful ally"},"Psychic Ambivalence":{Category:"Psychic",Cost:1},"Psychic Fatigue Resistance":{Category:"Psychic",Cost:2},"Psychic Immunity":{Cost:1},"Psychic Inclination":{Category:"Psychic",Cost:2,Options:Object.keys(n.disciplines),Option_Title:"Select a discipline"},"Psychic Point Recovery":{Category:"Psychic",Cost:[1,2,3]},"Quick Reflexes":{Cost:[1,2,3]},Regeneration:{Cost:[1,2,3]},"Repeat a Characteristics Roll":{Cost:1,Options:a.characteristics,Option_Title:"Select the characteristic to reroll"},Saint:{Category:"Background",Cost:2},Seducer:{Cost:1},"See Supernatural":{Cost:1},"Sheele Essence":{Cost:1},"Social Position":{Category:"Background",Cost:[1,2]},"Starting Wealth":{Category:"Background",Cost:[1,2,3]},"Superior Magic Recovery":{Category:"Magic",Cost:[1,2,3]},"Supernatural Immunity":{Cost:[1,2,3]},Survivor:{Cost:1},Talented:{Cost:1},"To the Limit":{Cost:1},"Touched by Destiny":{Cost:1},"Total Accumulation":{Cost:2},"The Gift":{Cost:2,Options:a.theorems,Option_Title:"Select the Theorem used"},"Uncommon Size":{Cost:1,Options:[-5,-4,-3,-2,-1,1,2,3,4,5],Option_Title:"Select the size modifier to apply"},"Unconnected Techniques":{Cost:1},"Unlimited Familiars":{Cost:2},"Unspoken Casting":{Category:"Magic",Cost:1},Untiring:{Cost:[1,2,3]},"Usage Affinity":{Cost:1},"Use of Armor":{Cost:[1,2,3]},Versatile:{Cost:1},"Versatile Metamagic":{Category:"Magic",Cost:1}}}),define("disadvantages",["tables"],function(e){return{"Action Requirement":{Category:"Magic",Benefit:1,Options:[],Option_Title:"Enter the type of action required"},"Addiction or Serious Vice":{Benefit:1,Options:[],Option_Title:"Enter an addiction or serious vice"},"Atrophied Limb":{Benefit:1,Options:["Left leg","Right leg","Left arm","Right arm"],Option_Title:"Select a limb"},"Bad Luck":{Benefit:1},Blind:{Benefit:2},"Code of Conduct":{Category:"Background",Benefit:1},Cowardice:{Benefit:1},Damned:{Benefit:[1,2],Options:[],Option_Title:"Describe the effect"},Deafness:{Benefit:1},Debts:{Category:"Background",Benefit:1},"Deduct Two Points from a Characteristic":{Benefit:1,Options:e.characteristics,Option_Title:"Select the characteristic to deduct from"},"Deep Sleeper":{Benefit:1},"Dirty Little Secret":{Category:"Background",Benefit:1},"Easily Possessed":{Benefit:1},"Exclusive Weapon":{Benefit:1,Options:[],Option_Title:"Which weapon?"},Exhausted:{Benefit:1},Feeble:{Benefit:1},Insufferable:{Benefit:1},Klutzy:{Benefit:1},Nearsighted:{Benefit:1},"Magical Blockage":{Category:"Magic",Benefit:2},"Magical Exhaustion":{Category:"Magic",Benefit:1},"Magical Ties":{Category:"Magic",Benefit:1},Mute:{Benefit:1},"No Concentration":{Category:"Psychic",Benefit:1},"One Power at a Time":{Category:"Psychic",Benefit:1},"Oral Requirement":{Category:"Magic",Benefit:1},Pariah:{Category:"Background",Benefit:1},"Physical Weakness":{Benefit:1},"Powerful Enemy":{Category:"Background",Benefit:[1,2],Options:[],Option_Title:"Enter powerful enemy"},"Psychic Consumption":{Category:"Psychic",Benefit:2},"Psychic Exhaustion":{Category:"Psychic",Benefit:1},"Require Gestures":{Category:"Magic",Benefit:1},Rookie:{Benefit:1},"Serious Illness":{Benefit:2,Options:[],Option_Title:"Describe the illness"},"Severe Allergy":{Benefit:1,Options:[],Option_Title:"Describe the allergy"},"Severe Phobia":{Benefit:1,Options:[],Option_Title:"Describe the phobia"},Shamanism:{Category:"Magic",Benefit:2},Sickly:{Benefit:1},"Slow Healer":{Benefit:1},"Slow Learner":{Benefit:[1,2]},"Slow Reactions":{Benefit:[1,2]},"Slow Recovery of Magic":{Category:"Magic",Benefit:1},"Susceptible to Magic":{Benefit:1},"Susceptible to Poisons":{Benefit:1},Unattractive:{Benefit:1},Unfortunate:{Benefit:1},"Unlucky Destiny":{Benefit:2},"Vulnerable to Heat/Cold":{Benefit:1,Options:["Heat","Cold"],Option_Title:"Select a vulnerability"},"Vulnerable to Pain":{Benefit:1},"Without any Natural Bonus":{Benefit:1}}}),define("creation_points",["jquery","advantages","character","classes","disadvantages","tables","libs/utils"],function(e,t,i,n,a,s,o){return i.prototype.add_advantage=function(i,n,a){var s,o=this.Advantages;"Access to Natural Psychic Powers"===i?o[i]={Points:n,Power:a}:e.inArray(i,["Aptitude in a Subject","Natural Learner"])>=0?o[i]={Points:n,Ability:a}:"Cultural Roots"===i?o[i]=0===a.Choices.length?a.Background:a:"Natural Learner, Field"===i?o[i]={Points:n,Field:a}:e.inArray(i,["Add One Point to a Characteristic","Increase One Characteristic to Nine","Repeat a Characteristics Roll"])>=0?(i in o||(o[i]=[]),o[i].push(a)):e.inArray(i,["Artifact","Contacts","Elan","Powerful Ally"])>=0?o[i]={Points:n,Name:a}:"Uncommon Size"===i?o[i]=parseInt(a,10):(s=t[i],e.isArray(s.Cost)?o[i]=n:"Options"in s?s.Multiple?i in o?o[i].push(a):o[i]=[a]:o[i]=a:o[i]=s.Cost),"Been Around"===i&&(this.XP=50*n)},i.prototype.add_disadvantage=function(t,i,n){var s=a[t],o=this.Disadvantages;o[t]="Damned"===t?{Points:i,Effect:n}:"Powerful Enemy"===t?{Points:i,Name:n}:e.isArray(s.Benefit)?i:"Options"in s?n:s.Benefit,"Without any Natural Bonus"===t?e.each(this.levels,function(e,t){"Natural Bonus"in t&&delete t["Natural Bonus"]}):"Rookie"===t&&(this.XP-=100)},i.prototype.advantage_allowed=function(i,n){var a,s=t[i],o=!0,r=this.cp_remaining("Common"),l=s.Cost,c=this.Advantages,u=this.Disadvantages,d=this.Race;if("Category"in s&&(r+=this.cp_remaining(s.Category)),e.isArray(l)){if(l[0]>r)return!1}else if(l>r)return!1;if("Access to One Psychic Discipline"===i&&n){if("Duk'zarist Nephilim"===d&&"Pyrokinesis"!==n)return!1}else if("Elemental Compatibility"===i&&n){if("Duk'zarist Nephilim"===d&&"Light"===n)return!1;if("Sylvain Nephilim"===d&&"Darkness"===n)return!1}else if("Psychic Immunity"===i){if("Addiction"in u||"Serious Vice"in u||"Cowardice"in u||"Severe Phobia"in u)return!1}else if("Psychic Inclination"===i&&n){if(-1===e.inArray(n,this.discipline_access()))return!1}else if("Supernatural Immunity"===i){if(this.has_gift()||"See Supernatural"in c)return!1;if(e.each(["Sylvain","Duk'zarist","Daimah"],function(e,t){return-1!==d.indexOf(t)?(o=!1,!1):void 0}),!o)return!1}else{if(-1!==e.inArray(i,["The Gift","Incomplete Gift","See Supernatural"])&&"Supernatural Immunity"in c)return!1;if("Uncommon Size"===i&&"Jayan Nephilim"===d&&n&&1>n)return!1}if("Category"in s){if("Magic"===s.Category&&!this.has_gift())return!1;if(!("Psychic"!==s.Category||"Free Access to Any Psychic Discipline"in c||"Access to One Psychic Discipline"in c))return!1}return"Add One Point to a Characteristic"===i?n?(a=this.characteristic(n),a>13?!1:a>11&&-1!==e.inArray(n,["STR","DEX","AGI","CON"])?!1:!0):!0:-1!==e.inArray(i,["Increase One Characteristic to Nine","Repeat a Characteristics Roll"])?!0:i in c?!1:!0},i.prototype.advantage_cost=function(i){var n=this.Advantages[i];return e.isPlainObject(n)&&"Points"in n?n.Points:e.isArray(n)?t[i].Cost*n.length:"Uncommon Size"===i?1:isNaN(parseInt(n,10))?t[i].Cost:parseInt(n,10)},i.prototype.advantage_summary=function(i){var n=t[i],a=this.Advantages[i],s=i;return"Repeat a Characteristics Roll"===i?(s+=": ",e.each(a,function(e,t){e>0&&(s+=", "),s+=t.Characteristic+" ("+t.Roll+")"}),s):(e.isArray(n.Cost)&&(s+=" ("+this.advantage_cost(i)+")"),"Options"in n&&(s+=": ","Access to Natural Psychic Powers"===i?s+=a.Power:"Aptitude in a Subject"===i?s+=a.Ability:-1!==e.inArray(i,["Artifact","Contacts","Elan","Powerful Ally"])?s+=a.Name:"Cultural Roots"===i?s+=e.isPlainObject(a)?a.Background:a:"Natural Learner"===i?s+=a.Ability:"Natural Learner, Field"===i?s+=a.Field:e.isArray(a)?e.each(a,function(e,t){e>0&&(s+=", "),s+=t}):s+=a),s)},i.prototype.cp_remaining=function(e){var i,n,s,o,r=this.Advantages,l=this.Disadvantages,c={Background:0,Magic:0,Psychic:0},u=e&&"Common"!==e?0:3;for(o in l)l.hasOwnProperty(o)&&(n=this.disadvantage_benefit(o),e?(s=a[o],"Category"in s?s.Category===e?u+=n:"Common"===e&&(c[s.Category]+=n):"Common"===e&&(u+=n)):u+=n);for(o in r)if(r.hasOwnProperty(o))if(n=this.advantage_cost(o),e)if(i=t[o],"Category"in i){if(i.Category===e)u-=n;else if("Common"===e){for(;n>0&&c[i.Category]>0;)n--,c[i.Category]--;u-=n}}else"Common"===e&&(u-=n);else u-=n;return 0>u&&(u=0),u},i.prototype.cp_total=function(){var e,t=this.Disadvantages,i=3;for(e in t)t.hasOwnProperty(e)&&(i+=this.disadvantage_benefit(e));return i},i.prototype.disadvantage_allowed=function(t,i){var r,l,c=!1,u=this,d=this.Advantages,p=this.Disadvantages,h=this.Race;if(t in p)return!1;if(Object.keys(p).length>2)return!1;if("Deduct Two Points from a Characteristic"===t){if(!i)return e.each(s.characteristics,function(e,t){return u.characteristic(t)>4?(c=!0,!1):void 0}),c;if(5>this.characteristic(i))return!1;if("Jayan Nephilim"===h&&"STR"===i)return!1}else if("Exclusive Weapon"===t){if(l=["Domine","Fighter","Novel","Prowler"],1>o.intersection(l,n[this.levels[0].Class].Archetypes))return!1}else{if("Slow Recovery of Magic"===t&&"Magic Blockage"in p)return!1;if("Magic Blockage"===t&&"Slow Recovery of Magic"in p)return!1;if("Unattractive"===t&&7>this.characteristic("Appearance"))return!1;if(-1!==e.inArray(t,["Addiction","Serious Vice","Cowardice","Severe Phobia"])&&"Psychic Immunity"in d)return!1}if(r=a[t],"Category"in r){if("Magic"===r.Category&&!this.has_gift())return!1;if(!("Psychic"!==r.Category||"Free Access to Any Psychic Discipline"in d||"Access to One Psychic Discipline"in d))return!1}if("Duk'zarist Nephilim"===h){if(-1!==e.inArray(t,["Atrophied Limb","Blind","Deafness","Mute","Nearsighted","Physical Weakness","Serious Illness","Sickly","Susceptible to Poisons"]))return!1}else if("Sylvain Nephilim"===h&&-1!==e.inArray(t,["Sickly","Serious Illness","Susceptible to Magic"]))return!1;return!0},i.prototype.disadvantage_benefit=function(t){var i=this.Disadvantages[t];return e.isPlainObject(i)&&"Points"in i?i.Points:isNaN(parseInt(i,10))?a[t].Benefit:parseInt(i,10)},i.prototype.disadvantage_summary=function(t){var i=a[t],n=this.Disadvantages[t],s=t;return e.isArray(i.Benefit)&&(s+=" ("+this.disadvantage_benefit(t)+")"),"Options"in i&&(s+=": ",s+="Damned"===t?n.Effect:"Powerful Enemy"===t?n.Name:n),s},{}}),define("powers",[],function(){return{"Natural Weapons":{Category:"Offensive Abilities",Options:[{Effect:"Natural Weapons",DP:20,Gnosis:0}]},"Additional Attacks":{Category:"Offensive Abilities",Attack_Linked:!0,Repeatable:!0,Options:[{Description:"Additional attack with -60 to its final Attack",DP:20,Gnosis:0},{Description:"Additional attack with -50 to its final Attack",DP:30,Gnosis:0},{Description:"Additional attack with -40 to its final Attack",DP:40,Gnosis:0},{Description:"Additional attack with -30 to its final Attack",DP:50,Gnosis:5},{Description:"Additional attack with -20 to its final Attack",DP:60,Gnosis:5},{Description:"Additional attack with -10 to its final Attack",DP:80,Gnosis:10},{Description:"Complete additional attack",DP:100,Gnosis:15}]},"Increased Damage":{Category:"Offensive Abilities",Attack_Linked:!0,Options:[{Description:"+10 to damage",DP:10,Gnosis:0},{Description:"+20 to damage",DP:20,Gnosis:0},{Description:"+30 to damage",DP:30,Gnosis:0},{Description:"+40 to damage",DP:40,Gnosis:0},{Description:"+50 to damage",DP:50,Gnosis:5},{Description:"+60 to damage",DP:60,Gnosis:10},{Description:"+80 to damage",DP:80,Gnosis:20},{Description:"+100 to damage",DP:100,Gnosis:25},{Description:"+120 to damage",DP:120,Gnosis:30}]},"Increased Reaction":{Category:"Offensive Abilities",Options:[{Description:"+10 to the natural Initiative",DP:10,Gnosis:0},{Description:"+20 to the natural Initiative",DP:20,Gnosis:10},{Description:"+30 to the natural Initiative",DP:30,Gnosis:20}]},"Damage Energy":{Category:"Offensive Abilities",Options:[{Description:"Damage energy",DP:10,Gnosis:10}]},"Armor Modifier":{Category:"Offensive Abilities",Attack_Linked:!0,Options:[{Description:"-1 to the defender's AT",DP:10,Gnosis:0},{Description:"-2 to the defender's AT",DP:15,Gnosis:10},{Description:"-3 to the defender's AT",DP:20,Gnosis:15},{Description:"-4 to the defender's AT",DP:25,Gnosis:20},{Description:"-5 to the defender's AT",DP:30,Gnosis:25}]},"Special Attack":{Category:"Offensive Abilities",Repeatable:!0,Options:{Distance:[{Description:"Up to a distance of 80 feet",DP:10,Gnosis:5},{Description:"Up to a distance of 150 feet",DP:20,Gnosis:10},{Description:"Up to a distance of 300 feet",DP:30,Gnosis:15},{Description:"Up to a distance of 800 feet",DP:40,Gnosis:20},{Description:"Up to a distance of 1,500 feet",DP:50,Gnosis:25},{Description:"Up to a distance of one mile",DP:60,Gnosis:30},{Description:"Up to a distance of five miles",DP:70,Gnosis:35},{Description:"Up to any visible distance",DP:80,Gnosis:40}],Damage:[{Description:"Base damage 40",Cost:10,Gnosis:5},{Description:"Base damage 50",Cost:15,Gnosis:10},{Description:"Base damage 60",Cost:20,Gnosis:10},{Description:"Base damage 80",Cost:25,Gnosis:10},{Description:"Base damage 100",Cost:30,Gnosis:15},{Description:"Base damage 120",Cost:50,Gnosis:20},{Description:"Base damage 150",Cost:60,Gnosis:20},{Description:"Base damage 200",Cost:80,Gnosis:25},{Description:"Base damage 250",Cost:100,Gnosis:30}],Area:[{Description:"None (target only)",Cost:0,Gnosis:0},{Description:"5-foot radius",Cost:10,Gnosis:10},{Description:"10-foot radius",Cost:20,Gnosis:10},{Description:"15-foot radius",Cost:30,Gnosis:15},{Description:"30-foot radius",Cost:40,Gnosis:20},{Description:"80-foot radius",Cost:50,Gnosis:25},{Description:"150-foot radius",Cost:60,Gnosis:30},{Description:"300-foot radius",Cost:80,Gnosis:35}],"An Additional Attack":{DP:5,Gnosis:10,Repeatable:!0},"Without limits":{DP:60,Gnosis:20}},Penalties:[{Description:"Requires one turn to prepare",DP:-10,Gnosis:5},{Description:"Requires 2 turns to prepare",DP:-20,Gnosis:5},{Description:"Requires 3 turns to prepare",DP:-30,Gnosis:5},{Description:"Requires 5 turns to prepare",DP:-40,Gnosis:5},{Description:"Requires 10 turns to prepare",DP:-50,Gnosis:5}]},"Poisoned Attack":{Category:"Offensive Abilities",Attack_Linked:!0,Options:[{Description:"Poison level 10",DP:10,Gnosis:0},{Description:"Poison level 20",DP:20,Gnosis:0},{Description:"Poison level 30",DP:30,Gnosis:0},{Description:"Poison level 40",DP:40,Gnosis:0},{Description:"Poison level 50",DP:50,Gnosis:0},{Description:"Poison level 60",DP:60,Gnosis:0},{Description:"Poison level 70",DP:80,Gnosis:0},{Description:"Poison level 80",DP:100,Gnosis:10},{Description:"Poison level 90",DP:140,Gnosis:20},{Description:"Poison level 100",DP:180,Gnosis:30}]},"Added Mystical Effect":{Category:"Offensive Abilities",Attack_Linked:!0,Options:{Resistance:[{Description:"MR or PhR 40",DP:20,Gnosis:5},{Description:"MR or PhR 60",DP:30,Gnosis:10},{Description:"MR or PhR 80",DP:40,Gnosis:15},{Description:"MR or PhR 100",DP:50,Gnosis:15},{Description:"MR or PhR 120",DP:60,Gnosis:20},{Description:"MR or PhR 140",DP:80,Gnosis:25},{Description:"MR or PhR 160",DP:100,Gnosis:30},{Description:"MR or PhR 180",DP:120,Gnosis:35},{Description:"MR or PhR 200",DP:140,Gnosis:40}],Effect:[{Description:"Fear",DP:20,Gnosis:10},{Description:"Terror",DP:60,Gnosis:20},{Description:"Pain",DP:20,Gnosis:10},{Description:"Extreme pain",DP:40,Gnosis:20},{Description:"Weakness",DP:50,Gnosis:10},{Description:"Partial paralysis",DP:40,Gnosis:20},{Description:"Total paralysis",DP:80,Gnosis:20},{Description:"Rage",DP:20,Gnosis:20},{Description:"Blindness",DP:50,Gnosis:10},{Description:"Deafness",DP:10,Gnosis:10},{Description:"Mute",DP:10,Gnosis:10},{Description:"Fascination",DP:20,Gnosis:20},{Description:"Simple damage",DP:30,Gnosis:10},{Description:"Double damage",DP:60,Gnosis:20},{Description:"Unconsciousness",DP:100,Gnosis:20},{Description:"Dominate",DP:120,Gnosis:25},{Description:"Death",DP:140,Gnosis:25},{Description:"Madness",DP:20,Gnosis:20},{Description:"Age",DP:60,Gnosis:20},{Description:"All Action Penalty",DP:60,Gnosis:20},{Description:"Destroy characteristics",DP:120,Gnosis:20},{Description:"Possession",DP:120,Gnosis:25},{Description:"Drain (Half)",DP:20,Gnosis:10},{Description:"Drain (Complete)",DP:50,Gnosis:15},{Description:"Drain (Double)",DP:100,Gnosis:20}],"Additional effect":{DP:10,Gnosis:10,Repeatable:!0}},Penalties:{Description:"Conditional effect",DP:-20,Gnosis:10,Repeatable:!0}},"Increased Critical":{Category:"Offensive Abilities",Attack_Linked:!0,Options:[{Description:"+10 to critical",DP:10,Gnosis:0},{Description:"+20 to critical",DP:20,Gnosis:0},{Description:"+30 to critical",DP:30,Gnosis:0},{Description:"+40 to critical",DP:40,Gnosis:5},{Description:"+50 to critical",DP:50,Gnosis:5},{Description:"+60 to critical",DP:60,Gnosis:10},{Description:"+70 to critical",DP:70,Gnosis:20},{Description:"+80 to critical",DP:80,Gnosis:30},{Description:"+90 to critical",DP:90,Gnosis:30},{Description:"+100 to critical",DP:100,Gnosis:40}]},"Special Trapping":{Category:"Offensive Abilities",Options:[{Description:"Trapping 6",DP:10,Gnosis:0},{Description:"Trapping 8",DP:20,Gnosis:0},{Description:"Trapping 10",DP:30,Gnosis:0},{Description:"Trapping 12",DP:40,Gnosis:10},{Description:"Trapping 14",DP:60,Gnosis:20},{Description:"Trapping 16",DP:80,Gnosis:25}]},"Supernatural Attack":{Category:"Offensive Abilities",Options:[{Description:"Supernatural Attack",DP:60,Gnosis:20}]},"Elemental Attack":{Category:"Offensive Abilities",Options:[{Description:"Elemental Attack",DP:10,Gnosis:10}]},"Special Movement":{Category:"Movement & Transport",Repeatable:!0,Options:[{Description:"Aquatic movement",DP:20,Gnosis:0},{Description:"Free movement",DP:20,Gnosis:5},{Description:"Movement without weight",DP:10,Gnosis:15},{Description:"Subterranean movement",DP:10,Gnosis:0},{Description:"Superior Subterranean movement",DP:30,Gnosis:20},{Description:"Free movement through nature",DP:10,Gnosis:10}]},"Automatic Transport":{Category:"Movement & Transport",Options:{Distance:[{Description:"60 feet",DP:10,Gnosis:10},{Description:"150 feet",DP:20,Gnosis:10},{Description:"300 feet",DP:40,Gnosis:15},{Description:"800 feet",DP:60,Gnosis:15},{Description:"1,500 feet",DP:80,Gnosis:20},{Description:"1 mile",DP:100,Gnosis:20},{Description:"3 miles",DP:120,Gnosis:25},{Description:"15 miles",DP:140,Gnosis:30},{Description:"60 miles",DP:160,Gnosis:35}],Door:{DP:200,Gnosis:35},"An additional time":{DP:10,Gnosis:10,Repeatable:!0},"Unlimited amount of times":{DP:100,Gnosis:35}},Penalties:{Preparation:[{Description:"None needed",DP:0,Gnosis:0},{Description:"Requires a turn to prepare",DP:-10,Gnosis:10},{Description:"Requires 5 turns to prepare",DP:-30,Gnosis:10},{Description:"Requires 10 turns to prepare",DP:-50,Gnosis:10}],"Through a specific terrain or element":{DP:-30,Gnosis:10}}},"Increased Movement":{Category:"Movement & Transport",Options:[{Description:"Movement Value +1",DP:10,Gnosis:0},{Description:"Movement Value +2",DP:20,Gnosis:5},{Description:"Movement Value +3",DP:30,Gnosis:10},{Description:"Movement Value +4",DP:40,Gnosis:20}]},"Natural Flight Value":{Category:"Movement & Transport",Options:[{Description:"Natural flight 6",DP:40,Gnosis:0},{Description:"Natural flight 8",DP:60,Gnosis:0},{Description:"Natural flight 10",DP:80,Gnosis:0},{Description:"Natural flight 12",DP:100,Gnosis:0},{Description:"Natural flight 14",DP:120,Gnosis:10}]},"Mystical Flight Value":{Category:"Movement & Transport",Options:[{Description:"Mystical flight 4",DP:20,Gnosis:10},{Description:"Mystical flight 6",DP:40,Gnosis:15},{Description:"Mystical flight 8",DP:60,Gnosis:20},{Description:"Mystical flight 10",DP:80,Gnosis:20},{Description:"Mystical flight 12",DP:100,Gnosis:25},{Description:"Mystical flight 14",DP:120,Gnosis:30},{Description:"Mystical flight 16",DP:140,Gnosis:35}],Penalties:[{Description:"Conditional flight",DP:-20,Gnosis:10}]},"Increased Physical Resistance":{Category:"Resistances & Regeneration",Options:[{Description:"+10 to Resistances",DP:10,Gnosis:0},{Description:"+20 to Resistances",DP:20,Gnosis:0},{Description:"+30 to Resistances",DP:30,Gnosis:10},{Description:"+40 to Resistances",DP:40,Gnosis:20},{Description:"+50 to Resistances",DP:50,Gnosis:30}],Penalties:[{Description:"Only to one",DP:-20,Gnosis:10}]},"Mystical & Psychic Resistance":{Category:"Resistances & Regeneration",Repeatable:["MR","PsR"],Options:[{Description:"+10 to Supernatural resistance",DP:10,Gnosis:10},{Description:"+20 to Supernatural resistance",DP:20,Gnosis:15},{Description:"+30 to Supernatural resistance",DP:30,Gnosis:20},{Description:"+40 to Supernatural resistance",DP:40,Gnosis:25},{Description:"+50 to Supernatural resistance",DP:50,Gnosis:35}]},"Penalty to Mystic Resistance":{Category:"Resistances & Regeneration",Repeatable:["MR","PsR"],Options:[{Description:"-10 to Magic or psychic Resistance",DP:-10,Gnosis:10},{Description:"-20 to Magic or psychic Resistance",DP:-15,Gnosis:10},{Description:"-30 to Magic or psychic Resistance",DP:-20,Gnosis:10},{Description:"-40 to Magic or psychic Resistance",DP:-25,Gnosis:20},{Description:"-50 to Magic or psychic Resistance",DP:-30,Gnosis:20}]},Regeneration:{Category:"Resistances & Regeneration",Options:[{Description:"Regeneration 2",DP:10,Gnosis:0},{Description:"Regeneration 4",DP:20,Gnosis:0},{Description:"Regeneration 6",DP:30,Gnosis:0},{Description:"Regeneration 8",DP:40,Gnosis:5},{Description:"Regeneration 10",DP:60,Gnosis:10},{Description:"Regeneration 12",DP:100,Gnosis:15},{Description:"Regeneration 14",DP:140,Gnosis:20},{Description:"Regeneration 16",DP:160,Gnosis:25},{Description:"Regeneration 18",DP:180,Gnosis:35},{Description:"Regeneration 19",DP:200,Gnosis:45},{Description:"Regeneration 20",DP:220,Gnosis:50}],Penalties:[{Description:"It does not work against an attack or condition",DP:-10,Gnosis:0},{Description:"It only works under certain situations",DP:-40,Gnosis:10}]},Degeneration:{Category:"Resistances & Regeneration",Options:[{Description:"Regeneration Zero",DP:-30,Gnosis:10},{Description:"-10 Life points a day",DP:-40,Gnosis:10},{Description:"-25 Life points a day",DP:-45,Gnosis:10},{Description:"-50 Life points a day",DP:-50,Gnosis:10},{Description:"-100 Life points a day",DP:-60,Gnosis:10}]},"Physical Immunity":{Category:"Special Immunities",Options:[{Description:"With any presence",DP:40,Gnosis:15},{Description:"Presence less than 80",DP:60,Gnosis:20},{Description:"Presence less than 100",DP:80,Gnosis:20},{Description:"Presence less than 120",DP:100,Gnosis:25},{Description:"Presence less than 140",DP:140,Gnosis:30},{Description:"Presence less than 160",DP:180,Gnosis:35}],Penalties:[{Description:"Conditions",DP:-30,Gnosis:15}]},"Magical Immunity":{Category:"Special Immunities",Options:[{Description:"Zeonic value less than 60",DP:30,Gnosis:15},{Description:"Zeonic value less than 80",DP:40,Gnosis:15},{Description:"Zeonic value less than 100",DP:50,Gnosis:20},{Description:"Zeonic value less than 150",DP:75,Gnosis:20},{Description:"Zeonic value less than 200",DP:100,Gnosis:25},{Description:"Zeonic value less than 250",DP:125,Gnosis:30},{Description:"Zeonic value less than 300",DP:150,Gnosis:35}],Penalties:[{Description:"Conditions",DP:-30,Gnosis:15}]},"Immunity to Matrices":{Category:"Special Immunities",Options:[{Description:"Very Difficult Potential",DP:60,Gnosis:15},{Description:"Absurd Potential",DP:80,Gnosis:20},{Description:"Almost Impossible Potential",DP:120,Gnosis:25},{Description:"Impossible Potential",DP:140,Gnosis:30}],Penalties:[{Description:"Conditions",DP:-30,Gnosis:15}]},"Damage Barrier":{Category:"Special Immunities",Options:[{Description:"Damage barrier 40",DP:5,Gnosis:0},{Description:"Damage barrier 60",DP:10,Gnosis:0},{Description:"Damage barrier 80",DP:15,Gnosis:5},{Description:"Damage barrier 100",DP:20,Gnosis:5},{Description:"Damage barrier 120",DP:25,Gnosis:10},{Description:"Damage barrier 140",DP:30,Gnosis:10},{Description:"Damage barrier 160",DP:40,Gnosis:10}]},"Extreme Vulnerability":{Category:"Special Immunities",Repeatable:!0,Options:{"Vulnerable to":[{Description:"A specific element",DP:-20,Gnosis:15},{Description:"Against a specific object",DP:-10,Gnosis:15},{Description:"A word or sound",DP:-10,Gnosis:15},{Description:"A generic material",DP:-20,Gnosis:15},{Description:"A rare material",DP:-10,Gnosis:15},{Description:"A specific place",DP:-10,Gnosis:20},{Description:"A personal determined condition",DP:-10,Gnosis:25}],Consequences:[{Description:"Damage equal to the level of failure",DP:-10,Gnosis:20},{Description:"Penalty equal to the level of failure",DP:-10,Gnosis:20},{Description:"Unconsciousness",DP:-20,Gnosis:20},{Description:"Complete paralysis",DP:-15,Gnosis:20},{Description:"Weakness",DP:-10,Gnosis:20},{Description:"Death",DP:-30,Gnosis:20}],"Resistance to consequences":[{Description:"MR or PhR against 140",DP:-10,Gnosis:20},{Description:"MR or PhR against 160",DP:-15,Gnosis:20},{Description:"MR or PhR against 180",DP:-20,Gnosis:20},{Description:"MR or PhR against 200",DP:-25,Gnosis:20}]}},"Physical Armor":{Category:"Armor",Options:[{Description:"AT 1",DP:10,Gnosis:0},{Description:"AT 2",DP:20,Gnosis:0},{Description:"AT 3",DP:30,Gnosis:0},{Description:"AT 4",DP:40,Gnosis:5},{Description:"AT 5",DP:50,Gnosis:10},{Description:"AT 6",DP:60,Gnosis:15},{Description:"AT 7",DP:80,Gnosis:20},{Description:"AT 8",DP:100,Gnosis:25},{Description:"AT 9",DP:120,Gnosis:30},{Description:"AT 10",DP:140,Gnosis:35},{Description:"AT 12",DP:180,Gnosis:40}],Penalties:{Limited:{DP:-10,Gnosis:0},Open:{DP:-10,Gnosis:0}}},"Mystical Armor":{Category:"Armor",Options:[{Description:"AT 1",DP:10,Gnosis:5},{Description:"AT 2",DP:20,Gnosis:10},{Description:"AT 3",DP:30,Gnosis:15},{Description:"AT 4",DP:40,Gnosis:20},{Description:"AT 5",DP:50,Gnosis:25},{Description:"AT 6",DP:60,Gnosis:30},{Description:"AT 7",DP:70,Gnosis:35},{Description:"AT 8",DP:80,Gnosis:40}]},"Spiritual Abilities":{Category:"Souls",Options:{"Interaction with the world":{DP:30,Gnosis:30},Manifestation:{DP:20,Gnosis:20},Incarnation:{DP:60,Gnosis:30}}},"Elemental or Immaterial Form":{Category:"Innate Supernatural Abilities",Options:{Form:[{Description:"Immaterial Form",DP:80,Gnosis:20},{Description:"Elemental Form",DP:100,Gnosis:20},{Description:"Spectral Form",DP:100,Gnosis:20}],"Physical form at will":{DP:10,Gnosis:20}},Penalties:[{Description:"Conditioned",DP:-20,Gnosis:20}]},"Innate Magic":{Category:"Innate Supernatural Abilities",Repeatable:!0,Options:{"Innate spell":{DP:20,Gnosis:5},"An additional use":{DP:5,Gnosis:10},Unlimited:{DP:100,Gnosis:30}},Penalties:{Conditioned:{DP:-30,Gnosis:10},Preparation:[{Description:"None needed",DP:0,Gnosis:0},{Description:"Requires a full turn to prepare",DP:-10,Gnosis:10},{Description:"Requires 2 full turns to prepare",DP:-20,Gnosis:10},{Description:"Requires 3 full turns to prepare",DP:-30,Gnosis:10},{Description:"Requires 5 full turns to prepare",DP:-40,Gnosis:10},{Description:"Requires 10 full turns to prepare",DP:-50,Gnosis:10}]}},"Innate Psychic Abilities":{Category:"Innate Supernatural Abilities",Repeatable:!0,Options:{"Innate Power":{DP:20,Gnosis:5},"An additional use":{DP:5,Gnosis:10},Unlimited:{DP:80,Gnosis:25}},Penalties:{Conditioned:{DP:-30,Gnosis:10},Preparation:[{Description:"None needed",DP:0,Gnosis:0},{Description:"Requires a full turn to prepare",DP:-10,Gnosis:10},{Description:"Requires 2 full turns to prepare",DP:-20,Gnosis:10},{Description:"Requires 3 full turns to prepare",DP:-30,Gnosis:10},{Description:"Requires 5 full turns to prepare",DP:-40,Gnosis:10},{Description:"Requires 10 full turns to prepare",DP:-50,Gnosis:10}]}},Metamorphosis:{Category:"Innate Supernatural Powers",Options:[{Description:"Basic metamorphosis",DP:40,Gnosis:15},{Description:"Metamorphosis",DP:60,Gnosis:20},{Description:"Advanced Metamorphosis",DP:100,Gnosis:25}],Penalties:[{Description:"Conditioned",DP:-20,Gnosis:20}]},"Invisibility and Undetectable":{Category:"Innate Supernatural Abilities",Repeatable:!0,Options:{"Mystically undetectable":[{Description:"No",DP:0,Gnosis:0},{Description:"+50 to Resistances",DP:10,Gnosis:10},{Description:"+100 to Resistances",DP:20,Gnosis:20},{Description:"+150 to Resistances",DP:40,Gnosis:20},{Description:"+200 to Resistances",DP:80,Gnosis:25}],"Chameleonic camouflage":{DP:50,Gnosis:10},"Spiritual invisibility":{DP:80,Gnosis:20},Invisibility:{DP:100,Gnosis:25},"Complete invisibility":{DP:150,Gnosis:30},"Undetectable to a sense":{DP:50,Gnosis:10}},Penalties:[{Description:"Only works under a certain situation",DP:-30,Gnosis:20}]},Aura:{Category:"Innate Supernatural Powers",Repeatable:!0,Options:{Area:[{Description:"5-foot radius",DP:40,Gnosis:20},{Description:"15-foot radius",DP:60,Gnosis:20},{Description:"30-foot radius",DP:80,Gnosis:25},{Description:"80-foot radius",DP:100,Gnosis:25},{Description:"150-foot radius",DP:120,Gnosis:30},{Description:"300-foot radius",DP:140,Gnosis:35}],Resistance:[{Description:"MR or PhR against 40",DP:20,Gnosis:20},{Description:"MR or PhR against 60",DP:30,Gnosis:20},{Description:"MR or PhR against 80",DP:40,Gnosis:25},{Description:"MR or PhR against 100",DP:50,Gnosis:25},{Description:"MR or PhR against 120",DP:60,Gnosis:30},{Description:"MR or PhR against 140",DP:80,Gnosis:35}],Effect:[{Description:"Fear",DP:60,Gnosis:20},{Description:"Terror",DP:60,Gnosis:20},{Description:"Pain",DP:20,Gnosis:10},{Description:"Extreme pain",DP:40,Gnosis:20},{Description:"Weakness",DP:50,Gnosis:10},{Description:"Partial paralysis",DP:40,Gnosis:20},{Description:"Complete paralysis",DP:80,Gnosis:20},{Description:"Rage",DP:20,Gnosis:20},{Description:"Blindness",DP:50,Gnosis:10},{Description:"Deafness",DP:10,Gnosis:10},{Description:"Mute",DP:10,Gnosis:10},{Description:"Fascination",DP:20,Gnosis:20},{Description:"Simple damage",DP:30,Gnosis:10},{Description:"Double damage",DP:60,Gnosis:20},{Description:"Unconsciousness",DP:100,Gnosis:20},{Description:"Dominate",DP:120,Gnosis:25},{Description:"Death",DP:140,Gnosis:25},{Description:"Madness",DP:20,Gnosis:20},{Description:"Age",DP:60,Gnosis:20},{Description:"Petrification",DP:140,Gnosis:30},{Description:"All Action Penalty",DP:60,Gnosis:20}],"Link an additional effect to the same Resistance":{DP:10,Gnosis:20}},Penalties:[{Description:"Additional condition",DP:-30,Gnosis:20,Repeatable:!0}]},"Special Means of Vision":{Category:"Special Perceptions",Repeatable:!0,Options:[{Description:"Night vision",DP:10,Gnosis:0},{Description:"Complete night vision",DP:20,Gnosis:10},{Description:"Extrasensorial vision",DP:30,Gnosis:10},{Description:"See magic",DP:10,Gnosis:10},{Description:"See matrices",DP:10,Gnosis:10},{Description:"See spirits",DP:10,Gnosis:10},{Description:"See the supernatural",DP:30,Gnosis:20}]},"Supernatural Detection":{Category:"Special Perceptions",Repeatable:!0,Options:{Area:[{Description:"15 feet",DP:10,Gnosis:10},{Description:"30 feet",DP:20,Gnosis:10},{Description:"80 feet",DP:30,Gnosis:15},{Description:"150 feet",DP:40,Gnosis:15},{Description:"200 feet",DP:50,Gnosis:20},{Description:"1,500 feet",DP:60,Gnosis:20},{Description:"One mile",DP:80,Gnosis:25}],Resistance:[{Description:"MR against 100",DP:10,Gnosis:10},{Description:"MR against 140",DP:20,Gnosis:10},{Description:"MR against 180",DP:40,Gnosis:15},{Description:"MR against 220",DP:80,Gnosis:20},{Description:"MR against 260",DP:120,Gnosis:25}],Detect:[{Description:"Detect life",DP:20,Gnosis:10},{Description:"Detect something specific",DP:30,Gnosis:20}]}}}}),define("movement",["character","classes","martial_knowledge"],function(e,t){e.prototype.initiative=function(e){var i,n,a=this.levels,s=a.length,o=this.Advantages["Quick Reflexes"],r=this.Disadvantages["Slow Reactions"],l=this.modifier("AGI")+this.modifier("DEX");for(e!==void 0&&(s=0===e?1:e),"Human"===this.Type?l+=20:(n=this.size(),4>n?l+=40:9>n?l+=30:23>n?l+=20:25>n?l+=10:n>33?l-=20:n>28&&(l-=10)),o&&(l+=1===o?25:2===o?45:60),r&&(l-=30*r),i=0;s>i;i++)l+=t[a[i].Class].Initiative;return this.has_ki_ability("Increased Speed",e)&&(l+=10),l
},e.prototype.movement_value=function(){var e,t,i=this.has_ki_ability("Movement of Emptiness"),n=this.characteristic("AGI");return i&&(n=Math.max(n,this.characteristic("POW"))),"Human"!==this.Type&&(t=this.size(),4>t?n-=4:9>t?n-=2:t>33?n+=3:t>28?n+=2:t>24&&(n+=1)),"Legs"===this.levels[0].DP["Atrophied Members"]&&(n-=6),n>10&&!i&&!this.has_ki_ability("Inhumanity")&&(this.has_ki_ability("Inhuman (Nemesis)")||(e=this.levels[0].DP,"Inhumanity"in e||"Zen"in e||(n=10))),n}}),define("combat",["character","classes","martial_arts","martial_knowledge","movement"],function(e,t,i){var n;n=function(e){return"Base"===e?0:"Supreme"===e?2:1},e.prototype.martial_art_damage=function(e,t,n){var a,s,o,r,l=!1,c=i[e],u=c[t],d=1,p=0;if("Exelion"===e)return 2*this.presence()+this.modifier("POW");for(;!u.Damage;){if("Supreme"===t)t="Advanced";else{if("Base"===t)break;t="Base"}u=c[t]}if(n||(n=this.martial_arts()),"Tai Chi"in n&&"Supreme"===n["Tai Chi"].Degree&&(l=!0),"Arcane"in c){for(o in n)if(n.hasOwnProperty(o)){if(a=n[o],"Advanced"===a.Type)continue;r=this.martial_art_damage(o,a.Degree,n),p=Math.max(p,r)}return"Damage"in u&&(s=u.Damage,p+="number"==typeof s?s:this.modifier(s)),p}return s=u.Damage,"number"==typeof s?p=s+this.modifier("STR"):(r="Characteristic"in s?this.modifier(s.Characteristic):this.modifier("STR"),"Multiplier"in s&&(d=s.Multiplier),p=s.Base+r*d),l&&"Tai Chi"!==e&&(p+=this.modifier("POW")),p},e.prototype.martial_arts=function(e){var t,a,s,o,r,l,c,u,d=this.levels,p=d.length,h={};for(e!==void 0&&(p=0===e?1:e),l=0;p>l;l++){r=d[l].DP;for(c in r)r.hasOwnProperty(c)&&c in i&&(o=r[c],s=o[o.length-1],c in h?(t=h[c],n(s)>n(t.Degree)&&(t.Degree=s)):(u=i[c],a=u.Base,t={Degree:s,Type:"Basic"},"Arcane"in u&&(t.Type="Advanced"),h[c]=t))}return h},e.prototype.martial_arts_advantages=function(e){var t,n,a,s,o,r=[];e||(e=this.martial_arts());for(n in e)e.hasOwnProperty(n)&&(a=[],o=e[n].Degree,"Base"!==o&&(s=i[n].Base,t=s.advantages,t&&(a=a.concat(t))),"Supreme"===o&&(s=i[n].Advanced,t=s.Advantages,t&&(a=s.Replace?t:a.concat(t))),s=i[n][o],t=s.Advantages,t&&(a=s.Replace?t:a.concat(t)),r=r.concat(a));return r},e.prototype.unarmed_ability=function(e,n,a){var s,o,r,l,c,u,d,p,h,f,m,g=0,v=this.Advantages["Combat Senses"],y=this.levels,b=50,D=0;n||(n=this.martial_arts(a));for(h in n)n.hasOwnProperty(h)&&(s=n[h],u=s.Degree,m=i[h],c=m[u],"Master Bonus"in c&&(o=c["Master Bonus"],e in o&&(D=Math.max(D,o[e]))),"Bonus"in c&&(o=c.Bonus,e in o&&(g+=o[e])),"Supreme"===u&&(c=m.Advanced,"Bonus"in c&&(o=c.Bonus,e in o&&(g+=o[e]))),"Base"!==u&&(c=m.Base,"Bonus"in c&&(o=c.Bonus,e in o&&(g+=o[e]))));if("Initiative"===e)f=this.initiative(a)+20;else{for(f=this.ability(e,a),r=a!==void 0?0===a?1:a:y.length,p=this.level(),d=0;r>d;d++)l=t[y[d].Class],c=l.bonuses[e],c&&(b-=0===p?Math.floor(c/2):c),v===e&&(b-=5);g>b&&(g=b)}return"Asakusen"in n&&(f+=10),f+g+D},e.prototype.unarmed_damage=function(e){var t,i=0,n=this.size();e||(e=this.martial_arts());for(t in e)e.hasOwnProperty(t)&&(i=Math.max(i,this.martial_art_damage(t,e[t].Degree,e)));return 0===i&&(i=4>n?5:23>n?10:25>n?20:29>n?30:34>n?40:60,i+=this.modifier("STR")),"Asakusen"in e&&(i+=10),!this.has_ki_ability("Increased Damage")||"Exelion"in e||(i+=10),i}}),define("development_points",["jquery","abilities","character","classes","essential_abilities","martial_arts","modules","powers","primaries","tables","combat","libs/utils"],function(e,t,i,n,a,s,o,r,l,c){return i.prototype.add_essential_ability=function(e,t){var i,n=this.levels[0].DP;e.indexOf("Attribute Increased")>-1?e in n?n[e].push(t):n[e]=[t]:"Fatigue Resistance"===e?e in n?n[e]+=1:n[e]=1:t?n[e]=t:(i=e in a.advantages?a.advantages[e]:a.disadvantages[e],n[e]=i.DP)},i.prototype.add_martial_art=function(e,t,i){var n=this.level_info(i).DP;e in n?n[e].push(t):n[e]=[t],"First Martial Art"in this||(this["First Martial Art"]=e)},i.prototype.add_module=function(e,t,i){var n=0===t?0:t-1,a=this.levels[n].DP,s=o[e];this.has_module(e,i)||(e in a?(a[e].push(i),a[e].sort()):a[e]=s.Option_Title?[i]:s.DP)},i.prototype.add_power=function(e,t,i){var n,a=this.level_info(t).DP;e in a?a[e].push(i):(n=r[e],a[e]=n.Repeatable||n.Attack_Linked?[i]:i)},i.prototype.creature_dp_remaining=function(){var e,t=a.advantages,i=this.levels[0].DP,n=this.creature_dp_total();this.is_spirit()&&(n-=100);for(e in i)i.hasOwnProperty(e)&&("Fatigue Resistance"===e?n-=i[e]*t[e].DP:e.indexOf("Attribute Increased ")>-1?n-=i[e].length*t[e].DP:e in t?n-=t[e].DP:e in a.disadvantages&&(n-=a.disadvantages[e].DP));return n},i.prototype.creature_dp_total=function(){var e=this.bonus_dp_from_gnosis(),t=this.level();return 0===t?400+e:500+100*t+e},i.prototype.bonus_dp_from_gnosis=function(){var e=this.Gnosis;return"number"!=typeof e?0:e>=50?750:e>=45?500:e>=40?300:e>=35?150:e>=30?50:0},i.prototype.dp_cost=function(e,i,r){var l,c,u,d,p=t[e],h=n[i],f=a.advantages,m=a.disadvantages,g=this.Advantages;return 0===e.indexOf("Save ")?1:e in f?f[e].DP:e in m?m[e].DP:e in o?o[e].DP:e in s?(c=s[e],"Arcane"in c?"Tao"===i?20:50:(u=e===this["First Martial Art"],"Tao"===i?"Supreme"===r?u?10:20:u?5:10:"Base"===r?u?10:20:"Advanced"===r?u?15:30:u?25:50)):(p&&(l=p.Field),u=h.reduced[e],d=u?u:l?h[l]:h[e],l&&(g["Aptitude in a Field"]===l&&d--,c=g["Aptitude in a Subject"],c&&c.Ability===e&&(d-=c.Points)),1>d&&(d=1),d)},i.prototype.dp_remaining=function(){var e,t,i,r,c,u,d,p,h,f,m,g,v,y,b,D,P,_,C,A,M,k,x,w=Object.keys(l),S={Attack:2,Block:2,Dodge:2},R=this.level(),T=this.levels,N=T.length,O=0,F=0,E=600,B=[],G={Attack:0,Block:0,Dodge:0},L={Attack:0,Block:0,Dodge:0,DP:0,"Magic Projection":0,Powers:0,Psychic:0,"Psychic Projection":0,Supernatural:0,"Martial Knowledge":0,"Magic Level":0};for(f=0;N>f;f++){if(B.push({}),M=B[f],b=T[f],r=b.Class,i=n[r],0===f&&0===R?E=400:f>0&&(E=100),L.DP+=E,L.Psychic+=i.Psychic*E/100,L.Supernatural+=i.Supernatural*E/100,L.Powers+=E/2,M.Total=E,M.Combat=i.Combat*E/100,M.Psychic=i.Psychic*E/100,M.Supernatural=i.Supernatural*E/100,M.Powers=E/2,0===f)g=this.bonus_dp_from_gnosis(),M.Powers+=g,M.Total+=g,this.is_spirit()&&(M.Powers-=100,M.Total-=100),k={Combat:0,Psychic:0,Supernatural:0,Powers:0,Other:0};else{k={},P=B[f-1].Saved;for(_ in P)P.hasOwnProperty(_)&&(k[_]=P[_])}M.Saved=k,O+=E/10,F+=E/10,M["Martial Knowledge"]=O,M["Magic Level"]=F,M.Other=E,M["Magic Projection"]=L.Supernatural/2-L["Magic Projection"],M["Psychic Projection"]=L.Psychic/2-L["Psychic Projection"],y=b.DP;for(m in y)if(y.hasOwnProperty(m)){if(m in s){for(p=y[m],u=p.length,c=0,g=0;u>g;g++)c+=this.dp_cost(m,r,p[g]);x=c}else if(c=this.dp_cost(m,r),m in o)x=o[m].Option_Title?y[m].length*c:c;else if("Accumulation Multiple"===m||"Ki"===m){x=0,h=y[m];for(t in h)h.hasOwnProperty(t)&&(x+=h[t]*c)}else x=m.indexOf("Attribute Increased")>-1?y[m].length*c:"Fatigue Resistance"===m?y[m]*c:m in a.advantages?c:m in a.disadvantages?c:y[m]*c;M.Total-=x,_=l.for_ability(m),M[_]-=x,0===m.indexOf("Save ")&&(k[_]+=x),m in M&&(M[m]-=x,"Magic Level"===m?F-=x:"Martial Knowledge"===m&&(O-=x)),m in G&&(S[m]=c,G[m]+=y[m]),m in L&&(L[m]+=x)}for(e=G.Attack,g=L.Attack+L.Block+L.Dodge,d=Math.max(G.Block,G.Dodge),u=L.DP/2-g,C=L.DP/4,M.Attack=Math.min(u,Math.max((d+50-e)*S.Attack,C-L.Attack)),this["Damage Resistance"]?(M.Block=0,M.Dodge=0):(M.Block=Math.min(u,Math.max((e+50-G.Block)*S.Block,C-L.Block)),M.Dodge=Math.min(u,Math.max((e+50-G.Dodge)*S.Dodge,C-L.Dodge))),c=this.class_change_dp(0===R?0:f+1),c>0&&(M.Other-=c,M.Total-=c,M.Class_Change=c),u=w.length,g=0;u>g;g++)if(_=w[g],A=M[_],0>A){"Withdrawn"in M||(M.Withdrawn={}),M.Withdrawn[_]=-A,M[_]=0;for(v=0;f>=v;v++)k=B[v].Saved,k[_]=Math.max(k[_]+A,0)}else M[_]=Math.min(M[_],M.Total)}for(u=w.length,f=0;N>f;f++)for(y=T[f].DP,M=B[f],k=M.Saved,g=0;u>g;g++)_=w[g],m="Other"===_?"generic":_,m="Save "+m+" DP for later",P=k[_],m in y&&(P-=y[m]),M[m]=M[_],M[_]+=P,M.Total+=P;for(D={Attack:M.Attack,Block:M.Block,Dodge:M.Dodge,"Magic Projection":M["Magic Projection"],"Psychic Projection":M["Psychic Projection"],"Martial Knowledge":M["Martial Knowledge"],"Magic Level":M["Magic Level"]},f=N-1;f>=0;f--){M=B[f];for(m in D)D.hasOwnProperty(m)&&(g=Math.min(M[m],D[m]),D[m]=g,_=l.for_ability(m),M[m]=Math.min(g,M[_]))}return B},i.prototype.ea_advantage_summary=function(e){var t=a.advantages[e],i=this.levels[0].DP[e],n=e;return("Attribute Increased +3"===e||"Fatigue Resistance"===e)&&(n+=" ("+i+")"),"Options"in t&&(n+=": "+i),n},i.prototype.ea_disadvantage_summary=function(e){var t=a.disadvantages[e],i=this.levels[0].DP[e],n=e;return"Options"in t&&(n+=": "+i),n},i.prototype.essential_ability_allowed=function(t,i){var n,s,o,r,l,u,d=a.advantages,p=!0,h=a.disadvantages,f=this.Element,m=this.creature_dp_remaining(),g=this.levels[0].DP,v=this.Advantages,y=15,b=this.Type;if(n=t in d?d[t]:h[t],o=n.DP,o>m)return!1;if(s=n.Category,"Magic"===s&&!this.has_gift())return!1;if(!("Psychic"!==s||"Access to a Psychic Discipline"in g||"Access to Psychic Disciplines"in g||"Access to One Psychic Discipline"in v||"Free Access to Any Psychic Discipline"in v))return!1;if("Psychic Inclination"===t&&i&&-1===e.inArray(i,this.discipline_access()))return!1;if(u=n.Incompatible)for(r=u.length,l=0;r>l;l++)if(u[l]in g)return!1;if("Atrophied Members"===t&&this.is_spirit())return!1;if("Physical Exemption"===t&&(this.is_spirit()||b.indexOf("Undead")>-1))return!1;if(f){if("Access to a Psychic Discipline"===t){if("Fire"===f&&"Cryokinesis"===i)return!1;if("Water"===f&&"Pyrokinesis"===i)return!1}if(t.indexOf("Natural Immunity to an Element")>-1){if(i&&i!==f)return!1;if(n.Alternatives[0]in g)return!1}if(t.indexOf("Natural Vulnerability to an Element")>-1){if(i&&i!==c.opposite_elements[f])return!1;if(n.Alternatives[0]in g)return!1}}if(t.indexOf("Natural Knowledge of a Path")>-1&&i)for(u=n.Alternatives,r=u.length,l=0;r>l;l++)if(u[l]in g&&g[u[l]]===i)return!1;if(n.Gnosis>this.Gnosis){if(this.Created)return!1;p="maybe"}if("Attribute Increased +1"===t||"Attribute Increased +2"===t)return t in g?i?-1===e.inArray(i,g[t])?p:!1:8>g[t].length?p:!1:p;if("Attribute Increased +3"===t){if(!(t in g))return p;if(!i)return 8>g[t].length?p:16>g[t].length?this.Gnosis>=20?!0:this.Created?!1:"maybe":this.Gnosis>=25?!0:this.Created?!1:"maybe";for(u=g[t],r=u.length,l=0;r>l;l++)u[l]===i&&(y+=5);return this.Gnosis>=y?!0:this.Created?!1:"maybe"}return"Fatigue Resistance"===t?!0:t in g?!1:p},i.prototype.has_martial_art=function(t,i,n){var a,s,o=this.levels,r=o.length;for(n!==void 0&&(r=0===n?1:n),s=0;r>s;s++)if(a=o[s].DP,t in a&&e.inArray(i,a[t])>=0)return!0;return!1},i.prototype.has_module=function(t,i){var n,a,s=this.levels,r=s.length;for(a=0;r>a;a++)if(n=s[a].DP,t in n){if(!o[t].Option_Title)return!0;if(e.inArray(i,n[t])>=0)return!0}return!1},i.prototype.martial_art_allowed=function(e,t,i){var n,a,o,r,l,c,u,d,p=s[e][t],h=p.Requirements;if("Supreme"===t){if(!this.has_martial_art(e,"Advanced",i))return!1}else if("Base"!==t&&!this.has_martial_art(e,"Base",i))return!1;if(this.has_martial_art(e,t))return!1;if(!h)return!0;n=this.martial_arts(i);for(c in h)if(h.hasOwnProperty(c))if(o=h[c],"Attack"===c||"Block"===c||"Dodge"===c||"Initiative"===c){if(o>this.unarmed_ability(c,n,i))return!1}else if("Defense"===c){if(o>this.unarmed_ability("Dodge",n,i)&&o>this.unarmed_ability("Block",n,i))return!1}else if("Ki Abilities"===c){for(a=o.length,r=0;a>r;r++)if(!this.has_ki_ability(o[r],void 0,i))return!1}else if("Martial Art"===c){u=!1;for(l in o)if(o.hasOwnProperty(l)&&(d=o[l],this.has_martial_art(l,d,i))){u=!0;break}if(!u)return!1}else if(c.indexOf("(")>-1){if(r=c.indexOf(" ("),l=c.slice(0,r),d=c.slice(r+2,-1),o>this.ability(l,d,i))return!1}else if(o>this.ability(c,void 0,i))return!1;return!0},i.prototype.new_martial_art_allowed=function(e){for(var t,i,n,a,s=this.level();s>=e;){if(t=this.martial_arts(e),n=this.ability("Block",void 0,e),a=this.ability("Dodge",void 0,e),i=Math.max(n,a),i+=this.ability("Attack",void 0,e),40>i-40*Object.keys(t).length)return!1;e++}return!0},i.prototype.power_parameters=function(t){var i,n,a,s=this.levels,o=s.length,r=[];for(n=0;o>n;n++)i=s[n].DP,a=i[t],a&&(e.isArray(a)?e.merge(r,a):r.push(i[t]));return r},i.prototype.remove_martial_art=function(t,i,n){var a,o,r,l,c=this.level_info(n).DP,u=c[t];if(1===u.length){if(delete c[t],t===this["First Martial Art"]){for(l=this.levels,a=l.length,o=0;a>o;o++){c=l[o].DP;for(r in c)if(c.hasOwnProperty(r)&&r in s)return this["First Martial Art"]=r,void 0}delete this["First Martial Art"]}}else u.splice(e.inArray(i,u),1)},{}}),define("magic",["jquery","character","classes","tables","development_points"],function(e,t,i,n){t.prototype.ma=function(){var e,t,i,a=n.base_ma[this.characteristic("POW")],s=this.levels,o=s.length,r=a;for(e=0;o>e;e++)t=s[e],i=t.DP["MA Multiple"],i&&(r+=i*a);return r},t.prototype.magic_level=function(){var e,t,i,a=this.levels,s=a.length,o=this.Advantages["Gradual Magic Learning"],r=n.magic_level[this.characteristic("INT")];for(e=0;s>e;e++)t=a[e],i=t.DP["Magic Level"],i&&(r+=5*i),o&&(r+=5);return r},t.prototype.magic_projection_defense=function(){var e,t,i,n,a,s=this.levels,o=s.length,r=this.magic_projection_imbalances()[o-1],l=-50,c=this.ability("Magic Projection");if(r&&(c-=r),this.has_module("Magic Projection as a Defense")){for(e=this.modifier("DEX"),t=this.modifier("AGI"),n=0;o>n;n++)i=s[n].DP,a=i.Block,a&&(e+=a),a=i.Dodge,a&&(t+=a);l=Math.max(e,t)}return Math.max(l,c)},t.prototype.magic_projection_imbalances=function(){var e,t,i,n,a,s=!1,o=0,r=this.levels,l=r.length,c=[];for(e=0;l>e;e++)n=r[e],t=n["Magic Projection Imbalance"],a=r[e].DP["Magic Projection"],a||s?a&&!s?(s=!0,i="number"==typeof t?t:0,i=Math.max(Math.min(i,30),-30),c.push(i),0!==i?n["Magic Projection Imbalance"]=i:t&&delete n["Magic Projection Imbalance"]):(i="number"==typeof t?t:o,i=Math.max(i,o-10),i=Math.min(i,o+10),i=Math.max(Math.min(i,30),-30),c.push(i),0!==i||0!==o?n["Magic Projection Imbalance"]=i:0===o&&"number"==typeof t&&delete n["Magic Projection Imbalance"]):(c.push(void 0),"number"==typeof t&&delete n["Magic Projection Imbalance"]),o=i;return c},t.prototype.magic_projection_offense=function(){var e,t,i=this.levels,n=i.length,a=this.magic_projection_imbalances()[n-1],s=-50,o=this.ability("Magic Projection");if(a&&(o+=a),this.has_module("Magic Projection as an Attack"))for(s=this.modifier("DEX"),e=0;n>e;e++)t=i[e].DP.Attack,t&&(s+=t);return Math.max(s,o)},t.prototype.uses_zeon=function(){var e;return this.has_gift()?!0:(e=this.modifier("POW"),this.ability("Summon")>e?!0:this.ability("Banish")>e?!0:this.ability("Bind")>e?!0:(e=this.modifier("WP"),this.ability("Control")>e?!0:!1))},t.prototype.zeon=function(){var e,t,a,s=this.levels,o=s.length,r=this.Advantages["Magic Nature"],l=n.base_zeon[this.characteristic("POW")];for(e=0;o>e;e++)t=s[e],a=t.DP.Zeon,a&&(l+=5*a),a=i[t.Class].bonuses.Zeon,a&&(l+=a),r&&(l+=50*r);return l},t.prototype.zeon_recovery=function(){var e,t,i,a=n.base_ma[this.characteristic("POW")],s=this.Advantages["Magical Blockage"],o=this.levels[0].DP["Magic Blockage"],r=this.levels,l=r.length,c=this.Disadvantages["Slow Recovery of Magic"],u=this.levels[0].DP["Slow Recovery of Magic"],d=this.Advantages["Superior Magic Recovery"],p=this.levels[0].DP["Superior Magic Recovery"],h=this.ma();if(s||o)return 0;for(e=0;l>e;e++)t=r[e],i=t.DP["Zeon Regeneration Multiple"],i&&(h+=i*a);return d?h*=d+1:p&&(h*=2),c?h/=2:u&&(h/=2),h}}),define("psychic",["jquery","character","classes","development_points"],function(e,t,i){t.prototype.psychic_points=function(e){var t,n,a,s,o={},r=this.levels,l=e?e:r.length,c=1;for(a=0;l>a;a++)s=r[a],t=s.Class,n=s.DP,t in o?o[t]+=1:o[t]=1,0===o[t]%i[t]["Innate Psychic Points"]&&(c+=1),"Psychic Points"in n&&(c+=n["Psychic Points"]);return c},t.prototype.psychic_powers=function(){var e,t,i=this.Advantages["Access to Natural Psychic Powers"],n={};return i&&(t=120,e=i.Points,2===e?t=140:3===e&&(t=180),n[i.Power]=t),n},t.prototype.psychic_projection_defense=function(){var e,t,i,n,a,s=this.levels,o=s.length,r=-50,l=this.ability("Psychic Projection");if(this.has_module("Psychic Projection Module")){for(e=this.modifier("DEX"),t=this.modifier("AGI"),n=0;o>n;n++)i=s[n].DP,a=i.Block,a&&(e+=a),a=i.Dodge,a&&(t+=a);r=Math.max(e,t)}return Math.max(r,l)},t.prototype.psychic_projection_offense=function(){var e,t,i=this.levels,n=i.length,a=-50,s=this.ability("Psychic Projection");if(this.has_module("Psychic Projection Module"))for(a=this.modifier("DEX"),e=0;n>e;e++)t=i[e].DP.Attack,t&&(a+=t);return Math.max(a,s)}}),define("resistances",["jquery","character","tables","martial_knowledge"],function(e,t,i){t.prototype.resistance=function(t){var n,a,s=this.Advantages,o=this.Disadvantages,r=this.presence()+this.modifier(i.resistances[t]);switch(this.Race){case"Devah Nephilim":("PhR"===t||"DR"===t)&&(r-=10);break;case"Duk'zarist Nephilim":n=this.gender(),r+="PhR"===t&&"Male"===n?20:"MR"===t&&"Female"===n?20:15;break;case"Jayan Nephilim":"PhR"===t?r+=15:"MR"===t&&(r-=10);break;case"Sylvain Nephilim":r+="MR"===t||"PsR"===t?10:"DR"===t?20:5;break;case"Vetala Nephilim":"DR"===t&&(r-=20)}return"PhR"===t&&this.has_ki_ability("Physical Dominion")&&(r+=10),"MR"===t?(a=s["Exceptional Magic Resistance"],a&&(r+=25*a),"The Gift"in this.Advantages&&(r+=10)):"PsR"===t&&(a=s["Exceptional Psychic Resistance"])?r+=25*a:-1!==e.inArray(t,["DR","PhR","VR"])&&(a=s["Exceptional Physical Resistance"])&&(r+=25*a),this.has_ki_ability("Body of Emptiness")&&(r+=20),("DR"===t&&"Sickly"in o||"MR"===t&&"Susceptible to Magic"in o||"PhR"===t&&"Physical Weakness"in o||"VR"===t&&"Susceptible to Poisons"in o)&&(r=Math.floor(r/2)),r},t.prototype.resistance_modifiers=function(){var t=this.Element,n=this.levels[0].DP,a=n.Attuned,s=this.Race,o={};return t&&(o[t]=20,o[i.opposite_elements[t]]=-20),a&&e.inArray(a,i.elements)>-1&&(a in o?o[a]+=20:o[a]=20),"D'Anjayni Nephilim"===s?o["supernatural detection"]=30:"Devah Nephilim"===s?o["mind reading and emotion alteration"]=10:"Duk'zarist Nephilim"===s?(t="Darkness",t in o?o[t]+=10:o[t]=10):"Sylvain Nephilim"===s?(t="Light",t in o?o[t]+=10:o[t]=10):"Vetala Nephilim"===s&&(o["Criticals to vulnerable points"]=50),"Easily Possessed"in this.Disadvantages?o["possession or domination"]=-50:"Free Will"in this.Advantages&&(o["possession or domination"]=60),this.has_ki_ability("Ki Concealment")?"supernatural detection"in o?o["supernatural detection"]+=Math.floor(this.ki_concealment()/2):o["supernatural detection"]=Math.floor(this.ki_concealment()/2):this.has_ki_ability("Undetectable")&&("supernatural detection"in o?o["supernatural detection"]+=2*this.presence():o["supernatural detection"]=2*this.presence()),o}}),define("render",["jquery","abilities","characters","essential_abilities","ki_abilities","martial_arts","modules","primaries","tables","widgets","armor","creation_points","development_points","magic","martial_knowledge","movement","psychic","resistances"],function(e,t,i,n,a,s,o,r,l,c){var u,d,p,h,f,m=c.create_spinner,g={};return u=function(t){var n=e("#"+t),a=i.current()[t];n.data("spinner")?n.spinner("value",a):n.val(""+a)},d=function(){var e,t,n,a,s,o=l.characteristics,r=o.length,c=i.current();for(t=0;r>t;t++)if(e=o[t],!(e in c))return"Roll "+e;if(!("Appearance"in c))return"Roll or select Appearance";if(!c.Gender)return"Select a gender";if(!c.Race)return"Select a race";if(c.cp_remaining()>0)return"Select advantages and disadvantages";if(n=c.level(),s=c.levels,r=s.length,0===n&&r>1||n>0&&n!==r)return"Update levels list";for(t=0;r>t;t++){if(a=s[t],0===(t+1)%2&&!("Characteristic"in a))return"Select characteristic bonus for level "+(t+1);if(n>0&&!("Natural Bonus"in a))return"Select natural bonus for level "+(t+1)}return"Name"in c?"Done!":"Choose a name"},p=function(t,i){var n=t.levels[0].DP,a=10;"Superhuman "+i+" Characteristics"in n?a=13:"Supernatural "+i+" Characteristics"in n?a=15:"Divine "+i+" Characteristics"in n&&(a=20),e("#characteristics ."+i.toLowerCase()).spinner("max",a)},h=function(t){var n,a=e("#"+t);if(a.data("spinner"))n=a.spinner("value");else{if(!a.valid())return;n=parseInt(a.val(),10)}i.current()[t]=n,"XP"===t?a.nextAll(".form-control-static").find("span").text(n):a.nextAll(".display").text(n)},f=function(t){var n=e("#"+t);n.valid()&&(i.current()[t]=n.val())},g.render=function(n){var a,s,o,c,u,d,p,h,f,m,g,v,y,b,D,P,_=i.current(),C=_.martial_arts(),A=_.Element,M=_.levels[0].DP,k=M["Acute Sense"],x=[],w=_.resistance_modifiers(),S=[],R=_.Specializations,T=!1,N=0,O=0,F=_.mk_totals(),E=_.mk_remaining();if(e(".resistance_bonuses",n).hide(),e(".summary",n).text(_.summary()),e(".Gnosis",n).text(_.type_and_gnosis()),e(".lp",n).text(_.life_points()),e(".fatigue",n).text(_.fatigue()),e(".STR",n).text(_.characteristic("STR")),e(".DEX",n).text(_.characteristic("DEX")),e(".AGI",n).text(_.characteristic("AGI")),e(".CON",n).text(_.characteristic("CON")),e(".INT",n).text(_.characteristic("INT")),e(".POW",n).text(_.characteristic("POW")),e(".WP",n).text(_.characteristic("WP")),e(".PER",n).text(_.characteristic("PER")),e(".Appearance",n).text(_.appearance()),e(".Size",n).text(_.size()+" "+_.size_category()),e(".MV",n).text(_.movement_value()),e(".Regeneration",n).text(_.regeneration()),e(".PhR",n).text(_.resistance("PhR")),e(".MR",n).text(_.resistance("MR")),e(".PsR",n).text(_.resistance("PsR")),e(".VR",n).text(_.resistance("VR")),e(".DR",n).text(_.resistance("DR")),h=Object.keys(w),c=h.length,c>0){for(b="(",d=0;c>d;d++)d>0&&(b+=", "),f=h[d],v=w[f],v>0&&(b+="+"),b+=v+" vs "+f;b+=")",e(".resistance_modifiers",n).show().text(b)}else e(".resistance_modifiers",n).hide();for(e(".Initiative",n).text(_.initiative()),e(".Attack",n).text(_.ability("Attack")),o=_.ability("Block"),u=_.ability("Dodge"),o>u?e(".Defense",n).text(o+" Block"):e(".Defense",n).text(u+" Dodge"),v=_.damage_barrier(),v>0?e(".Damage_Barrier",n).text(v).parent().show():e(".Damage_Barrier",n).parent().hide(),v=_.damage_reduction(),0!==v?e(".Base_Damage_reduction",n).text(v).parent().show():e(".Base_Damage_reduction",n).parent().hide(),e(".Wear_Armor",n).text(_.ability("Wear Armor")),d=F.length-1,e(".MK",n).text(F[d]),e(".unallocated_mk").text(E[d]),e(".magic",n).toggle(_.has_gift()),v=_.ma(),b=v,A&&(x.push(v+20+" "+A),x.push(v-20+" "+l.opposite_elements[A])),g=_.zeon_recovery(),g!==v&&x.push(g+" Recovery"),x.length>0&&(b+=" ("+x.join(", ")+")"),e(".MA",n).text(b),e(".Zeon",n).text(_.zeon()),e(".zeon-row",n).toggle(_.uses_zeon()),d=_.magic_projection_offense(),p=_.magic_projection_defense(),b=d===p?d+"":d+" Offensive, "+p+" Defensive",e(".Magic_Projection",n).text(b),e(".Magic_Level",n).text(_.magic_level()),d=_.psychic_projection_offense(),p=_.psychic_projection_defense(),b=d===p?d+"":d+" Offensive, "+p+" Defensive",e(".Psychic_Projection",n).text(b),e(".Psychic_Points",n).text(_.psychic_points()),e(".psychic",n).toggle(_.discipline_access().length>0),b=_.racial_abilities(),b?(e(".Racial-Abilities").text(b),e(".racial-row").show()):e(".racial-row").hide(),s=_.ki_abilities(),d=e.inArray("Ki Concealment",s),d>-1&&(s[d]+=" ("+_.ki_concealment()+")"),d=e.inArray("Ki Detection",s),d>-1&&(s[d]+=" ("+_.ki_detection()+")"),e(".Ki-Abilities",n).text(s.join(", ")),e.each(["STR","DEX","AGI","CON","POW","WP"],function(t,i){d=_.ki_accumulation(i),N+=d,p=_.ki_points(i),O+=p,e(".Accumulation_"+i,n).text(d),e(".Ki_"+i,n).text(p)}),e(".Accumulation_Total",n).text(N),e(".Ki_Total",n).text(O),e(".ki-abilities",n).toggle(s.length>0),e(".ki-table",n).toggle(s.length>0),P=_.dominion_techniques(),h=Object.keys(P),h.sort(),c=h.length,b="",d=0;c>d;d++){for(d>0&&(b+=", "),f=h[d],b+=f+" (",s=P[f],D=s.length,p=0;D>p;p++)p>0&&(b+="; "),b+=s[p].Name;b+=")"}e(".Dominion-Techniques",n).text(b),e(".dominion-techniques-row",n).toggle(b.length>0);for(m in r)if(r.hasOwnProperty(m))for(s=r[m],c=s.length,d=0;c>d;d++)f=s[d],f in t&&(a=t[f],v=_.ability(f),a.Summoning&&e("."+f,n).text(v),v>_.modifier(a.Characteristic)&&("Field"in a?(R&&(y=R[f],y&&(v="("+y+") ",v+=_.ability(f,y))),k&&"PER"===a.Characteristic&&(v+=" ("+(v+30)+" "+k+")"),S.push(f+" "+v)):a.Summoning&&(T=!0)));e(".summoning",n).toggle(T),S.sort(),e(".secondary-abilities",n).text(S.join(", ")),e(".Unarmed_Initiative",n).text(_.unarmed_ability("Initiative",C)),e(".Unarmed_Attack",n).text(_.unarmed_ability("Attack",C)),o=_.unarmed_ability("Block",C),u=_.unarmed_ability("Dodge",C),o>u?e(".Unarmed_Defense",n).text(o+" Block"):e(".Unarmed_Defense",n).text(u+" Dodge"),e(".Unarmed_Damage",n).text(_.unarmed_damage()),e(".unarmed-advantages-block",n).text(_.martial_arts_advantages(C).join(", "))},g.update_cp=function(t){var n,a,s,o,r,l=["Common","Background","Magic","Psychic"],c=0,u="",d=l.length,p=i.current(),h=p.Advantages,f=p.Disadvantages,m="",v=p.cp_total();for(a=0;d>a;a++)n=l[a],o=p.cp_remaining(n),0!==o&&(c>0&&(m+=", "),m+=o+" "+n,c++);m||(m="0",t||e("#choose_abilities").removeAttr("disabled")),e("#cp_remaining").text(m),e("#cp_total").text(v),"0"===m||t?e("#add_advantage").hide():e("#add_advantage").show(),a=0;for(s in h)h.hasOwnProperty(s)&&(a>0&&(u+=", "),r=p.advantage_summary(s),u+=t?r:'<a href="#" data-name="'+s+'">'+r+"</a>",a++);e("#Advantages").html(u),3>Object.keys(f).length&&!t?e("#add_disadvantage").show():e("#add_disadvantage").hide(),u="",a=0;for(s in f)f.hasOwnProperty(s)&&(a>0&&(u+=", "),r=p.disadvantage_summary(s),u+=t?r:'<a href="#" data-name="'+s+'">'+r+"</a>",a++);e("#Disadvantages").html(u),g.render(e(".container"))},g.update_essential_abilities=function(t){var a,s,o,r=n.advantages,l="",c="",u=i.current(),d=n.disadvantages,p=u.levels[0].DP,h=0,f=0,m=u.creature_dp_remaining(),v=u.creature_dp_total();e("#dp_left_for_ea").text(m),e("#dp_total_for_ea").text(v),m>0&&!t?e("#add_ea_advantage").show():e("#add_ea_advantage").hide();for(s in p)p.hasOwnProperty(s)&&(s in r?(h>0&&(l+=", "),o=u.ea_advantage_summary(s),l+=t?o:'<a href="#" data-name="'+s+'">'+o+"</a>",h++):s in d&&(f>0&&(c+=", "),o=u.ea_disadvantage_summary(s),a=d[s],c+=t||-a.DP>m?o:'<a href="#" data-name="'+s+'">'+o+"</a>",f++));e("#ea_advantages").html(l),e("#ea_disadvantages").html(c),e("#add_ea_disadvantage").toggle(!t),g.render(e(".container"))},g.load_data=function(){var t=i.current(),n=t.levels[0].Class,a=t.creation_stage();e("input.characteristic, #Appearance, #XP").show().nextAll(".display").hide(),e("#Physical, #Spiritual, #Gender, #Race, #first_class").show().nextAll(".display").hide(),e("#add_xp").hide(),e("#proceed").show(),e("#choose_essential_abilities").show(),e("#choose_characteristics").show(),e("#choose_advantages").show().attr("disabled","disabled"),e("#choose_abilities").show().attr("disabled","disabled"),e("#attributes").hide(),e("#essential_abilities").hide(),e("#characteristics").hide(),e("#advantages").hide(),e("#levels").hide(),e(".level").remove(),u("Type"),a>1&&(g.start_attributes(),"Human"!==t.Type&&(e("#Created").val(t.Created?"Yes":"No"),u("Element"),u("Gnosis"),e("#creature_class").val(n),e("#creature_level").spinner("value",t["Racial Level"]),a>2&&g.start_essential_abilities(),a>3&&g.start_characteristics()),a>3&&(u("STR"),u("DEX"),u("AGI"),u("CON"),u("INT"),u("POW"),u("WP"),u("PER"),u("Appearance"),u("Gender"),u("Race"),u("XP"),u("Name"),e("#first_class").val(n),g.update_basics(),a>4&&(g.start_advantages(),a>5&&g.start_abilities())))},g.update_basics=function(){var t=i.current(),n=e("#first_class").val();h("STR"),h("DEX"),h("AGI"),h("CON"),h("INT"),h("POW"),h("WP"),h("PER"),h("Appearance"),f("Gender"),f("Race"),h("XP"),n&&t.change_class(0>t.XP?0:1,n),f("Name"),g.render(e(".container")),e("#main_form").valid()&&e("#choose_advantages").removeAttr("disabled")},g.update_name=function(){f("Name"),e(".container .summary").text(i.current().summary())},g.start_attributes=function(){var t=i.current(),n=e("#Type"),a=n.val();return t.Type=a,t.Race||(t.Race="Other"),n.hide().nextAll(".display").text(a).show(),e("#proceed").hide(),"Human"===a?(n.nextAll(".display").text("Human or Nephilim"),g.start_characteristics()):(e("#attributes").show(),e("#choose_essential_abilities").show(),e("#Created, #creature_class").show().nextAll(".display").hide(),t.element_allowed()?(e("#Element_label").show(),e("#Element").show().nextAll(".display").hide()):(e("#Element_label").hide(),e("#Element").hide().nextAll(".display").hide()),e("#Gnosis").find(".spinner-buttons").length?e("#Gnosis, #creature_level").show().nextAll(".display").hide():(m("#Gnosis",{min:0,max:50,step:5,value:10}),m("#creature_level",{min:0,max:16,value:0})),"Human"!==a&&"Natural"!==a&&e("#Gnosis").spinner("min",10),e("#Created").val("No"),e("#Element").val("None"),e("#Gnosis").spinner("value",10),g.render(e(".container")),void 0)},g.start_essential_abilities=function(){var t,n=i.current(),a=e("#Created"),s=a.val();n.Created="Yes"===s,a.hide().nextAll(".display").text(s).show(),a=e("#Damage_Resistance"),s=a.val(),"Yes"===s&&(n["Damage Resistance"]=!0),a.hide().nextAll(".display").text(s).show(),n.element_allowed()&&(f("Element"),a=e("#Element"),s=a.val(),s||(s="None"),a.hide().nextAll(".display").text(s).show()),h("Gnosis"),e("#Gnosis").hide().nextAll(".display").show(),a=e("#creature_class"),s=a.val(),e("#first_class").val(s),a.hide().nextAll(".display").text(s).show(),a=e("#creature_level"),s=a.spinner("value"),n["Racial Level"]=s,t=0===s?-100:l.xp_chart[s-1],t>n.XP&&(n.XP=t),a.hide().nextAll(".display").text(s).show(),e("#choose_essential_abilities").hide(),g.update_essential_abilities(),e("#essential_abilities, #ea_dp, #choose_characteristics").show(),g.render(e(".container"))},g.start_characteristics=function(){var t,n,a=i.current();e("#characteristics").show(),e("#ea_dp, #choose_characteristics").hide(),e("#choose_advantages").text("Human"===a.Type?"Choose Advantages":"Choose Abilities").show(),e("#add_xp").hide(),e("#characteristics").find(".spinner-buttons").length?(e("div.characteristic, #Appearance, #XP").show().nextAll(".display").hide(),e("#Gender, #Race, #first_class").show().nextAll(".display").hide()):(m("#characteristics .characteristic",{min:1,max:10,value:5}),m("#Appearance",{min:1,max:10,value:5}),m("#XP",{min:-100,max:9999,value:0}),e("div.characteristic, #Appearance, #XP").on("changed",g.update_basics),e("div.characteristic, #Appearance, #Gender, #Race, #first_class, #XP").nextAll(".display").hide(),e("#main_form").validate({errorClass:"has-error",highlight:function(t,i){e(t).parents(".form-group").addClass(i)},unhighlight:function(t,i){e(t).parents(".form-group").removeClass(i)}}),e("#Gender, #Race, #first_class").change(function(){e(this).blur(),g.update_basics()}),e("#Name").change(g.update_name)),p(a,"Physical"),p(a,"Spiritual"),e(".characteristic, #Appearance").spinner("value",5),e("#XP").spinner("value",0),e("#Gender, #Race, #Name").val(""),"Human"!==a.Type&&(e("#Race").val("Other"),t=a["Racial Level"],n=0===t?-100:l.xp_chart[t-1],e("#XP").spinner("min",n),e("#XP").spinner("value",n),g.update_essential_abilities(!0)),e("#race_and_class").toggle("Human"===a.Type)},g.start_advantages=function(){if(g.update_basics(),e("#main_form").valid()){if(e("#Gender, #Race, #first_class").each(function(){var t=e(this),i=t.val();t.hide().nextAll(".display").text(i).show()}),e("div.characteristic, #Appearance, #XP").hide().nextAll(".display").show(),"Human"!==i.current().Type)return g.start_abilities();g.update_cp(),e("#advantages").show(),e("#choose_advantages").hide()}},g.start_abilities=function(){g.update_cp(!0),e("#choose_advantages, #choose_abilities").hide(),e("#levels").show(),g.update_level(),e("#add_xp").show()},g.update_level=function(){var l,c,u,d,p,f,m,v,y,b,D,P,_,C,A,M,k,x,w,S,R,T,N,O,F,E,B,G,L,K,I=i.current(),q=I.level(),j=n.advantages,H=n.disadvantages,W=["Magic Level","Martial Knowledge","Zeon"];for(h("XP"),I.update_level(),G=I.mk_remaining(),D=I["Insufficient Martial Knowledge"],D&&(P=D.Name,_=D.Tree),A=I.levels,M=A.length,e(".level").remove(),b=I.magic_projection_imbalances(),E=I.dp_remaining(),v=0;M>v;v++){if(C=A[v],B=E[v],T=e('<div class="panel panel-default level"></div>'),k=0===q?0:v+1,d="<strong>Level "+k+"</strong> (",d+=I.class_change_possible(k)?'<a href="#" class="edit_class" data-level="'+k+'">'+C.Class+"</a>):":C.Class+"):",0===(v+1)%2?d+=' <a href="#" class="characteristic_bonus" data-level="'+k+'">'+("Characteristic"in C?C.Characteristic+" +1":"Select characteristic bonus")+"</a>":"Characteristic"in C&&delete C.Characteristic,k>0&&!("Without any Natural Bonus"in I.Disadvantages)&&(R="Natural Bonus"in C?C["Natural Bonus"]:null,d+=' <a href="#" class="natural_bonus" data-level="'+k+'">'+(R?R+" +"+I.modifier(t[R].Characteristic,k):"Select natural bonus")+"</a>"),l=b[v],"number"==typeof l&&(d+=' <a href="#" class="mp_imbalance" data-level="'+k+'">Magic Projection Imbalance: '+l+"</a>"),x=e('<div class="panel-heading"></div>').html(d),T.append(x),N=e('<div class="panel-body row"></div>'),"Freelancer"===C.Class){for(m=C.Freelancer||[],d="Freelancer Bonuses:",p=m.length,O=[],y=0;p>y;y++)O.push(' <a href="#" class="freelancer_bonus" data-level="'+k+'">'+m[y]+"</a>");
d+=O.join(","),5>p&&(d+=' <a href="#" class="freelancer_bonus btn-xs" data-level="'+k+'"><i class="glyphicon glyphicon-plus"> </i></a>'),x=e('<div class="col-xs-12"></div>').html(d),N.append(x)}B.Total>0&&(d=B.Total+" DP remaining (Limits: "+B.Combat+" Combat, "+B.Psychic+" Psychic, "+B.Supernatural+" Supernatural","Human"!==I.Type&&(d+=", "+B.Powers+" Powers"),d+=", "+B.Other+" Other",d+=")",x=e('<div class="col-xs-12"></div>').html(d),N.append(x)),N.append('<div class="col-xs-1"><strong>DP</strong></div>'),O=[],f=C.DP;for(S in f)if(f.hasOwnProperty(S)){if(F=r.for_ability(S),0===S.indexOf("Save "))x=f[S]+" "+F+' DP saved for later <span class="name" style="display: none;">'+S+"</span>";else if(S in s)x='<span class="name">'+S+"</span> (",x+=f[S].join(", ")+")";else if(S in o)x='<span class="name">'+S+"</span>",o[S].Option_Title&&(x+=" ("+f[S].join(", ")+")");else{if("Accumulation Multiple"===S||"Ki"===S){c=B.Combat;for(u in f[S])f[S].hasOwnProperty(u)&&(x='<span class="name">'+S+"</span> (",x+=u+"): "+f[S][u],O.push('<a href="#" class="ability" data-available="'+c+'" data-level="'+k+'" data-characteristic="'+u+'">'+x+"</a>"));continue}l=f[S],e.inArray(S,W)>=0&&(l*=5),x='<span class="name">'+S+"</span> (+"+l+")"}if(c=S in B?B[S]:B[F],S in j||S in H)continue;O.push('<a href="#" class="ability" data-available="'+c+'" data-level="'+k+'">'+x+"</a>")}if("Class_Change"in B&&O.push("Class change ("+B.Class_Change+")"),d=O.join(", "),K=B.Withdrawn){d+=" [used ",y=0;for(F in K)K.hasOwnProperty(F)&&(y>0&&(d+=", "),d+=K[F]+" "+F,y++);d+=" DP saved earlier]"}B.Total>0&&(d+=' <a href="#" class="spend_dp btn-xs" data-level="'+k+'"><i class="glyphicon glyphicon-plus"> </i></a>'),x=e('<div class="col-xs-11">'+d+"</div>"),N.append(x),c=G[v],c>0&&(N.append('<div class="clearfix"></div>'),d=c+" MK spendable at this level",x=e('<div class="col-xs-12">').html(d),N.append(x)),N.append('<div class="clearfix"></div>'),N.append('<div class="col-xs-1"><strong>MK</strong></div>'),O=[],w=C.MK;for(S in w)if(w.hasOwnProperty(S))if(S in a)x='<span class="name">'+S+"</span>",a[S].Option_Title&&(x+=': <span class="options">'+w[S].Options.join(", ")+"</span>"),P!==S||_||(x+=" (POW",l=D.Penalty,0>l&&(x+=" "+l),x+=" check to use)"),O.push('<a href="#" class="delete_ki_ability" data-level="'+k+'">'+x+"</a>");else for(p=w[S].length,y=0;p>y;y++)L=w[S][y],x='<span class="tree">'+S+'</span>: <span class="technique">'+L.Name,_===S&&P===L.Name&&(x+=" (POW",l=D.Penalty,0>l&&(x+=" "+l),x+=" check to use)"),x+="</span>",O.push('<a href="#" class="delete_dominion_technique" data-level="'+k+'">'+x+"</a>");d=O.join(", "),c>=0&&!D&&(d+=' <a href="#" class="spend_mk btn-xs" data-level="'+k+'"><i class="glyphicon glyphicon-plus"> </i></a>'),x=e('<div class="col-xs-11">'+d+"</div>"),N.append(x),T.append(N),e("#levels").append(T)}g.render(e(".container"))},g}),define("libs/util",["require","jquery"],function(e,t){function i(e,i){return(e.textContent||e.innerText||t(e).text()||"").toLowerCase()===(i||"").toLowerCase()}t.expr[":"].fuelTextExactCI=t.expr.createPseudo?t.expr.createPseudo(function(e){return function(t){return i(t,e)}}):function(e,t,n){return i(e,n[3])}}),define("libs/combobox",["require","jquery","libs/util"],function(e,t){var i=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.combobox.defaults,i),this.$element.on("click","a",t.proxy(this.itemclicked,this)),this.$element.on("change","input",t.proxy(this.inputchanged,this)),this.$input=this.$element.find("input"),this.$button=this.$element.find(".btn"),this.setDefaultSelection()};i.prototype={constructor:i,selectedItem:function(){var e=this.$selectedItem,i={text:this.$input.val()};return e&&(i=t.extend(i,e.data())),i},selectByText:function(e){var t="li:fuelTextExactCI("+e+")";this.selectBySelector(t)},selectByValue:function(e){var t="li[data-value="+e+"]";this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);t[0]!==void 0?(this.$selectedItem=t,this.$input.val(this.$selectedItem.text())):this.$selectedItem=null},setDefaultSelection:function(){var e="li[data-selected=true]:first",t=this.$element.find(e);t.length>0&&(this.selectBySelector(e),t.removeData("selected"),t.removeAttr("data-selected"))},enable:function(){this.$input.removeAttr("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$input.attr("disabled",!0),this.$button.addClass("disabled")},itemclicked:function(e){this.$selectedItem=t(e.target).parent(),this.$input.val(this.$selectedItem.text()).trigger("change",{synthetic:!0});var i=this.selectedItem();this.$element.trigger("changed",i),e.preventDefault()},inputchanged:function(e,i){if(!i||!i.synthetic){var n=t(e.target).val();this.selectByText(n);var a=this.selectedItem();0===a.text.length&&(a={text:n}),this.$element.trigger("changed",a)}}},t.fn.combobox=function(e,n){var a,s=this.each(function(){var s=t(this),o=s.data("combobox"),r="object"==typeof e&&e;o||s.data("combobox",o=new i(this,r)),"string"==typeof e&&(a=o[e](n))});return void 0===a?s:a},t.fn.combobox.defaults={},t.fn.combobox.Constructor=i,t(function(){t(window).on("load",function(){t(".combobox").each(function(){var e=t(this);e.data("combobox")||e.combobox(e.data())})}),t("body").on("mousedown.combobox.data-api",".combobox",function(){var e=t(this);e.data("combobox")||e.combobox(e.data())})})});var JSON;JSON||(JSON={}),function(){function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,a,s,o,r=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?l+"":"null";case"boolean":case"null":return l+"";case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(s=l.length,i=0;s>i;i+=1)o[i]=str(i,l)||"null";return a=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+r+"]":"["+o.join(",")+"]",gap=r,a}if(rep&&"object"==typeof rep)for(s=rep.length,i=0;s>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],a=str(n,l),a&&o.push(quote(n)+(gap?": ":":")+a));else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(a=str(n,l),a&&o.push(quote(n)+(gap?": ":":")+a));return a=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+r+"}":"{"+o.join(",")+"}",gap=r,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var i,n,a=e[t];if(a&&"object"==typeof a)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n=walk(a,i),void 0!==n?a[i]=n:delete a[i]);return reviver.call(e,t,a)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("libs/json2",function(){}),function(e){var t={};e.publish=function(i,n){e.each(t[i],function(){this.apply(e,n||[])})},e.subscribe=function(e,i){return t[e]||(t[e]=[]),t[e].push(i),[e,i]},e.unsubscribe=function(i){var n=i[0];t[n]&&e.each(t[n],function(e){this==i[1]&&t[n].splice(e,1)})}}(jQuery),define("pubsub",function(){}),define("dialogs",["jquery","abilities","advantages","characters","cultural_roots","disadvantages","essential_abilities","ki_abilities","martial_arts","modules","powers","primaries","tables","widgets","combat","creation_points","development_points","libs/combobox","libs/json2","pubsub"],function(e,t,i,n,a,s,o,r,l,c,u,d,p,h){var f,m,g,v,y,b,D,P,_,C,A,M,k,x,w,S,R,T,N,O,F,E,B,G,L,K,I,q,j,H,W,$,z,U,V,X,Z,J,Q,Y,et,tt,it,nt,at,st,ot,rt,lt,ct,ut,dt,pt,ht,ft,mt,gt,vt,yt,bt,Dt,Pt,_t,Ct,At,Mt,kt,xt,wt,St,Rt,Tt,Nt,Ot=h.create_dialog,Ft=h.create_spinner,Et={};return f=function(){e("#ability_specialization").combobox(),Ot("ability_dp_dialog","Amount of DP to Spend","Cancel","OK",function(){var t=n.current(),i=e("#ability_characteristic").text(),a=parseInt(e("#ability_cost").val(),10),s=e("#ability_dp").spinner("value"),o=parseInt(e("#ability_level").val(),10),r=t.level_info(o),l=e("#ability_name").text(),c=e("#ability_specialization").combobox("selectedItem").text;return s?(i?(l in r.DP||(r.DP[l]={}),r.DP[l][i]=s/a):(r.DP[l]=s/a,c?("Specializations"in t||(t.Specializations={}),t.Specializations[l]=c):"Specializations"in t&&l in t.Specializations&&delete t.Specializations[l]),e.publish("level_data_changed")):l in r.DP&&(i?(delete r.DP[l][i],0===Object.keys(r.DP[l]).length&&delete r.DP[l]):delete r.DP[l],e.publish("level_data_changed")),e("#ability_dp_dialog").modal("hide"),!1})},m=function(){var t,a,s,o,r,l=n.current();for(s in i)if(i.hasOwnProperty(s))for(r=e('#advantages_tabs a:contains("'+s+'")'),t=r.size(),a=0;t>a;a++)o=r.eq(a),o.text()===s&&(l.advantage_allowed(s,null)?o.removeClass("disabled"):o.addClass("disabled"));return e("#advantages_dialog").modal("show"),!1},g=function(t,i){var n,a,s,o,r=['<select class="form-control">'];for(s in i)i.hasOwnProperty(s)&&(r.push('<option value="',s,'">'),n=s,r.push(n),a=i[s],e.isPlainObject(a)&&(o=Object.keys(a)[0],r.push(" (",o,")"),a=a[o]),r.push(" +",a,"</option>"));r.push("</select><br />"),e("#cultural_roots").append(r.join(""))},v=function(){var t,i,a=n.current();for(t in s)s.hasOwnProperty(t)&&(i=e('#disadvantages_tabs a:contains("'+t+'")'),a.disadvantage_allowed(t,null)?i.removeClass("disabled"):i.addClass("disabled"));return e("#disadvantages_dialog").modal("show"),!1},y=function(){var t=e(this),i=t.data("available"),n=t.data("level");return e("#mk_dialog").modal("hide"),e("#dominion_character_level").val(n),e("#dominion_tree").val(""),e("#dominion_name").val(""),e("#dominion_technique_dialog").modal("show"),e("#dominion_technique_dialog .spinner-buttons").length?(e("#dominion_level").spinner("value",1),e("#dominion_mk").spinner("value",20),e("#dominion_mk").spinner("max",i)):(Ft("#dominion_level",{min:1,max:3,value:1}),Ft("#dominion_mk",{min:10,max:i,value:20})),!1},b=function(){var t,i,a,s,r,l,c=o.advantages,u=n.current();for(s in c)if(c.hasOwnProperty(s))for(l=e('#ea_advantages_tabs a:contains("'+s+'")'),i=l.size(),a=0;i>a;a++)r=l.eq(a),r.text()===s&&(t=u.essential_ability_allowed(s,null),"maybe"===t?(r.removeClass("disabled"),r.addClass("maybe")):t?(r.removeClass("disabled"),r.removeClass("maybe")):(r.addClass("disabled"),r.removeClass("maybe")));return e("#ea_advantages_dialog").modal("show"),!1},D=function(){var t,i,a,s=n.current(),r=o.disadvantages;for(i in r)r.hasOwnProperty(i)&&(a=e('#ea_disadvantages_tabs a:contains("'+i+'")'),t=s.essential_ability_allowed(i,null),"maybe"===t?(a.removeClass("disabled"),a.addClass("maybe")):t?(a.removeClass("disabled"),a.removeClass("maybe")):(a.addClass("disabled"),a.removeClass("maybe")));return e("#ea_disadvantages_dialog").modal("show"),!1},P=function(){var t=n.current(),i=e(this).data("level"),a=e.trim(e(this).find(".name").text()),s=r[a];return e("#mk_dialog").modal("hide"),"Options"in s?F(a,i):(t.add_ki_ability(a,i),e.publish("level_data_changed"),!1)},_=function(){var t=n.current(),i=e(this),a=i.find(".degree").text(),s=parseInt(i.data("level"),10),o=i.find(".name").text();return e("#dp_dialog").modal("hide"),t.add_martial_art(o,a,s),e.publish("level_data_changed"),!1},C=function(){var t,i,a,s,o=n.current(),r=e(this),l=parseInt(r.data("level"),10),u=r.find(".name").text(),d=c[u],p=d.Option_Title;return e("#dp_dialog").modal("hide"),!p&&o.has_module(u)?!1:p?(e("#module_options_name").val(u),e("#module_options_level").val(l),a=e("#module_options"),a.html(""),i=d.Options,0===i.length?(t=e("<input>",{type:"text",value:""}).addClass("form-control required"),a.append(t)):(s=e("<select>").addClass("form-control"),e.each(i,function(t,i){o.has_module(u,i)||s.append(e("<option>",{value:i}).text(i))}),a.append(s)),e("#module_options_dialog h4").text(d.Option_Title),e("#module_options_dialog").modal("show"),!1):(o.add_module(u,l),e.publish("level_data_changed"),!1)},A=function(){return e("#xp_dialog").modal("show"),e("#xp_dialog").find(".spinner-buttons").length?e("#xp_added").spinner("value",0):Ft("#xp_added",{min:0,max:9999,value:0}),!1},M=function(){Ot("advantage_cost_dialog","Spend how many creation points on it?","Cancel","OK",function(){var t,a,s=parseInt(e("input:radio[name=advantage_cost]:checked").val(),10),o=e("#advantage_cost_name").val();return t=i[o],"Options"in t?(e("#advantage_cost_dialog").modal("hide"),st(o,s)):(a=n.current(),a.Advantages[o]=s,e.publish("cp_changed"),e("#advantage_cost_dialog").modal("hide")),!1})},k=function(){Ot("advantage_options_dialog","","Cancel","OK",function(){var t,i,a,s,o,r=e("#advantage_options_cost").val(),l=e("#advantage_options_name").val();return r=r?parseInt(r,10):null,"Repeat a Characteristics Roll"===l?(t=e("#advantage_options select").val(),s=e("#repeat_roll").spinner("value"),isNaN(s)&&(s=5),a={Characteristic:t,Roll:s}):(o=e("#advantage_options select"),a=o.length>0?o.val():e("#advantage_options input").val()),i=n.current(),i.add_advantage(l,r,a),e.publish("cp_changed"),e("#advantage_options_dialog").modal("hide"),!1})},x=function(){var t,n,a;for(a in i)i.hasOwnProperty(a)&&(t=i[a],n=e("<a>",{href:"#"}).addClass("advantage").text(a),n.append("<br />"),"Category"in t?e("#"+t.Category+"_Advantages").append(n):e("#Common_Advantages").append(n));Ot("advantages_dialog","Select an advantage","Cancel")},w=function(){Ot("characteristic_bonus_dialog","Select the characteristic to increase","Cancel","OK",function(){var t=n.current(),i=parseInt(e("#dialog_level").val(),10);return t.levels[i-1].Characteristic=e("#Characteristic").val(),e("#characteristic_bonus_dialog").modal("hide"),e.publish("level_data_changed"),!1})},S=function(){Ot("class_dialog",'Select class for level <span id="class_dialog_level"></span>',"Cancel","OK",function(){var t=n.current(),i=parseInt(e("#class_dialog_level").text(),10);return t.change_class(i,e("#Class").val()),e("#class_dialog").modal("hide"),e.publish("level_data_changed"),!1})},R=function(){var t=e(this),i=parseInt(t.data("available"),10),n=t.data("characteristic"),a=parseInt(t.data("level"),10),s=t.find(".name").text();return e("#dp_dialog").modal("hide"),s in l?z(s,a):s in c?V(s,a):n||"Accumulation Multiple"!==s&&"Ki"!==s?kt(s,a,i,n):(e("#ki_characteristic_available").val(i),e("#ki_characteristic_level").val(a),e("#ki_characteristic_name").val(s),e("#ki_characteristic_dialog").modal("show"),!1)},T=function(){var t=e.trim(e(this).text()),a=n.current(),s=i[t];return a.advantage_allowed(t,null)?(e("#advantages_dialog").modal("hide"),"Cultural Roots"===t?(e("#cultural_roots_dialog").modal("show"),!1):e.isArray(s.Cost)?at(t):"Options"in s?st(t,null):(a.Advantages[t]=s.Cost,e.publish("cp_changed"),!1)):!1},N=function(){var t=e.trim(e(this).text()),i=n.current(),a=s[t];return i.disadvantage_allowed(t,null)?(e("#disadvantages_dialog").modal("hide"),e.isArray(a.Benefit)?lt(t):"Options"in a?ct(t,null):(i.Disadvantages[t]=a.Benefit,e.publish("cp_changed"),!1)):!1},O=function(){var t,i=n.current(),a=e.trim(e(this).text());return i.essential_ability_allowed(a,null)?(a in o.advantages?(t=o.advantages[a],e("#ea_advantages_dialog").modal("hide")):(t=o.disadvantages[a],e("#ea_disadvantages_dialog").modal("hide")),"Options"in t?ut(a):(i.add_essential_ability(a),e.publish("essential_abilities_changed"),!1)):!1},F=function(t,i){var a=n.current(),s=r[t],o=s.Option_Title,l=s.Options,c=e("#ki_ability_options"),u=e("<select>").addClass("form-control");return e("#ki_ability_options_name").val(t),e("#ki_ability_options_level").val(i),c.html(""),e.each(l,function(i,n){a.has_ki_ability(t,n)||u.append(e("<option>",{value:n}).text(n))}),c.append(u),e("#ki_ability_options_dialog h4").text(o),e("#ki_ability_options_dialog").modal("show"),!1},E=function(){var t,i=[];for(t in a)a.hasOwnProperty(t)&&(i.push('<option value="'),i.push(t),i.push('">'),i.push(t),i.push("</option>\n"));e("#cultural_roots_background").html(i.join("")),e("#cultural_roots_background").change(Tt),Tt(),Ot("cultural_roots_dialog","Select a background","Cancel","OK",function(){var t=e("#cultural_roots_background").val(),i={Background:t,Choices:[]},a=n.current();return e("#cultural_roots select").each(function(t,n){i.Choices.push(e(n).val())}),a.add_advantage("Cultural Roots",1,i),e.publish("cp_changed"),e("#cultural_roots_dialog").modal("hide"),!1})},B=function(){var t=e(this).data("name");return e("#delete_advantage_name").val(t),e("#delete_advantage_dialog").modal("show"),!1},G=function(){Ot("delete_advantage_dialog","Remove this advantage?","No","Yes",function(){var t=e("#delete_advantage_name").val(),i=n.current();return delete i.Advantages[t],e.publish("cp_changed"),e("#delete_advantage_dialog").modal("hide"),!1})},L=function(){var t=e(this).data("name");return e("#delete_disadvantage_name").val(t),e("#delete_disadvantage_dialog").modal("show"),!1},K=function(){Ot("delete_disadvantage_dialog","Remove this disadvantage?","No","Yes",function(){var t=e("#delete_disadvantage_name").val(),i=n.current();return delete i.Disadvantages[t],e.publish("cp_changed"),e("#delete_disadvantage_dialog").modal("hide"),!1})},q=function(){Ot("delete_dominion_technique_dialog","Remove this Dominion Technique?","No","Yes",function(){var t=n.current(),i=e("#delete_dominion_technique_level").val(),a=e("#delete_dominion_technique_name").val(),s=e("#delete_dominion_technique_tree").val();return t.remove_dominion_technique(s,a,i),e.publish("level_data_changed"),e("#delete_dominion_technique_dialog").modal("hide"),!1})},I=function(){var t=e(this),i=t.data("level"),n=t.find(".name").text(),a=t.find(".tree").text();return e("#delete_dominion_technique_level").val(i),e("#delete_dominion_technique_name").val(n),e("#delete_dominion_technique_tree").val(a),e("#delete_dominion_technique_dialog").modal("show"),!1},j=function(){Ot("delete_ea_dialog","Remove this essential ability?","No","Yes",function(){var t=e("#delete_ea_name").val(),i=n.current();return delete i.levels[0].DP[t],e.publish("essential_abilities_changed"),e("#delete_ea_dialog").modal("hide"),!1})},H=function(){var t=e(this).data("name");return e("#delete_ea_name").val(t),e("#delete_ea_dialog").modal("show"),!1},$=function(){Ot("delete_ki_ability_dialog","Remove this ki ability?","No","Yes",function(){var t=n.current(),i=e("#delete_ki_ability_level").val(),a=e("#delete_ki_ability_name").val(),s=e("#delete_ki_ability_options").val();return s&&(s=s.split(","),e.each(s,function(t,i){s[t]=e.trim(i)})),t.remove_ki_ability(a,i,s),e.publish("level_data_changed"),e("#delete_ki_ability_dialog").modal("hide"),!1})},W=function(){var t=e(this),i=t.data("level"),n=t.find(".name").text(),a=t.find(".options");return e("#delete_ki_ability_level").val(i),e("#delete_ki_ability_name").val(n),a&&(a=a.text()),e("#delete_ki_ability_options").val(a),e("#delete_ki_ability_dialog").modal("show"),!1},U=function(){Ot("delete_martial_art_dialog","Remove this martial art degree?","No","Yes",function(){var t=n.current(),i=e("#delete_martial_art_level").val(),a=e("#delete_martial_art_name").val(),s=e("#delete_martial_art_degree").val();return t.remove_martial_art(a,s,i),e.publish("level_data_changed"),e("#delete_martial_art_dialog").modal("hide"),!1})},z=function(t,i){var a=n.current(),s=a.level_info(i).DP[t],o=s[s.length-1];return e("#delete_martial_art_level").val(i),e("#delete_martial_art_name").val(t),e("#delete_martial_art_degree").val(o),e("#delete_martial_art_dialog").modal("show"),!1},X=function(){Ot("delete_module_dialog","Remove this module?","No","Yes",function(){var t=n.current(),i=e("#delete_module_level").val(),a=e("#delete_module_name").val();return delete t.level_info(i).DP[a],e.publish("level_data_changed"),e("#delete_module_dialog").modal("hide"),!1})},V=function(t,i){return e("#delete_module_level").val(i),e("#delete_module_name").val(t),e("#delete_module_dialog").modal("show"),!1},Z=function(){Ot("disadvantage_benefit_dialog","Gain how many creation points from it?","Cancel","OK",function(){var t=e("#disadvantage_benefit_name").val(),i=s[t],a=parseInt(e("input:radio[name=disadvantage_benefit]:checked").val(),10),o=n.current();return"Options"in i?(e("#disadvantage_benefit_dialog").modal("hide"),ct(t,a)):(o.Disadvantages[t]=a,e.publish("cp_changed"),e("#disadvantage_benefit_dialog").modal("hide")),!1})},J=function(){Ot("disadvantage_option_dialog","","Cancel","OK",function(){var t,i=e("#disadvantage_option_name").val(),a=e("#disadvantage_option_benefit").val(),s=e("#disadvantage_option select"),o=n.current();return a=a?parseInt(a,10):null,t=s.length>0?s.val():e("#disadvantage_option input").val(),o.add_disadvantage(i,a,t),e.publish("cp_changed"),e("#disadvantage_option_dialog").modal("hide"),!1})},Q=function(){var t,i,n;for(n in s)s.hasOwnProperty(n)&&(t=s[n],i=e("<a>",{href:"#"}).addClass("disadvantage").text(n),i.append("<br />"),"Category"in t?e("#"+t.Category+"_Disadvantages").append(i):e("#Common_Disadvantages").append(i));Ot("disadvantages_dialog","Select a disadvantage","Cancel")},Y=function(){Ot("dominion_technique_dialog","Enter a Dominion Technique","Cancel","OK",function(){var t=e("#dominion_character_level").val(),i=n.current(),a=[],s=e("#dominion_level").spinner("value"),o=e("#dominion_mk").spinner("value"),r=e("#dominion_name").val(),l=e("#dominion_tree").val();return 1>l.length&&a.push("Tree is required"),1>r.length&&a.push("Name is required"),1===s&&o>50?a.push("MK too high for a level 1 technique"):2===s&&20>o?a.push("MK too low for a level 2 technique"):2===s&&o>100?a.push("MK too high for a level 2 technique"):3===s&&30>o&&a.push("MK too low for a level 3 technique"),a.length>0?e("#dominion_technique_dialog .text-error").html(a.join("<br />")):(i.add_dominion_technique(l,r,s,o,t),e.publish("level_data_changed"),e("#dominion_technique_dialog").modal("hide")),!1})},et=function(){var i,n,a,s,o,r,l;for(o in d)if(d.hasOwnProperty(o))for(l=d[o],n=l.length,a=0;n>a;a++)i=l[a],"Life Points"!==i&&(r=['<a href="#" class="ability"><span class="name">',i,'</span></a> (<span class="cost"></span>)<br />'],i in t&&"Field"in t[i]?e("#DP_"+t[i].Field).append(r.join("")):("Combat"===o&&(o="Combat_Abilities"),e("#"+o).append(r.join(""))));a=1;for(o in c)c.hasOwnProperty(o)&&(s=c[o],r=['<a href="#" class="add_module"><span class="name">',o,'</span></a> (<span class="cost">',s.DP,"</span>)<br />"],l=s.Primary,"Combat"===l&&(l="Combat_Modules_"+(24>a?1:2)),e("#"+l).append(r.join("")),a++);Ot("dp_dialog","Spend DP on...","Cancel")},tt=function(){var t,i,n,a,s=o.advantages;for(n in s)s.hasOwnProperty(n)&&(t=s[n],i=e("<a>",{href:"#"}).addClass("essential_ability").text(n),a=" ("+t.DP+", Gnosis "+t.Gnosis+"+)<br />","Category"in t?e("#EA_"+t.Category+"_Advantages").append(i).append(a):e("#EA_Common_Advantages").append(i).append(a));Ot("ea_advantages_dialog","Select an essential ability","Cancel")},it=function(){var t,i,n,a,s=o.disadvantages;for(t in s)s.hasOwnProperty(t)&&(i=s[t],n=e("<a>",{href:"#"}).addClass("essential_ability").text(t),a=" ("+-i.DP+", Gnosis "+i.Gnosis+"+)<br />","Category"in i?e("#EA_"+i.Category+"_Disadvantages").append(n).append(a):e("#EA_Common_Disadvantages").append(n).append(a));Ot("ea_disadvantages_dialog","Select an essential ability disadvantage","Cancel")},nt=function(){Ot("ea_option_dialog","","Cancel","OK",function(){var t,i=n.current(),a=e("#ea_option_name").val(),s=e("#ea_option select");return t=s.length>0?s.val():e("#ea_option input").val(),i.add_essential_ability(a,t),e.publish("essential_abilities_changed"),e("#ea_option_dialog").modal("hide"),!1})},at=function(t){var a=n.current(),s=i[t],o="Category"in s?s.Category:"Common",r=a.cp_remaining(o),l=i[t].Cost;return e("#advantage_cost_name").val(t),"Common"!==o&&(r+=a.cp_remaining("Common")),e.each([1,2,3],function(t,i){i>r||-1===e.inArray(i,l)?e(".advantage_cost_"+i).hide():e(".advantage_cost_"+i).show()}),e("#advantage_cost_"+l[0]).click(),e("#advantage_cost_dialog").modal("show"),!1},st=function(t,a){var s,o,r,l,c=i[t],u=e("#advantage_options");return e("#advantage_options_name").val(t),e("#advantage_options_cost").val(a?a:""),u.html(""),r=c.Options,0===r.length?(o=e("<input>",{type:"text",value:""}).addClass("form-control required"),u.append(o)):(l=e("<select>").addClass("form-control"),s=n.current(),e.each(r,function(i,n){s.advantage_allowed(t,n)&&l.append(e("<option>",{value:n}).text(n))}),u.append(l),"Repeat a Characteristics Roll"===t&&(u.append(e("<br />")),u.append(e("<label>",{"for":"repeat_roll"}).text("New Roll ")),u.append(e('<div id="repeat_roll" class="spinner"></div>')))),e("#advantage_options_dialog .modal-header h4").text(c.Option_Title),e("#advantage_options_dialog").modal("show"),Ft("#repeat_roll",{min:4,max:10,value:5}),!1},ot=function(){var t=e(this).data("level"),i=n.current(),a=0===t?0:t-1;return e("#dialog_level").val(t),"Characteristic"in i.levels[a]?e("#Characteristic").val(i.levels[a].Characteristic):e("#Characteristic").val("STR"),e("#characteristic_bonus_dialog").modal("show"),!1},rt=function(){var t=n.current(),i=e(this).data("level");return e("#class_dialog_level").text(i),e("#Class").val(t.levels[0===i?0:i-1].Class),e("#class_dialog").modal("show"),!1},lt=function(t){return e("#disadvantage_benefit_name").val(t),e("#disadvantage_benefit_1").click(),e("#disadvantage_benefit_dialog").modal("show"),!1},ct=function(t,i){var a,o,r,l,c,u=s[t];return e("#disadvantage_option_name").val(t),e("#disadvantage_option_benefit").val(i?i:""),a=e("#disadvantage_option"),a.html(""),o=u.Options,0===o.length?(r=e("<input>",{type:"text",value:""}).addClass("form-control required"),a.append(r)):(l=n.current(),c=e("<select>").addClass("form-control"),e.each(o,function(i,n){l.disadvantage_allowed(t,n)&&c.append(e("<option>",{value:n}).text(n))}),a.append(c)),e("#disadvantage_option_dialog h4").text(u.Option_Title),e("#disadvantage_option_dialog").modal("show"),!1},ut=function(t){var i,a,s,r,l,c=o.advantages,u=e("#ea_option");return i=t in c?c[t]:o.disadvantages[t],e("#ea_option_name").val(t),u.html(""),r=i.Options,0===r.length?(s=e("<input>",{type:"text",value:""}).addClass("form-control required"),u.append(s)):(l=e("<select>").addClass("form-control"),a=n.current(),e.each(r,function(i,n){a.essential_ability_allowed(t,n)&&l.append(e("<option>",{value:n}).text(n))}),u.append(l)),e("#ea_option_dialog h4").text(i.Option_Title),e("#ea_option_dialog").modal("show"),!1},dt=function(){var t=n.current(),i=e(this),a=parseInt(i.data("level"),10),s=t.level_info(a),o=s.Freelancer,r=i.text();return"+"===r&&(r=""),e("#freelancer_name").val(r),e("#freelancer_level").val(a),e("#Freelancer a").each(function(){r=e(this).text(),o&&e.inArray(r,o)>=0?i.addClass("disabled"):i.removeClass("disabled")}),e("#freelancer_dialog").modal("show"),!1},pt=function(){var t,i,a=n.current(),s=a.magic_projection_imbalances(),o=s.length,r=e(this).data("level"),l=0===r?0:r-1,c=-30,u=30,d=s[l];return e("#mp_imbalance_level").val(r),l>0&&(t=s[l-1],"number"==typeof t&&(c=Math.max(c,t-10),u=Math.min(u,t+10))),o-1>l&&(t=s[l+1],c=Math.max(c,t-10),u=Math.min(u,t+10)),e("#mp_imbalance_dialog .spinner-buttons").length?(i=e("#mp_imbalance"),i.spinner("min",c),i.spinner("max",u),i.spinner("value",d)):Ft("#mp_imbalance",{min:-30,max:30,value:d}),e("#mp_imbalance_dialog").modal("show"),!1},ht=function(){var i,a,s,o,r=e(this).data("level"),l=n.current();e("#natural_bonus_level").val(r),e.each(p.fields,function(t,i){e("#NB_"+i).html("")});for(a in t)if(t.hasOwnProperty(a)){if(s=t[a],!("Field"in s))continue;i=l.modifier(s.Characteristic,r),0>=i?e("#NB_"+s.Field).append(a+"<br />"):(o=['<a href="#" class="set_natural_bonus" data-name="',a,'">',a," +",i,"</a><br />"],e("#NB_"+s.Field).append(o.join("")))}return e("#natural_bonus_dialog").modal("show"),!1},ft=function(){var i,n,a,s=d.Other,o=s.length;for(n=0;o>n;n++)i=s[n],a=['<a href="#" class="freelancer">',i,"</a><br />"],i in t&&"Field"in t[i]&&e("#Freelancer_"+t[i].Field).append(a.join(""));Ot("freelancer_dialog","Add Freelancer bonus to...","Cancel")},mt=function(){Ot("ki_ability_options_dialog","","Cancel","OK",function(){var t,i=n.current(),a=parseInt(e("#ki_ability_options_level").val(),10),s=e("#ki_ability_options_name").val();return t=e("#ki_ability_options select").val(),i.add_ki_ability(s,a,t),e("#ki_ability_options_dialog").modal("hide"),e.publish("level_data_changed"),!1})},gt=function(){Ot("ki_characteristic_dialog","For which characteristic?","Cancel","OK",function(){var t=parseInt(e("#ki_characteristic_available").val(),10),i=e("#Ki_Characteristic").val(),n=parseInt(e("#ki_characteristic_level").val(),10),a=e("#ki_characteristic_name").val();return e("#ki_characteristic_dialog").modal("hide"),kt(a,n,t,i)})},vt=function(){return e("#load_text").val(""),e("#load_dialog").modal("show"),e("#load_text").focus(),!1},yt=function(){Ot("load_dialog","Load Character","Cancel","OK",function(){var t,i=n.current(),a=JSON.parse(e("#load_text").val());if(a){i.clear();for(t in a)a.hasOwnProperty(t)&&(i[t]=a[t]);e.publish("data_loaded")}return e("#load_dialog").modal("hide"),!1}),e("#load_dialog").on("shown.bs.modal",function(){e("#load_text").focus()})},bt=function(){var t,i,n,a="Use of Nemesis";for(n in r)r.hasOwnProperty(n)&&(t=r[n],i=['<a href="#" class="add_ki_ability"><span class="name">',n,"</span></a> (",t.MK,")<br />"].join(""),n===a||"Requirements"in t&&-1!==e.inArray(a,t.Requirements)?e("#Nemesis_Abilities").append(i):e("#Ki_Abilities").append(i));Ot("mk_dialog","Select a Ki Ability or Dominion Technique","Cancel")},Dt=function(){Ot("module_options_dialog","","Cancel","OK",function(){var t,i,a=n.current(),s=parseInt(e("#module_options_level").val(),10),o=e("#module_options_name").val();return i=e("#module_options select"),t=i.length>0?i.val():e("#module_options input").val(),a.add_module(o,s,t),e("#module_options_dialog").modal("hide"),e.publish("level_data_changed"),!1})},Pt=function(){Ot("mp_imbalance_dialog","Magic Projection Imbalance","Cancel","OK",function(){var t=n.current(),i=e("#mp_imbalance").spinner("value"),a=parseInt(e("#mp_imbalance_level").val(),10),s=t.level_info(a);return s["Magic Projection Imbalance"]=i,e("#mp_imbalance_dialog").modal("hide"),e.publish("level_data_changed"),!1})},_t=function(){Ot("natural_bonus_dialog","Select an ability to improve","Cancel")},Ct=function(){Ot("power_options_dialog","","Cancel","OK",function(){var t,i,a,s,o,r=parseInt(e("#power_options_level").val(),10),l={Name:e("#power_options_name").val()},c=e("#power_options_type").val();for(o=e('#power_options input[type="text"], #power_options select'),t=o.length,a=0;t>a;a++)s=o.eq(a),l[s.attr("name")]=s.val();
for(o=e('#power_options input[type="checkbox"]:checked'),t=o.length,a=0;t>a;a++)l[s.attr("name")]=!0;return i=n.current(),i.add_power(c,r,l),e.publish("level_data_changed"),e("#power_options_dialog").modal("hide"),!1})},At=function(){var t=n.current();return e("#save_text").val(JSON.stringify(t,null,2)),e("#save_dialog").modal("show"),!1},Mt=function(){Ot("save_dialog","Save Character","OK"),e("#save_dialog").on("shown.bs.modal",function(){e("#save_text").focus().select()})},kt=function(i,a,s,o){var r,l,c,u,p,h=t[i],f=n.current(),m=f.level_info(a),g=m.Class,v=f.dp_cost(i,g),y=Math.floor(s/v)*v,b=e("#ability_dp_parent"),D=m.DP[i],P=y;if(o&&D&&(D=D[o]),D&&(P=D*v,y+=P),e("#ability_name").text(i),e("#ability_details").toggle(o?!0:!1),e("#ability_characteristic").text(o?o:""),e("#ability_cost").val(v),e("#ability_level").val(a),e("#ability_limit").text(""+y),0===i.indexOf("Save ")?(e("#ability_primary").text(d.for_ability(i)),e("#ability_spend").hide(),e("#ability_save").show()):(e("#ability_save").hide(),e("#ability_spend").show()),h&&(p=h.specializations),p){for(l=e("#ability_specialization .dropdown-menu"),l.html(""),r=p.length,c=0;r>c;c++)l.append('<li><a href="#">'+p[c]+"</a></li>");p=f.Specializations,p&&(u=p[i],u?e("#ability_specialization input").val(u):e("#ability_specialization input").val("")),e("#specialization_label, #ability_specialization").show()}else e("#ability_specialization input").val(""),e("#specialization_label, #ability_specialization").hide();return b.html(""),b.append(e('<div id="ability_dp" class="spinner"></div><br /><br />')),e("#ability_dp_dialog").modal("show"),Ft("#ability_dp",{min:0,max:y,step:v,value:P}),!1},xt=function(){var t=n.current(),i=parseInt(e("#freelancer_level").val(),10),a=e(this).text(),s=e("#freelancer_name").val();return t.set_freelancer_bonus(i,a,s),e("#freelancer_dialog").modal("hide"),e.publish("level_data_changed"),!1},wt=function(){var t=e(this).data("name"),i=parseInt(e("#natural_bonus_level").val(),10),a=n.current();return a.set_natural_bonus(i,t),e("#natural_bonus_dialog").modal("hide"),e.publish("level_data_changed"),!1},St=function(){var t,i,a,s,o,r,u,p,h,f,m,g,v,y,b,D,P,_,C=n.current(),A=C["Damage Resistance"],M=e(this).data("level"),k=0===M?0:M-1,x=C.levels[k].Class,w=C.dp_remaining(),S=w[k],R=C.new_martial_art_allowed(M);e('#Other a:contains("Life Point") .name').text(A?"Life Points":"Life Point Multiple");for(y in d)if(d.hasOwnProperty(y))for(s=S["Other"===y?"Total":y],P=d[y],u=P.length,h=0;u>h;h++)for(t=P[h],m=e('#dp_tabs a:contains("'+t+'")'),g=m.size(),f=0;g>f;f++)v=m.eq(f),v.text()===t&&(r=C.dp_cost(t,x),v.next(".cost").text(r),o=s,t in S&&(o=S[t]),v.data("available",o),v.data("level",M),r>o?v.addClass("disabled"):v.removeClass("disabled"));for(a=C.martial_arts(),b=Object.keys(l).sort(),u=b.length,s=S.Combat,e("#Basic_Martial_Arts").html(""),e("#Advanced_Martial_Arts").html(""),h=0;u>h;h++){if(y=b[h],i=l[y],_="Supreme"in i?"Basic":"Advanced",y in a){if(p=a[y].Degree,"Supreme"===p||"Arcane"===p){e("#"+_+"_Martial_Arts").append(y+"<br />");continue}p="Advanced"===_?"Arcane":"Advanced"===p?"Supreme":"Advanced"}else p="Base";r=C.dp_cost(y,x,p),D=s>=r&&C.martial_art_allowed(y,p,M)&&(R||"Base"!==p)?['<a href="#" class="add_martial_art" data-level="',M,'"><span class="name">',y,'</span> [<span class="degree">',p,"</span>]</a> (",r,")<br />"]:[y," [",p,"] (",r,")<br />"],e("#"+_+"_Martial_Arts").append(D.join(""))}for(y in c)if(c.hasOwnProperty(y))for(t=c[y],s=S[t.Primary],m=e('#dp_tabs a:contains("'+y+'")'),g=m.size(),h=0;g>h;h++)v=m.eq(h),v.text()===y&&(r=t.DP,v.next(".cost").text(r),v.data("available",s),v.data("level",M),r>s?v.addClass("disabled"):v.removeClass("disabled"));return e("#dp_dialog").modal("show"),!1},Rt=function(){var t,i,a,s,o,l,c,u,d,p=n.current(),h=e(this).data("level"),f=0===h?0:h-1,m=p.mk_remaining()[f]+50;for(l in r)if(r.hasOwnProperty(l))for(t=r[l],s=e('#mk_tabs a:contains("'+l+'")'),i=s.size(),f=0;i>f;f++)if(o=s.eq(f),o.text()===l)if(o.removeClass("disabled"),o.data("level",h),t.MK>m)o.addClass("disabled");else if(p.has_ki_ability(l))if("Options"in t)for(c=t.Options,u=c.length,o.addClass("disabled"),a=0;u>a;a++)p.has_ki_ability(l,c[a])||o.removeClass("disabled");else o.addClass("disabled");else if("Requirements"in t)for(d=t.Requirements,u=d.length,a=0;u>a;a++)if(!p.has_ki_ability(d[a],null,h)){o.addClass("disabled");break}return e("#add_dominion_technique").data("available",m),e("#add_dominion_technique").data("level",h),e("#mk_dialog").modal("show"),!1},Tt=function(){e("#cultural_roots").html("");var t,i,n,s,o,r=e("#cultural_roots_background").val(),l=a[r];for(o in l)"choices"===o?e.each(l[o],g):(i=o,t=[i],n=l[o],e.isPlainObject(n)&&(s=Object.keys(n)[0],t.push(" ("),t.push(s),t.push(")"),n=n[s]),t.push(" +"),t.push(n),t.push("<br />"),e("#cultural_roots").append(t.join("")))},Nt=function(){Ot("xp_dialog","Add Experience Points","Cancel","OK",function(){var t=n.current(),i=e("#xp_added").spinner("value");return t.XP+=i,e("#XP").spinner("value",t.XP),e.publish("level_data_changed"),e("#xp_dialog").modal("hide"),!1})},e(document).ready(function(){f(),M(),k(),x(),w(),S(),E(),G(),K(),q(),j(),$(),U(),X(),Z(),J(),Q(),Y(),et(),tt(),it(),nt(),ft(),mt(),gt(),yt(),bt(),Dt(),Pt(),_t(),Ct(),Mt(),Nt(),e("#add_advantage").click(m),e("#add_disadvantage").click(v),e("#add_dominion_technique").click(y),e("#add_xp").click(A),e(document).on("click","#advantages_tabs a.advantage",T),e(document).on("click","#disadvantages_tabs a.disadvantage",N),e("#add_ea_advantage").click(b),e("#add_ea_disadvantage").click(D),e(document).on("click","a.ability",R),e(document).on("click","a.add_martial_art",_),e(document).on("click","a.add_module",C),e(document).on("click","a.edit_class",rt),e(document).on("click","a.freelancer_bonus",dt),e(document).on("click","a.essential_ability",O),e(document).on("click","a.characteristic_bonus",ot),e(document).on("click","a.add_ki_ability",P),e(document).on("click","a.delete_dominion_technique",I),e(document).on("click","a.delete_ki_ability",W),e(document).on("click","a.mp_imbalance",pt),e(document).on("click","a.natural_bonus",ht),e(document).on("click","a.set_natural_bonus",wt),e(document).on("click","a.spend_dp",St),e(document).on("click","a.spend_mk",Rt),e(document).on("click","#Advantages a",B),e(document).on("click","#Disadvantages a",L),e(document).on("click","#ea_advantages a",H),e(document).on("click","#ea_disadvantages a",H),e(document).on("click","#Freelancer a",xt),e("#save_button").click(At),e("#load_button").click(vt)}),Et}),function(e){e.extend(e.fn,{validate:function(t){if(this.length){var i=e.data(this[0],"validator");return i?i:(i=new e.validator(t,this[0]),e.data(this[0],"validator",i),i.settings.onsubmit&&(this.find("input, button").filter(".cancel").click(function(){i.cancelSubmit=!0}),i.settings.submitHandler&&this.find("input, button").filter(":submit").click(function(){i.submitButton=this}),this.submit(function(t){function n(){if(i.settings.submitHandler){if(i.submitButton)var t=e("<input type='hidden'/>").attr("name",i.submitButton.name).val(i.submitButton.value).appendTo(i.currentForm);return i.settings.submitHandler.call(i,i.currentForm),i.submitButton&&t.remove(),!1}return!0}return i.settings.debug&&t.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,n()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):n():(i.focusInvalid(),!1)})),i)}t&&t.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing")},valid:function(){if(e(this[0]).is("form"))return this.validate().form();var t=!0,i=e(this[0].form).validate();return this.each(function(){t&=i.element(this)}),t},removeAttrs:function(t){var i={},n=this;return e.each(t.split(/\s/),function(e,t){i[t]=n.attr(t),n.removeAttr(t)}),i},rules:function(t,i){var n=this[0];if(t){var a=e.data(n.form,"validator").settings,s=a.rules,o=e.validator.staticRules(n);switch(t){case"add":e.extend(o,e.validator.normalizeRule(i)),s[n.name]=o,i.messages&&(a.messages[n.name]=e.extend(a.messages[n.name],i.messages));break;case"remove":if(!i)return delete s[n.name],o;var r={};return e.each(i.split(/\s/),function(e,t){r[t]=o[t],delete o[t]}),r}}return n=e.validator.normalizeRules(e.extend({},e.validator.metadataRules(n),e.validator.classRules(n),e.validator.attributeRules(n),e.validator.staticRules(n)),n),n.required&&(a=n.required,delete n.required,n=e.extend({required:a},n)),n}}),e.extend(e.expr[":"],{blank:function(t){return!e.trim(""+t.value)},filled:function(t){return!!e.trim(""+t.value)},unchecked:function(e){return!e.checked}}),e.validator=function(t,i){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=i,this.init()},e.validator.format=function(t,i){return 1==arguments.length?function(){var i=e.makeArray(arguments);return i.unshift(t),e.validator.format.apply(this,i)}:(arguments.length>2&&i.constructor!=Array&&(i=e.makeArray(arguments).slice(1)),i.constructor!=Array&&(i=[i]),e.each(i,function(e,i){t=t.replace(RegExp("\\{"+e+"\\}","g"),i)}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:[],ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(e)).hide())},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(e){(e.name in this.submitted||e==this.lastElement)&&this.element(e)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,i,n){"radio"===t.type?this.findByName(t.name).addClass(i).removeClass(n):e(t).addClass(i).removeClass(n)},unhighlight:function(t,i,n){"radio"===t.type?this.findByName(t.name).removeClass(i).addClass(n):e(t).removeClass(i).addClass(n)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:e.validator.format("Please enter no more than {0} characters."),minlength:e.validator.format("Please enter at least {0} characters."),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long."),range:e.validator.format("Please enter a value between {0} and {1}."),max:e.validator.format("Please enter a value less than or equal to {0}."),min:e.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function t(t){var i=e.data(this[0].form,"validator");t="on"+t.type.replace(/^validate/,""),i.settings[t]&&i.settings[t].call(i,this[0])}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var i=this.groups={};e.each(this.settings.groups,function(t,n){e.each(n.split(/\s/),function(e,n){i[n]=t})});var n=this.settings.rules;e.each(n,function(t,i){n[t]=e.validator.normalizeRule(i)}),e(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin focusout keyup",t).validateDelegate(":radio, :checkbox, select, option","click",t),this.settings.invalidHandler&&e(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){this.lastElement=t=this.clean(t),this.prepareElement(t),this.currentElements=e(t);var i=this.check(t);return i?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),i},showErrors:function(t){if(t){e.extend(this.errorMap,t),this.errorList=[];for(var i in t)this.errorList.push({message:t[i],element:this.findByName(i)[0]});this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.submitted={},this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t,i=0;for(t in e)i++;return i},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0==this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&1==e.grep(this.errorList,function(e){return e.element.name==t.name}).length&&t},elements:function(){var t=this,i={};return e(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in i||!t.objectLength(e(this).rules())?!1:i[this.name]=!0})},clean:function(t){return e(t)[0]},errors:function(){return e(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([]),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},check:function(t){t=this.clean(t),this.checkable(t)&&(t=this.findByName(t.name).not(this.settings.ignore)[0]);var i,n=e(t).rules(),a=!1;for(i in n){var s={method:i,parameters:n[i]};try{var o=e.validator.methods[i].call(this,t.value.replace(/\r/g,""),t,s.parameters);if("dependency-mismatch"==o)a=!0;else{if(a=!1,"pending"==o)return this.toHide=this.toHide.not(this.errorsFor(t)),void 0;if(!o)return this.formatAndAdd(t,s),!1}}catch(r){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+t.id+", check the '"+s.method+"' method",r),r}}return a?void 0:(this.objectLength(n)&&this.successList.push(t),!0)},customMetaMessage:function(t,i){if(e.metadata){var n=this.settings.meta?e(t).metadata()[this.settings.meta]:e(t).metadata();return n&&n.messages&&n.messages[i]}},customMessage:function(e,t){var i=this.settings.messages[e];return i&&(i.constructor==String?i:i[t])},findDefined:function(){for(var e=0;arguments.length>e;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(t,i){return this.findDefined(this.customMessage(t.name,i),this.customMetaMessage(t,i),!this.settings.ignoreTitle&&t.title||void 0,e.validator.messages[i],"<strong>Warning: No message defined for "+t.name+"</strong>")},formatAndAdd:function(e,t){var i=this.defaultMessage(e,t.method),n=/\$?\{(\d+)\}/g;"function"==typeof i?i=i.call(this,t.parameters,e):n.test(i)&&(i=jQuery.format(i.replace(n,"{$1}"),t.parameters)),this.errorList.push({message:i,element:e}),this.errorMap[e.name]=i,this.submitted[e.name]=i},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){for(var e=0;this.errorList[e];e++){var t=this.errorList[e];this.settings.highlight&&this.settings.highlight.call(this,t.element,this.settings.errorClass,this.settings.validClass),this.showLabel(t.element,t.message)}if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,i){var n=this.errorsFor(t);n.length?(n.removeClass().addClass(this.settings.errorClass),n.attr("generated")&&n.html(i)):(n=e("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(t),generated:!0}).addClass(this.settings.errorClass).html(i||""),this.settings.wrapper&&(n=n.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(n).length||(this.settings.errorPlacement?this.settings.errorPlacement(n,e(t)):n.insertAfter(t))),!i&&this.settings.success&&(n.text(""),"string"==typeof this.settings.success?n.addClass(this.settings.success):this.settings.success(n)),this.toShow=this.toShow.add(n)},errorsFor:function(t){var i=this.idOrName(t);return this.errors().filter(function(){return e(this).attr("for")==i})},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){var i=this.currentForm;return e(document.getElementsByName(t)).map(function(e,n){return n.form==i&&n.name==t&&n||null})},getLength:function(t,i){switch(i.nodeName.toLowerCase()){case"select":return e("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return t.length},depend:function(e,t){return this.dependTypes[typeof e]?this.dependTypes[typeof e](e,t):!0},dependTypes:{"boolean":function(e){return e},string:function(t,i){return!!e(t,i.form).length},"function":function(e,t){return e(t)}},optional:function(t){return!e.validator.methods.required.call(this,e.trim(t.value),t)&&"dependency-mismatch"},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,this.pending[e.name]=!0)},stopRequest:function(t,i){this.pendingRequest--,0>this.pendingRequest&&(this.pendingRequest=0),delete this.pending[t.name],i&&0==this.pendingRequest&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!i&&0==this.pendingRequest&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},dateDE:{dateDE:!0},number:{number:!0},numberDE:{numberDE:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,i){t.constructor==String?this.classRuleSettings[t]=i:e.extend(this.classRuleSettings,t)},classRules:function(t){var i={};return(t=e(t).attr("class"))&&e.each(t.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(i,e.validator.classRuleSettings[this])}),i},attributeRules:function(t){var i={};t=e(t);for(var n in e.validator.methods){var a=t.attr(n);a&&(i[n]=a)}return i.maxlength&&/-1|2147483647|524288/.test(i.maxlength)&&delete i.maxlength,i},metadataRules:function(t){if(!e.metadata)return{};var i=e.data(t.form,"validator").settings.meta;return i?e(t).metadata()[i]:e(t).metadata()},staticRules:function(t){var i={},n=e.data(t.form,"validator");return n.settings.rules&&(i=e.validator.normalizeRule(n.settings.rules[t.name])||{}),i},normalizeRules:function(t,i){return e.each(t,function(n,a){if(a===!1)delete t[n];else if(a.param||a.depends){var s=!0;switch(typeof a.depends){case"string":s=!!e(a.depends,i.form).length;break;case"function":s=a.depends.call(i,i)}s?t[n]=void 0!==a.param?a.param:!0:delete t[n]}}),e.each(t,function(n,a){t[n]=e.isFunction(a)?a(i):a}),e.each(["minlength","maxlength","min","max"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength","range"],function(){t[this]&&(t[this]=[Number(t[this][0]),Number(t[this][1])])}),e.validator.autoCreateRanges&&(t.min&&t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),t.minlength&&t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t.messages&&delete t.messages,t},normalizeRule:function(t){if("string"==typeof t){var i={};e.each(t.split(/\s/),function(){i[this]=!0}),t=i}return t},addMethod:function(t,i,n){e.validator.methods[t]=i,e.validator.messages[t]=void 0!=n?n:e.validator.messages[t],3>i.length&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,i,n){if(!this.depend(n,i))return"dependency-mismatch";switch(i.nodeName.toLowerCase()){case"select":return(t=e(i).val())&&t.length>0;case"input":if(this.checkable(i))return this.getLength(t,i)>0;default:return e.trim(t).length>0}},remote:function(t,i,n){if(this.optional(i))return"dependency-mismatch";var a=this.previousValue(i);if(this.settings.messages[i.name]||(this.settings.messages[i.name]={}),a.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=a.message,n="string"==typeof n&&{url:n}||n,this.pending[i.name])return"pending";if(a.old===t)return a.valid;a.old=t;var s=this;this.startRequest(i);var o={};return o[i.name]=t,e.ajax(e.extend(!0,{url:n,mode:"abort",port:"validate"+i.name,dataType:"json",data:o,success:function(n){s.settings.messages[i.name].remote=a.originalMessage;var o=n===!0;if(o){var r=s.formSubmitted;s.prepareElement(i),s.formSubmitted=r,s.successList.push(i),s.showErrors()}else r={},n=n||s.defaultMessage(i,"remote"),r[i.name]=a.message=e.isFunction(n)?n(t):n,s.showErrors(r);a.valid=o,s.stopRequest(i,o)}},n)),"pending"},minlength:function(t,i,n){return this.optional(i)||this.getLength(e.trim(t),i)>=n},maxlength:function(t,i,n){return this.optional(i)||n>=this.getLength(e.trim(t),i)},rangelength:function(t,i,n){return t=this.getLength(e.trim(t),i),this.optional(i)||t>=n[0]&&n[1]>=t},min:function(e,t,i){return this.optional(t)||e>=i},max:function(e,t,i){return this.optional(t)||i>=e},range:function(e,t,i){return this.optional(t)||e>=i[0]&&i[1]>=e},email:function(e,t){return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(e)},url:function(e,t){return this.optional(t)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(e))},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},number:function(e,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},creditcard:function(e,t){if(this.optional(t))return"dependency-mismatch";if(/[^0-9-]+/.test(e))return!1;var i=0,n=0,a=!1;e=e.replace(/\D/g,"");for(var s=e.length-1;s>=0;s--)n=e.charAt(s),n=parseInt(n,10),a&&(n*=2)>9&&(n-=9),i+=n,a=!a;return 0==i%10},accept:function(e,t,i){return i="string"==typeof i?i.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||e.match(RegExp(".("+i+")$","i"))},equalTo:function(t,i,n){return n=e(n).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){e(i).valid()}),t==n.val()}}}),e.format=e.validator.format}(jQuery),function(e){var t={};if(e.ajaxPrefilter)e.ajaxPrefilter(function(e,i,n){i=e.port,"abort"==e.mode&&(t[i]&&t[i].abort(),t[i]=n)});else{var i=e.ajax;e.ajax=function(n){var a=("port"in n?n:e.ajaxSettings).port;return"abort"==("mode"in n?n:e.ajaxSettings).mode?(t[a]&&t[a].abort(),t[a]=i.apply(this,arguments)):i.apply(this,arguments)}}}(jQuery),function(e){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&e.each({focus:"focusin",blur:"focusout"},function(t,i){function n(t){return t=e.event.fix(t),t.type=i,e.event.handle.call(this,t)}e.event.special[i]={setup:function(){this.addEventListener(t,n,!0)},teardown:function(){this.removeEventListener(t,n,!0)},handler:function(t){return arguments[0]=e.event.fix(t),arguments[0].type=i,e.event.handle.apply(this,arguments)}}}),e.extend(e.fn,{validateDelegate:function(t,i,n){return this.bind(i,function(i){var a=e(i.target);return a.is(t)?n.apply(a,arguments):void 0})}})}(jQuery),define("validate",function(){}),require(["config"],function(){require(["jquery","render","dialogs","pubsub","validate"],function(e,t){e(document).ready(function(){t.render(e(".container")),e("#proceed").click(t.start_attributes),e("#choose_essential_abilities").click(t.start_essential_abilities),e("#choose_characteristics").click(t.start_characteristics),e("#choose_advantages").click(t.start_advantages).attr("disabled","disabled"),e("#choose_abilities").click(t.start_abilities).attr("disabled","disabled"),e.subscribe("essential_abilities_changed",t.update_essential_abilities),e.subscribe("cp_changed",t.update_cp),e.subscribe("level_data_changed",t.update_level),e.subscribe("data_loaded",t.load_data)})})}),define("main",function(){})})();